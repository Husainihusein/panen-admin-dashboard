var My=c=>{throw TypeError(c)};var Wh=(c,t,e)=>t.has(c)||My("Cannot "+e);var Jt=(c,t,e)=>(Wh(c,t,"read from private field"),e?e.call(c):t.get(c)),Bs=(c,t,e)=>t.has(c)?My("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(c):t.set(c,e),Ye=(c,t,e,s)=>(Wh(c,t,"write to private field"),s?s.call(c,e):t.set(c,e),e),Us=(c,t,e)=>(Wh(c,t,"access private method"),e);var jy=(c,t,e,s)=>({set _(r){Ye(c,t,r,e)},get _(){return Jt(c,t,s)}});function bA(c,t){for(var e=0;e<t.length;e++){const s=t[e];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in c)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(c,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function vA(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}function wA(c){if(Object.prototype.hasOwnProperty.call(c,"__esModule"))return c;var t=c.default;if(typeof t=="function"){var e=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(c).forEach(function(s){var r=Object.getOwnPropertyDescriptor(c,s);Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:function(){return c[s]}})}),e}var Qh={exports:{}},Ia={};var Ly;function _A(){if(Ly)return Ia;Ly=1;var c=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,r,a){var o=null;if(a!==void 0&&(o=""+a),r.key!==void 0&&(o=""+r.key),"key"in r){a={};for(var u in r)u!=="key"&&(a[u]=r[u])}else a=r;return r=a.ref,{$$typeof:c,type:s,key:o,ref:r!==void 0?r:null,props:a}}return Ia.Fragment=t,Ia.jsx=e,Ia.jsxs=e,Ia}var Py;function AA(){return Py||(Py=1,Qh.exports=_A()),Qh.exports}var _=AA(),Jh={exports:{}},wt={};var By;function xA(){if(By)return wt;By=1;var c=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),b=Symbol.iterator;function v(k){return k===null||typeof k!="object"?null:(k=b&&k[b]||k["@@iterator"],typeof k=="function"?k:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function E(k,V,J){this.props=k,this.context=V,this.refs=S,this.updater=J||x}E.prototype.isReactComponent={},E.prototype.setState=function(k,V){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,V,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function R(){}R.prototype=E.prototype;function T(k,V,J){this.props=k,this.context=V,this.refs=S,this.updater=J||x}var N=T.prototype=new R;N.constructor=T,w(N,E.prototype),N.isPureReactComponent=!0;var D=Array.isArray;function M(){}var L={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function X(k,V,J){var it=J.ref;return{$$typeof:c,type:k,key:V,ref:it!==void 0?it:null,props:J}}function et(k,V){return X(k.type,V,k.props)}function Z(k){return typeof k=="object"&&k!==null&&k.$$typeof===c}function P(k){var V={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(J){return V[J]})}var Q=/\/+/g;function tt(k,V){return typeof k=="object"&&k!==null&&k.key!=null?P(""+k.key):V.toString(36)}function ut(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(M,M):(k.status="pending",k.then(function(V){k.status==="pending"&&(k.status="fulfilled",k.value=V)},function(V){k.status==="pending"&&(k.status="rejected",k.reason=V)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function B(k,V,J,it,ft){var vt=typeof k;(vt==="undefined"||vt==="boolean")&&(k=null);var gt=!1;if(k===null)gt=!0;else switch(vt){case"bigint":case"string":case"number":gt=!0;break;case"object":switch(k.$$typeof){case c:case t:gt=!0;break;case g:return gt=k._init,B(gt(k._payload),V,J,it,ft)}}if(gt)return ft=ft(k),gt=it===""?"."+tt(k,0):it,D(ft)?(J="",gt!=null&&(J=gt.replace(Q,"$&/")+"/"),B(ft,V,J,"",function(Ji){return Ji})):ft!=null&&(Z(ft)&&(ft=et(ft,J+(ft.key==null||k&&k.key===ft.key?"":(""+ft.key).replace(Q,"$&/")+"/")+gt)),V.push(ft)),1;gt=0;var oe=it===""?".":it+":";if(D(k))for(var $t=0;$t<k.length;$t++)it=k[$t],vt=oe+tt(it,$t),gt+=B(it,V,J,vt,ft);else if($t=v(k),typeof $t=="function")for(k=$t.call(k),$t=0;!(it=k.next()).done;)it=it.value,vt=oe+tt(it,$t++),gt+=B(it,V,J,vt,ft);else if(vt==="object"){if(typeof k.then=="function")return B(ut(k),V,J,it,ft);throw V=String(k),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return gt}function $(k,V,J){if(k==null)return k;var it=[],ft=0;return B(k,it,"","",function(vt){return V.call(J,vt,ft++)}),it}function st(k){if(k._status===-1){var V=k._result;V=V(),V.then(function(J){(k._status===0||k._status===-1)&&(k._status=1,k._result=J)},function(J){(k._status===0||k._status===-1)&&(k._status=2,k._result=J)}),k._status===-1&&(k._status=0,k._result=V)}if(k._status===1)return k._result.default;throw k._result}var mt=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},St={map:$,forEach:function(k,V,J){$(k,function(){V.apply(this,arguments)},J)},count:function(k){var V=0;return $(k,function(){V++}),V},toArray:function(k){return $(k,function(V){return V})||[]},only:function(k){if(!Z(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return wt.Activity=m,wt.Children=St,wt.Component=E,wt.Fragment=e,wt.Profiler=r,wt.PureComponent=T,wt.StrictMode=s,wt.Suspense=d,wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,wt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return L.H.useMemoCache(k)}},wt.cache=function(k){return function(){return k.apply(null,arguments)}},wt.cacheSignal=function(){return null},wt.cloneElement=function(k,V,J){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var it=w({},k.props),ft=k.key;if(V!=null)for(vt in V.key!==void 0&&(ft=""+V.key),V)!G.call(V,vt)||vt==="key"||vt==="__self"||vt==="__source"||vt==="ref"&&V.ref===void 0||(it[vt]=V[vt]);var vt=arguments.length-2;if(vt===1)it.children=J;else if(1<vt){for(var gt=Array(vt),oe=0;oe<vt;oe++)gt[oe]=arguments[oe+2];it.children=gt}return X(k.type,ft,it)},wt.createContext=function(k){return k={$$typeof:o,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:a,_context:k},k},wt.createElement=function(k,V,J){var it,ft={},vt=null;if(V!=null)for(it in V.key!==void 0&&(vt=""+V.key),V)G.call(V,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(ft[it]=V[it]);var gt=arguments.length-2;if(gt===1)ft.children=J;else if(1<gt){for(var oe=Array(gt),$t=0;$t<gt;$t++)oe[$t]=arguments[$t+2];ft.children=oe}if(k&&k.defaultProps)for(it in gt=k.defaultProps,gt)ft[it]===void 0&&(ft[it]=gt[it]);return X(k,vt,ft)},wt.createRef=function(){return{current:null}},wt.forwardRef=function(k){return{$$typeof:u,render:k}},wt.isValidElement=Z,wt.lazy=function(k){return{$$typeof:g,_payload:{_status:-1,_result:k},_init:st}},wt.memo=function(k,V){return{$$typeof:f,type:k,compare:V===void 0?null:V}},wt.startTransition=function(k){var V=L.T,J={};L.T=J;try{var it=k(),ft=L.S;ft!==null&&ft(J,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(M,mt)}catch(vt){mt(vt)}finally{V!==null&&J.types!==null&&(V.types=J.types),L.T=V}},wt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},wt.use=function(k){return L.H.use(k)},wt.useActionState=function(k,V,J){return L.H.useActionState(k,V,J)},wt.useCallback=function(k,V){return L.H.useCallback(k,V)},wt.useContext=function(k){return L.H.useContext(k)},wt.useDebugValue=function(){},wt.useDeferredValue=function(k,V){return L.H.useDeferredValue(k,V)},wt.useEffect=function(k,V){return L.H.useEffect(k,V)},wt.useEffectEvent=function(k){return L.H.useEffectEvent(k)},wt.useId=function(){return L.H.useId()},wt.useImperativeHandle=function(k,V,J){return L.H.useImperativeHandle(k,V,J)},wt.useInsertionEffect=function(k,V){return L.H.useInsertionEffect(k,V)},wt.useLayoutEffect=function(k,V){return L.H.useLayoutEffect(k,V)},wt.useMemo=function(k,V){return L.H.useMemo(k,V)},wt.useOptimistic=function(k,V){return L.H.useOptimistic(k,V)},wt.useReducer=function(k,V,J){return L.H.useReducer(k,V,J)},wt.useRef=function(k){return L.H.useRef(k)},wt.useState=function(k){return L.H.useState(k)},wt.useSyncExternalStore=function(k,V,J){return L.H.useSyncExternalStore(k,V,J)},wt.useTransition=function(){return L.H.useTransition()},wt.version="19.2.0",wt}var Uy;function Qd(){return Uy||(Uy=1,Jh.exports=xA()),Jh.exports}var F=Qd(),Zh={exports:{}},za={},td={exports:{}},ed={};var Iy;function SA(){return Iy||(Iy=1,(function(c){function t(B,$){var st=B.length;B.push($);t:for(;0<st;){var mt=st-1>>>1,St=B[mt];if(0<r(St,$))B[mt]=$,B[st]=St,st=mt;else break t}}function e(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var $=B[0],st=B.pop();if(st!==$){B[0]=st;t:for(var mt=0,St=B.length,k=St>>>1;mt<k;){var V=2*(mt+1)-1,J=B[V],it=V+1,ft=B[it];if(0>r(J,st))it<St&&0>r(ft,J)?(B[mt]=ft,B[it]=st,mt=it):(B[mt]=J,B[V]=st,mt=V);else if(it<St&&0>r(ft,st))B[mt]=ft,B[it]=st,mt=it;else break t}}return $}function r(B,$){var st=B.sortIndex-$.sortIndex;return st!==0?st:B.id-$.id}if(c.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;c.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();c.unstable_now=function(){return o.now()-u}}var d=[],f=[],g=1,m=null,b=3,v=!1,x=!1,w=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function N(B){for(var $=e(f);$!==null;){if($.callback===null)s(f);else if($.startTime<=B)s(f),$.sortIndex=$.expirationTime,t(d,$);else break;$=e(f)}}function D(B){if(w=!1,N(B),!x)if(e(d)!==null)x=!0,M||(M=!0,P());else{var $=e(f);$!==null&&ut(D,$.startTime-B)}}var M=!1,L=-1,G=5,X=-1;function et(){return S?!0:!(c.unstable_now()-X<G)}function Z(){if(S=!1,M){var B=c.unstable_now();X=B;var $=!0;try{t:{x=!1,w&&(w=!1,R(L),L=-1),v=!0;var st=b;try{e:{for(N(B),m=e(d);m!==null&&!(m.expirationTime>B&&et());){var mt=m.callback;if(typeof mt=="function"){m.callback=null,b=m.priorityLevel;var St=mt(m.expirationTime<=B);if(B=c.unstable_now(),typeof St=="function"){m.callback=St,N(B),$=!0;break e}m===e(d)&&s(d),N(B)}else s(d);m=e(d)}if(m!==null)$=!0;else{var k=e(f);k!==null&&ut(D,k.startTime-B),$=!1}}break t}finally{m=null,b=st,v=!1}$=void 0}}finally{$?P():M=!1}}}var P;if(typeof T=="function")P=function(){T(Z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,tt=Q.port2;Q.port1.onmessage=Z,P=function(){tt.postMessage(null)}}else P=function(){E(Z,0)};function ut(B,$){L=E(function(){B(c.unstable_now())},$)}c.unstable_IdlePriority=5,c.unstable_ImmediatePriority=1,c.unstable_LowPriority=4,c.unstable_NormalPriority=3,c.unstable_Profiling=null,c.unstable_UserBlockingPriority=2,c.unstable_cancelCallback=function(B){B.callback=null},c.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<B?Math.floor(1e3/B):5},c.unstable_getCurrentPriorityLevel=function(){return b},c.unstable_next=function(B){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var st=b;b=$;try{return B()}finally{b=st}},c.unstable_requestPaint=function(){S=!0},c.unstable_runWithPriority=function(B,$){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var st=b;b=B;try{return $()}finally{b=st}},c.unstable_scheduleCallback=function(B,$,st){var mt=c.unstable_now();switch(typeof st=="object"&&st!==null?(st=st.delay,st=typeof st=="number"&&0<st?mt+st:mt):st=mt,B){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=st+St,B={id:g++,callback:$,priorityLevel:B,startTime:st,expirationTime:St,sortIndex:-1},st>mt?(B.sortIndex=st,t(f,B),e(d)===null&&B===e(f)&&(w?(R(L),L=-1):w=!0,ut(D,st-mt))):(B.sortIndex=St,t(d,B),x||v||(x=!0,M||(M=!0,P()))),B},c.unstable_shouldYield=et,c.unstable_wrapCallback=function(B){var $=b;return function(){var st=b;b=$;try{return B.apply(this,arguments)}finally{b=st}}}})(ed)),ed}var zy;function EA(){return zy||(zy=1,td.exports=SA()),td.exports}var sd={exports:{}},Me={};var Fy;function TA(){if(Fy)return Me;Fy=1;var c=Qd();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(d,f,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:m==null?null:""+m,children:d,containerInfo:f,implementation:g}}var o=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Me.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Me.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,g)},Me.flushSync=function(d){var f=o.T,g=s.p;try{if(o.T=null,s.p=2,d)return d()}finally{o.T=f,s.p=g,s.d.f()}},Me.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(d,f))},Me.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Me.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,m=u(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?s.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:b,fetchPriority:v}):g==="script"&&s.d.X(d,{crossOrigin:m,integrity:b,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Me.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=u(f.as,f.crossOrigin);s.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(d)},Me.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,m=u(g,f.crossOrigin);s.d.L(d,g,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Me.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=u(f.as,f.crossOrigin);s.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(d)},Me.requestFormReset=function(d){s.d.r(d)},Me.unstable_batchedUpdates=function(d,f){return d(f)},Me.useFormState=function(d,f,g){return o.H.useFormState(d,f,g)},Me.useFormStatus=function(){return o.H.useHostTransitionStatus()},Me.version="19.2.0",Me}var Hy;function CA(){if(Hy)return sd.exports;Hy=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(t){console.error(t)}}return c(),sd.exports=TA(),sd.exports}var $y;function RA(){if($y)return za;$y=1;var c=EA(),t=Qd(),e=CA();function s(i){var n="https://react.dev/errors/"+i;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var n=i,l=i;if(i.alternate)for(;n.return;)n=n.return;else{i=n;do n=i,(n.flags&4098)!==0&&(l=n.return),i=n.return;while(i)}return n.tag===3?l:null}function o(i){if(i.tag===13){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function u(i){if(i.tag===31){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function d(i){if(a(i)!==i)throw Error(s(188))}function f(i){var n=i.alternate;if(!n){if(n=a(i),n===null)throw Error(s(188));return n!==i?null:i}for(var l=i,h=n;;){var p=l.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){l=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===l)return d(p),i;if(y===h)return d(p),n;y=y.sibling}throw Error(s(188))}if(l.return!==h.return)l=p,h=y;else{for(var A=!1,C=p.child;C;){if(C===l){A=!0,l=p,h=y;break}if(C===h){A=!0,h=p,l=y;break}C=C.sibling}if(!A){for(C=y.child;C;){if(C===l){A=!0,l=y,h=p;break}if(C===h){A=!0,h=y,l=p;break}C=C.sibling}if(!A)throw Error(s(189))}}if(l.alternate!==h)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?i:n}function g(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i;for(i=i.child;i!==null;){if(n=g(i),n!==null)return n;i=i.sibling}return null}var m=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),et=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function P(i){return i===null||typeof i!="object"?null:(i=Z&&i[Z]||i["@@iterator"],typeof i=="function"?i:null)}var Q=Symbol.for("react.client.reference");function tt(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Q?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case E:return"Profiler";case S:return"StrictMode";case D:return"Suspense";case M:return"SuspenseList";case X:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case x:return"Portal";case T:return i.displayName||"Context";case R:return(i._context.displayName||"Context")+".Consumer";case N:var n=i.render;return i=i.displayName,i||(i=n.displayName||n.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case L:return n=i.displayName||null,n!==null?n:tt(i.type)||"Memo";case G:n=i._payload,i=i._init;try{return tt(i(n))}catch{}}return null}var ut=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st={pending:!1,data:null,method:null,action:null},mt=[],St=-1;function k(i){return{current:i}}function V(i){0>St||(i.current=mt[St],mt[St]=null,St--)}function J(i,n){St++,mt[St]=i.current,i.current=n}var it=k(null),ft=k(null),vt=k(null),gt=k(null);function oe(i,n){switch(J(vt,n),J(ft,i),J(it,null),n.nodeType){case 9:case 11:i=(i=n.documentElement)&&(i=i.namespaceURI)?sy(i):0;break;default:if(i=n.tagName,n=n.namespaceURI)n=sy(n),i=iy(n,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(it),J(it,i)}function $t(){V(it),V(ft),V(vt)}function Ji(i){i.memoizedState!==null&&J(gt,i);var n=it.current,l=iy(n,i.type);n!==l&&(J(ft,i),J(it,l))}function yi(i){ft.current===i&&(V(it),V(ft)),gt.current===i&&(V(gt),La._currentValue=st)}var Zi,Vr;function Gs(i){if(Zi===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Zi=n&&n[1]||"",Vr=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Zi+i+Vr}var Mc=!1;function jc(i,n){if(!i||Mc)return"";Mc=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(n){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(q){var H=q}Reflect.construct(i,[],W)}else{try{W.call()}catch(q){H=q}i.call(W.prototype)}}else{try{throw Error()}catch(q){H=q}(W=i())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(q){if(q&&H&&typeof q.stack=="string")return[q.stack,H.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),A=y[0],C=y[1];if(A&&C){var O=A.split(`
`),z=C.split(`
`);for(p=h=0;h<O.length&&!O[h].includes("DetermineComponentFrameRoot");)h++;for(;p<z.length&&!z[p].includes("DetermineComponentFrameRoot");)p++;if(h===O.length||p===z.length)for(h=O.length-1,p=z.length-1;1<=h&&0<=p&&O[h]!==z[p];)p--;for(;1<=h&&0<=p;h--,p--)if(O[h]!==z[p]){if(h!==1||p!==1)do if(h--,p--,0>p||O[h]!==z[p]){var Y=`
`+O[h].replace(" at new "," at ");return i.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",i.displayName)),Y}while(1<=h&&0<=p);break}}}finally{Mc=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Gs(l):""}function Kv(i,n){switch(i.tag){case 26:case 27:case 5:return Gs(i.type);case 16:return Gs("Lazy");case 13:return i.child!==n&&n!==null?Gs("Suspense Fallback"):Gs("Suspense");case 19:return Gs("SuspenseList");case 0:case 15:return jc(i.type,!1);case 11:return jc(i.type.render,!1);case 1:return jc(i.type,!0);case 31:return Gs("Activity");default:return""}}function Mf(i){try{var n="",l=null;do n+=Kv(i,l),l=i,i=i.return;while(i);return n}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Lc=Object.prototype.hasOwnProperty,Pc=c.unstable_scheduleCallback,Bc=c.unstable_cancelCallback,Wv=c.unstable_shouldYield,Qv=c.unstable_requestPaint,We=c.unstable_now,Jv=c.unstable_getCurrentPriorityLevel,jf=c.unstable_ImmediatePriority,Lf=c.unstable_UserBlockingPriority,_o=c.unstable_NormalPriority,Zv=c.unstable_LowPriority,Pf=c.unstable_IdlePriority,tw=c.log,ew=c.unstable_setDisableYieldValue,Yr=null,Qe=null;function bi(i){if(typeof tw=="function"&&ew(i),Qe&&typeof Qe.setStrictMode=="function")try{Qe.setStrictMode(Yr,i)}catch{}}var Je=Math.clz32?Math.clz32:nw,sw=Math.log,iw=Math.LN2;function nw(i){return i>>>=0,i===0?32:31-(sw(i)/iw|0)|0}var Ao=256,xo=262144,So=4194304;function tn(i){var n=i&42;if(n!==0)return n;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Eo(i,n,l){var h=i.pendingLanes;if(h===0)return 0;var p=0,y=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var C=h&134217727;return C!==0?(h=C&~y,h!==0?p=tn(h):(A&=C,A!==0?p=tn(A):l||(l=C&~i,l!==0&&(p=tn(l))))):(C=h&~y,C!==0?p=tn(C):A!==0?p=tn(A):l||(l=h&~i,l!==0&&(p=tn(l)))),p===0?0:n!==0&&n!==p&&(n&y)===0&&(y=p&-p,l=n&-n,y>=l||y===32&&(l&4194048)!==0)?n:p}function Xr(i,n){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&n)===0}function rw(i,n){switch(i){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bf(){var i=So;return So<<=1,(So&62914560)===0&&(So=4194304),i}function Uc(i){for(var n=[],l=0;31>l;l++)n.push(i);return n}function Kr(i,n){i.pendingLanes|=n,n!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function aw(i,n,l,h,p,y){var A=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var C=i.entanglements,O=i.expirationTimes,z=i.hiddenUpdates;for(l=A&~l;0<l;){var Y=31-Je(l),W=1<<Y;C[Y]=0,O[Y]=-1;var H=z[Y];if(H!==null)for(z[Y]=null,Y=0;Y<H.length;Y++){var q=H[Y];q!==null&&(q.lane&=-536870913)}l&=~W}h!==0&&Uf(i,h,0),y!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=y&~(A&~n))}function Uf(i,n,l){i.pendingLanes|=n,i.suspendedLanes&=~n;var h=31-Je(n);i.entangledLanes|=n,i.entanglements[h]=i.entanglements[h]|1073741824|l&261930}function If(i,n){var l=i.entangledLanes|=n;for(i=i.entanglements;l;){var h=31-Je(l),p=1<<h;p&n|i[h]&n&&(i[h]|=n),l&=~p}}function zf(i,n){var l=n&-n;return l=(l&42)!==0?1:Ic(l),(l&(i.suspendedLanes|n))!==0?0:l}function Ic(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function zc(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ff(){var i=$.p;return i!==0?i:(i=window.event,i===void 0?32:Ty(i.type))}function Hf(i,n){var l=$.p;try{return $.p=i,n()}finally{$.p=l}}var vi=Math.random().toString(36).slice(2),xe="__reactFiber$"+vi,ze="__reactProps$"+vi,jn="__reactContainer$"+vi,Fc="__reactEvents$"+vi,ow="__reactListeners$"+vi,lw="__reactHandles$"+vi,$f="__reactResources$"+vi,Wr="__reactMarker$"+vi;function Hc(i){delete i[xe],delete i[ze],delete i[Fc],delete i[ow],delete i[lw]}function Ln(i){var n=i[xe];if(n)return n;for(var l=i.parentNode;l;){if(n=l[jn]||l[xe]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(i=uy(i);i!==null;){if(l=i[xe])return l;i=uy(i)}return n}i=l,l=i.parentNode}return null}function Pn(i){if(i=i[xe]||i[jn]){var n=i.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return i}return null}function Qr(i){var n=i.tag;if(n===5||n===26||n===27||n===6)return i.stateNode;throw Error(s(33))}function Bn(i){var n=i[$f];return n||(n=i[$f]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function we(i){i[Wr]=!0}var qf=new Set,Gf={};function en(i,n){Un(i,n),Un(i+"Capture",n)}function Un(i,n){for(Gf[i]=n,i=0;i<n.length;i++)qf.add(n[i])}var cw=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vf={},Yf={};function uw(i){return Lc.call(Yf,i)?!0:Lc.call(Vf,i)?!1:cw.test(i)?Yf[i]=!0:(Vf[i]=!0,!1)}function To(i,n,l){if(uw(n))if(l===null)i.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(n);return;case"boolean":var h=n.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(n);return}}i.setAttribute(n,""+l)}}function Co(i,n,l){if(l===null)i.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(n);return}i.setAttribute(n,""+l)}}function Vs(i,n,l,h){if(h===null)i.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(n,l,""+h)}}function hs(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Xf(i){var n=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function hw(i,n,l){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,n);if(!i.hasOwnProperty(n)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var p=h.get,y=h.set;return Object.defineProperty(i,n,{configurable:!0,get:function(){return p.call(this)},set:function(A){l=""+A,y.call(this,A)}}),Object.defineProperty(i,n,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(A){l=""+A},stopTracking:function(){i._valueTracker=null,delete i[n]}}}}function $c(i){if(!i._valueTracker){var n=Xf(i)?"checked":"value";i._valueTracker=hw(i,n,""+i[n])}}function Kf(i){if(!i)return!1;var n=i._valueTracker;if(!n)return!0;var l=n.getValue(),h="";return i&&(h=Xf(i)?i.checked?"true":"false":i.value),i=h,i!==l?(n.setValue(i),!0):!1}function Ro(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var dw=/[\n"\\]/g;function ds(i){return i.replace(dw,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function qc(i,n,l,h,p,y,A,C){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),n!=null?A==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+hs(n)):i.value!==""+hs(n)&&(i.value=""+hs(n)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),n!=null?Gc(i,A,hs(n)):l!=null?Gc(i,A,hs(l)):h!=null&&i.removeAttribute("value"),p==null&&y!=null&&(i.defaultChecked=!!y),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?i.name=""+hs(C):i.removeAttribute("name")}function Wf(i,n,l,h,p,y,A,C){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),n!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||n!=null)){$c(i);return}l=l!=null?""+hs(l):"",n=n!=null?""+hs(n):l,C||n===i.value||(i.value=n),i.defaultValue=n}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=C?i.checked:!!h,i.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A),$c(i)}function Gc(i,n,l){n==="number"&&Ro(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function In(i,n,l,h){if(i=i.options,n){n={};for(var p=0;p<l.length;p++)n["$"+l[p]]=!0;for(l=0;l<i.length;l++)p=n.hasOwnProperty("$"+i[l].value),i[l].selected!==p&&(i[l].selected=p),p&&h&&(i[l].defaultSelected=!0)}else{for(l=""+hs(l),n=null,p=0;p<i.length;p++){if(i[p].value===l){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}n!==null||i[p].disabled||(n=i[p])}n!==null&&(n.selected=!0)}}function Qf(i,n,l){if(n!=null&&(n=""+hs(n),n!==i.value&&(i.value=n),l==null)){i.defaultValue!==n&&(i.defaultValue=n);return}i.defaultValue=l!=null?""+hs(l):""}function Jf(i,n,l,h){if(n==null){if(h!=null){if(l!=null)throw Error(s(92));if(ut(h)){if(1<h.length)throw Error(s(93));h=h[0]}l=h}l==null&&(l=""),n=l}l=hs(n),i.defaultValue=l,h=i.textContent,h===l&&h!==""&&h!==null&&(i.value=h),$c(i)}function zn(i,n){if(n){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=n;return}}i.textContent=n}var fw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zf(i,n,l){var h=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?i.setProperty(n,""):n==="float"?i.cssFloat="":i[n]="":h?i.setProperty(n,l):typeof l!="number"||l===0||fw.has(n)?n==="float"?i.cssFloat=l:i[n]=(""+l).trim():i[n]=l+"px"}function tg(i,n,l){if(n!=null&&typeof n!="object")throw Error(s(62));if(i=i.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||n!=null&&n.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var p in n)h=n[p],n.hasOwnProperty(p)&&l[p]!==h&&Zf(i,p,h)}else for(var y in n)n.hasOwnProperty(y)&&Zf(i,y,n[y])}function Vc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function No(i){return pw.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Ys(){}var Yc=null;function Xc(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Fn=null,Hn=null;function eg(i){var n=Pn(i);if(n&&(i=n.stateNode)){var l=i[ze]||null;t:switch(i=n.stateNode,n.type){case"input":if(qc(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ds(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var h=l[n];if(h!==i&&h.form===i.form){var p=h[ze]||null;if(!p)throw Error(s(90));qc(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(n=0;n<l.length;n++)h=l[n],h.form===i.form&&Kf(h)}break t;case"textarea":Qf(i,l.value,l.defaultValue);break t;case"select":n=l.value,n!=null&&In(i,!!l.multiple,n,!1)}}}var Kc=!1;function sg(i,n,l){if(Kc)return i(n,l);Kc=!0;try{var h=i(n);return h}finally{if(Kc=!1,(Fn!==null||Hn!==null)&&(ml(),Fn&&(n=Fn,i=Hn,Hn=Fn=null,eg(n),i)))for(n=0;n<i.length;n++)eg(i[n])}}function Jr(i,n){var l=i.stateNode;if(l===null)return null;var h=l[ze]||null;if(h===null)return null;l=h[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break t;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(s(231,n,typeof l));return l}var Xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wc=!1;if(Xs)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){Wc=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{Wc=!1}var wi=null,Qc=null,Oo=null;function ig(){if(Oo)return Oo;var i,n=Qc,l=n.length,h,p="value"in wi?wi.value:wi.textContent,y=p.length;for(i=0;i<l&&n[i]===p[i];i++);var A=l-i;for(h=1;h<=A&&n[l-h]===p[y-h];h++);return Oo=p.slice(i,1<h?1-h:void 0)}function ko(i){var n=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&n===13&&(i=13)):i=n,i===10&&(i=13),32<=i||i===13?i:0}function Do(){return!0}function ng(){return!1}function Fe(i){function n(l,h,p,y,A){this._reactName=l,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=A,this.currentTarget=null;for(var C in i)i.hasOwnProperty(C)&&(l=i[C],this[C]=l?l(y):y[C]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Do:ng,this.isPropagationStopped=ng,this}return m(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Do)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Do)},persist:function(){},isPersistent:Do}),n}var sn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mo=Fe(sn),ta=m({},sn,{view:0,detail:0}),mw=Fe(ta),Jc,Zc,ea,jo=m({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ea&&(ea&&i.type==="mousemove"?(Jc=i.screenX-ea.screenX,Zc=i.screenY-ea.screenY):Zc=Jc=0,ea=i),Jc)},movementY:function(i){return"movementY"in i?i.movementY:Zc}}),rg=Fe(jo),yw=m({},jo,{dataTransfer:0}),bw=Fe(yw),vw=m({},ta,{relatedTarget:0}),tu=Fe(vw),ww=m({},sn,{animationName:0,elapsedTime:0,pseudoElement:0}),_w=Fe(ww),Aw=m({},sn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),xw=Fe(Aw),Sw=m({},sn,{data:0}),ag=Fe(Sw),Ew={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rw(i){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(i):(i=Cw[i])?!!n[i]:!1}function eu(){return Rw}var Nw=m({},ta,{key:function(i){if(i.key){var n=Ew[i.key]||i.key;if(n!=="Unidentified")return n}return i.type==="keypress"?(i=ko(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Tw[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eu,charCode:function(i){return i.type==="keypress"?ko(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ko(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ow=Fe(Nw),kw=m({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),og=Fe(kw),Dw=m({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eu}),Mw=Fe(Dw),jw=m({},sn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lw=Fe(jw),Pw=m({},jo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Bw=Fe(Pw),Uw=m({},sn,{newState:0,oldState:0}),Iw=Fe(Uw),zw=[9,13,27,32],su=Xs&&"CompositionEvent"in window,sa=null;Xs&&"documentMode"in document&&(sa=document.documentMode);var Fw=Xs&&"TextEvent"in window&&!sa,lg=Xs&&(!su||sa&&8<sa&&11>=sa),cg=" ",ug=!1;function hg(i,n){switch(i){case"keyup":return zw.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dg(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var $n=!1;function Hw(i,n){switch(i){case"compositionend":return dg(n);case"keypress":return n.which!==32?null:(ug=!0,cg);case"textInput":return i=n.data,i===cg&&ug?null:i;default:return null}}function $w(i,n){if($n)return i==="compositionend"||!su&&hg(i,n)?(i=ig(),Oo=Qc=wi=null,$n=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return lg&&n.locale!=="ko"?null:n.data;default:return null}}var qw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fg(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n==="input"?!!qw[i.type]:n==="textarea"}function gg(i,n,l,h){Fn?Hn?Hn.push(h):Hn=[h]:Fn=h,n=xl(n,"onChange"),0<n.length&&(l=new Mo("onChange","change",null,l,h),i.push({event:l,listeners:n}))}var ia=null,na=null;function Gw(i){Wm(i,0)}function Lo(i){var n=Qr(i);if(Kf(n))return i}function pg(i,n){if(i==="change")return n}var mg=!1;if(Xs){var iu;if(Xs){var nu="oninput"in document;if(!nu){var yg=document.createElement("div");yg.setAttribute("oninput","return;"),nu=typeof yg.oninput=="function"}iu=nu}else iu=!1;mg=iu&&(!document.documentMode||9<document.documentMode)}function bg(){ia&&(ia.detachEvent("onpropertychange",vg),na=ia=null)}function vg(i){if(i.propertyName==="value"&&Lo(na)){var n=[];gg(n,na,i,Xc(i)),sg(Gw,n)}}function Vw(i,n,l){i==="focusin"?(bg(),ia=n,na=l,ia.attachEvent("onpropertychange",vg)):i==="focusout"&&bg()}function Yw(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Lo(na)}function Xw(i,n){if(i==="click")return Lo(n)}function Kw(i,n){if(i==="input"||i==="change")return Lo(n)}function Ww(i,n){return i===n&&(i!==0||1/i===1/n)||i!==i&&n!==n}var Ze=typeof Object.is=="function"?Object.is:Ww;function ra(i,n){if(Ze(i,n))return!0;if(typeof i!="object"||i===null||typeof n!="object"||n===null)return!1;var l=Object.keys(i),h=Object.keys(n);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var p=l[h];if(!Lc.call(n,p)||!Ze(i[p],n[p]))return!1}return!0}function wg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function _g(i,n){var l=wg(i);i=0;for(var h;l;){if(l.nodeType===3){if(h=i+l.textContent.length,i<=n&&h>=n)return{node:l,offset:n-i};i=h}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=wg(l)}}function Ag(i,n){return i&&n?i===n?!0:i&&i.nodeType===3?!1:n&&n.nodeType===3?Ag(i,n.parentNode):"contains"in i?i.contains(n):i.compareDocumentPosition?!!(i.compareDocumentPosition(n)&16):!1:!1}function xg(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var n=Ro(i.document);n instanceof i.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)i=n.contentWindow;else break;n=Ro(i.document)}return n}function ru(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n&&(n==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||n==="textarea"||i.contentEditable==="true")}var Qw=Xs&&"documentMode"in document&&11>=document.documentMode,qn=null,au=null,aa=null,ou=!1;function Sg(i,n,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ou||qn==null||qn!==Ro(h)||(h=qn,"selectionStart"in h&&ru(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),aa&&ra(aa,h)||(aa=h,h=xl(au,"onSelect"),0<h.length&&(n=new Mo("onSelect","select",null,n,l),i.push({event:n,listeners:h}),n.target=qn)))}function nn(i,n){var l={};return l[i.toLowerCase()]=n.toLowerCase(),l["Webkit"+i]="webkit"+n,l["Moz"+i]="moz"+n,l}var Gn={animationend:nn("Animation","AnimationEnd"),animationiteration:nn("Animation","AnimationIteration"),animationstart:nn("Animation","AnimationStart"),transitionrun:nn("Transition","TransitionRun"),transitionstart:nn("Transition","TransitionStart"),transitioncancel:nn("Transition","TransitionCancel"),transitionend:nn("Transition","TransitionEnd")},lu={},Eg={};Xs&&(Eg=document.createElement("div").style,"AnimationEvent"in window||(delete Gn.animationend.animation,delete Gn.animationiteration.animation,delete Gn.animationstart.animation),"TransitionEvent"in window||delete Gn.transitionend.transition);function rn(i){if(lu[i])return lu[i];if(!Gn[i])return i;var n=Gn[i],l;for(l in n)if(n.hasOwnProperty(l)&&l in Eg)return lu[i]=n[l];return i}var Tg=rn("animationend"),Cg=rn("animationiteration"),Rg=rn("animationstart"),Jw=rn("transitionrun"),Zw=rn("transitionstart"),t_=rn("transitioncancel"),Ng=rn("transitionend"),Og=new Map,cu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cu.push("scrollEnd");function Es(i,n){Og.set(i,n),en(n,[i])}var Po=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},fs=[],Vn=0,uu=0;function Bo(){for(var i=Vn,n=uu=Vn=0;n<i;){var l=fs[n];fs[n++]=null;var h=fs[n];fs[n++]=null;var p=fs[n];fs[n++]=null;var y=fs[n];if(fs[n++]=null,h!==null&&p!==null){var A=h.pending;A===null?p.next=p:(p.next=A.next,A.next=p),h.pending=p}y!==0&&kg(l,p,y)}}function Uo(i,n,l,h){fs[Vn++]=i,fs[Vn++]=n,fs[Vn++]=l,fs[Vn++]=h,uu|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function hu(i,n,l,h){return Uo(i,n,l,h),Io(i)}function an(i,n){return Uo(i,null,null,n),Io(i)}function kg(i,n,l){i.lanes|=l;var h=i.alternate;h!==null&&(h.lanes|=l);for(var p=!1,y=i.return;y!==null;)y.childLanes|=l,h=y.alternate,h!==null&&(h.childLanes|=l),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(p=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,p&&n!==null&&(p=31-Je(l),i=y.hiddenUpdates,h=i[p],h===null?i[p]=[n]:h.push(n),n.lane=l|536870912),y):null}function Io(i){if(50<Ra)throw Ra=0,wh=null,Error(s(185));for(var n=i.return;n!==null;)i=n,n=i.return;return i.tag===3?i.stateNode:null}var Yn={};function e_(i,n,l,h){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(i,n,l,h){return new e_(i,n,l,h)}function du(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ks(i,n){var l=i.alternate;return l===null?(l=ts(i.tag,n,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=n,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,n=i.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function Dg(i,n){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,n=l.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i}function zo(i,n,l,h,p,y){var A=0;if(h=i,typeof i=="function")du(i)&&(A=1);else if(typeof i=="string")A=aA(i,l,it.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case X:return i=ts(31,l,n,p),i.elementType=X,i.lanes=y,i;case w:return on(l.children,p,y,n);case S:A=8,p|=24;break;case E:return i=ts(12,l,n,p|2),i.elementType=E,i.lanes=y,i;case D:return i=ts(13,l,n,p),i.elementType=D,i.lanes=y,i;case M:return i=ts(19,l,n,p),i.elementType=M,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case T:A=10;break t;case R:A=9;break t;case N:A=11;break t;case L:A=14;break t;case G:A=16,h=null;break t}A=29,l=Error(s(130,i===null?"null":typeof i,"")),h=null}return n=ts(A,l,n,p),n.elementType=i,n.type=h,n.lanes=y,n}function on(i,n,l,h){return i=ts(7,i,h,n),i.lanes=l,i}function fu(i,n,l){return i=ts(6,i,null,n),i.lanes=l,i}function Mg(i){var n=ts(18,null,null,0);return n.stateNode=i,n}function gu(i,n,l){return n=ts(4,i.children!==null?i.children:[],i.key,n),n.lanes=l,n.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},n}var jg=new WeakMap;function gs(i,n){if(typeof i=="object"&&i!==null){var l=jg.get(i);return l!==void 0?l:(n={value:i,source:n,stack:Mf(n)},jg.set(i,n),n)}return{value:i,source:n,stack:Mf(n)}}var Xn=[],Kn=0,Fo=null,oa=0,ps=[],ms=0,_i=null,Ms=1,js="";function Ws(i,n){Xn[Kn++]=oa,Xn[Kn++]=Fo,Fo=i,oa=n}function Lg(i,n,l){ps[ms++]=Ms,ps[ms++]=js,ps[ms++]=_i,_i=i;var h=Ms;i=js;var p=32-Je(h)-1;h&=~(1<<p),l+=1;var y=32-Je(n)+p;if(30<y){var A=p-p%5;y=(h&(1<<A)-1).toString(32),h>>=A,p-=A,Ms=1<<32-Je(n)+p|l<<p|h,js=y+i}else Ms=1<<y|l<<p|h,js=i}function pu(i){i.return!==null&&(Ws(i,1),Lg(i,1,0))}function mu(i){for(;i===Fo;)Fo=Xn[--Kn],Xn[Kn]=null,oa=Xn[--Kn],Xn[Kn]=null;for(;i===_i;)_i=ps[--ms],ps[ms]=null,js=ps[--ms],ps[ms]=null,Ms=ps[--ms],ps[ms]=null}function Pg(i,n){ps[ms++]=Ms,ps[ms++]=js,ps[ms++]=_i,Ms=n.id,js=n.overflow,_i=i}var Se=null,Xt=null,kt=!1,Ai=null,ys=!1,yu=Error(s(519));function xi(i){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw la(gs(n,i)),yu}function Bg(i){var n=i.stateNode,l=i.type,h=i.memoizedProps;switch(n[xe]=i,n[ze]=h,l){case"dialog":Rt("cancel",n),Rt("close",n);break;case"iframe":case"object":case"embed":Rt("load",n);break;case"video":case"audio":for(l=0;l<Oa.length;l++)Rt(Oa[l],n);break;case"source":Rt("error",n);break;case"img":case"image":case"link":Rt("error",n),Rt("load",n);break;case"details":Rt("toggle",n);break;case"input":Rt("invalid",n),Wf(n,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Rt("invalid",n);break;case"textarea":Rt("invalid",n),Jf(n,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||h.suppressHydrationWarning===!0||ty(n.textContent,l)?(h.popover!=null&&(Rt("beforetoggle",n),Rt("toggle",n)),h.onScroll!=null&&Rt("scroll",n),h.onScrollEnd!=null&&Rt("scrollend",n),h.onClick!=null&&(n.onclick=Ys),n=!0):n=!1,n||xi(i,!0)}function Ug(i){for(Se=i.return;Se;)switch(Se.tag){case 5:case 31:case 13:ys=!1;return;case 27:case 3:ys=!0;return;default:Se=Se.return}}function Wn(i){if(i!==Se)return!1;if(!kt)return Ug(i),kt=!0,!1;var n=i.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Lh(i.type,i.memoizedProps)),l=!l),l&&Xt&&xi(i),Ug(i),n===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Xt=cy(i)}else if(n===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Xt=cy(i)}else n===27?(n=Xt,Bi(i.type)?(i=zh,zh=null,Xt=i):Xt=n):Xt=Se?vs(i.stateNode.nextSibling):null;return!0}function ln(){Xt=Se=null,kt=!1}function bu(){var i=Ai;return i!==null&&(Ge===null?Ge=i:Ge.push.apply(Ge,i),Ai=null),i}function la(i){Ai===null?Ai=[i]:Ai.push(i)}var vu=k(null),cn=null,Qs=null;function Si(i,n,l){J(vu,n._currentValue),n._currentValue=l}function Js(i){i._currentValue=vu.current,V(vu)}function wu(i,n,l){for(;i!==null;){var h=i.alternate;if((i.childLanes&n)!==n?(i.childLanes|=n,h!==null&&(h.childLanes|=n)):h!==null&&(h.childLanes&n)!==n&&(h.childLanes|=n),i===l)break;i=i.return}}function _u(i,n,l,h){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var y=p.dependencies;if(y!==null){var A=p.child;y=y.firstContext;t:for(;y!==null;){var C=y;y=p;for(var O=0;O<n.length;O++)if(C.context===n[O]){y.lanes|=l,C=y.alternate,C!==null&&(C.lanes|=l),wu(y.return,l,i),h||(A=null);break t}y=C.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(s(341));A.lanes|=l,y=A.alternate,y!==null&&(y.lanes|=l),wu(A,l,i),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===i){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function Qn(i,n,l,h){i=null;for(var p=n,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var C=p.type;Ze(p.pendingProps.value,A.value)||(i!==null?i.push(C):i=[C])}}else if(p===gt.current){if(A=p.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(La):i=[La])}p=p.return}i!==null&&_u(n,i,l,h),n.flags|=262144}function Ho(i){for(i=i.firstContext;i!==null;){if(!Ze(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function un(i){cn=i,Qs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ee(i){return Ig(cn,i)}function $o(i,n){return cn===null&&un(i),Ig(i,n)}function Ig(i,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},Qs===null){if(i===null)throw Error(s(308));Qs=n,i.dependencies={lanes:0,firstContext:n},i.flags|=524288}else Qs=Qs.next=n;return l}var s_=typeof AbortController<"u"?AbortController:function(){var i=[],n=this.signal={aborted:!1,addEventListener:function(l,h){i.push(h)}};this.abort=function(){n.aborted=!0,i.forEach(function(l){return l()})}},i_=c.unstable_scheduleCallback,n_=c.unstable_NormalPriority,he={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Au(){return{controller:new s_,data:new Map,refCount:0}}function ca(i){i.refCount--,i.refCount===0&&i_(n_,function(){i.controller.abort()})}var ua=null,xu=0,Jn=0,Zn=null;function r_(i,n){if(ua===null){var l=ua=[];xu=0,Jn=Th(),Zn={status:"pending",value:void 0,then:function(h){l.push(h)}}}return xu++,n.then(zg,zg),n}function zg(){if(--xu===0&&ua!==null){Zn!==null&&(Zn.status="fulfilled");var i=ua;ua=null,Jn=0,Zn=null;for(var n=0;n<i.length;n++)(0,i[n])()}}function a_(i,n){var l=[],h={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return i.then(function(){h.status="fulfilled",h.value=n;for(var p=0;p<l.length;p++)(0,l[p])(n)},function(p){for(h.status="rejected",h.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),h}var Fg=B.S;B.S=function(i,n){Sm=We(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&r_(i,n),Fg!==null&&Fg(i,n)};var hn=k(null);function Su(){var i=hn.current;return i!==null?i:qt.pooledCache}function qo(i,n){n===null?J(hn,hn.current):J(hn,n.pool)}function Hg(){var i=Su();return i===null?null:{parent:he._currentValue,pool:i}}var tr=Error(s(460)),Eu=Error(s(474)),Go=Error(s(542)),Vo={then:function(){}};function $g(i){return i=i.status,i==="fulfilled"||i==="rejected"}function qg(i,n,l){switch(l=i[l],l===void 0?i.push(n):l!==n&&(n.then(Ys,Ys),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,Vg(i),i;default:if(typeof n.status=="string")n.then(Ys,Ys);else{if(i=qt,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=n,i.status="pending",i.then(function(h){if(n.status==="pending"){var p=n;p.status="fulfilled",p.value=h}},function(h){if(n.status==="pending"){var p=n;p.status="rejected",p.reason=h}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw i=n.reason,Vg(i),i}throw fn=n,tr}}function dn(i){try{var n=i._init;return n(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(fn=l,tr):l}}var fn=null;function Gg(){if(fn===null)throw Error(s(459));var i=fn;return fn=null,i}function Vg(i){if(i===tr||i===Go)throw Error(s(483))}var er=null,ha=0;function Yo(i){var n=ha;return ha+=1,er===null&&(er=[]),qg(er,i,n)}function da(i,n){n=n.props.ref,i.ref=n!==void 0?n:null}function Xo(i,n){throw n.$$typeof===b?Error(s(525)):(i=Object.prototype.toString.call(n),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)))}function Yg(i){function n(U,j){if(i){var I=U.deletions;I===null?(U.deletions=[j],U.flags|=16):I.push(j)}}function l(U,j){if(!i)return null;for(;j!==null;)n(U,j),j=j.sibling;return null}function h(U){for(var j=new Map;U!==null;)U.key!==null?j.set(U.key,U):j.set(U.index,U),U=U.sibling;return j}function p(U,j){return U=Ks(U,j),U.index=0,U.sibling=null,U}function y(U,j,I){return U.index=I,i?(I=U.alternate,I!==null?(I=I.index,I<j?(U.flags|=67108866,j):I):(U.flags|=67108866,j)):(U.flags|=1048576,j)}function A(U){return i&&U.alternate===null&&(U.flags|=67108866),U}function C(U,j,I,K){return j===null||j.tag!==6?(j=fu(I,U.mode,K),j.return=U,j):(j=p(j,I),j.return=U,j)}function O(U,j,I,K){var ht=I.type;return ht===w?Y(U,j,I.props.children,K,I.key):j!==null&&(j.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===G&&dn(ht)===j.type)?(j=p(j,I.props),da(j,I),j.return=U,j):(j=zo(I.type,I.key,I.props,null,U.mode,K),da(j,I),j.return=U,j)}function z(U,j,I,K){return j===null||j.tag!==4||j.stateNode.containerInfo!==I.containerInfo||j.stateNode.implementation!==I.implementation?(j=gu(I,U.mode,K),j.return=U,j):(j=p(j,I.children||[]),j.return=U,j)}function Y(U,j,I,K,ht){return j===null||j.tag!==7?(j=on(I,U.mode,K,ht),j.return=U,j):(j=p(j,I),j.return=U,j)}function W(U,j,I){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=fu(""+j,U.mode,I),j.return=U,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case v:return I=zo(j.type,j.key,j.props,null,U.mode,I),da(I,j),I.return=U,I;case x:return j=gu(j,U.mode,I),j.return=U,j;case G:return j=dn(j),W(U,j,I)}if(ut(j)||P(j))return j=on(j,U.mode,I,null),j.return=U,j;if(typeof j.then=="function")return W(U,Yo(j),I);if(j.$$typeof===T)return W(U,$o(U,j),I);Xo(U,j)}return null}function H(U,j,I,K){var ht=j!==null?j.key:null;if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return ht!==null?null:C(U,j,""+I,K);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case v:return I.key===ht?O(U,j,I,K):null;case x:return I.key===ht?z(U,j,I,K):null;case G:return I=dn(I),H(U,j,I,K)}if(ut(I)||P(I))return ht!==null?null:Y(U,j,I,K,null);if(typeof I.then=="function")return H(U,j,Yo(I),K);if(I.$$typeof===T)return H(U,j,$o(U,I),K);Xo(U,I)}return null}function q(U,j,I,K,ht){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return U=U.get(I)||null,C(j,U,""+K,ht);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case v:return U=U.get(K.key===null?I:K.key)||null,O(j,U,K,ht);case x:return U=U.get(K.key===null?I:K.key)||null,z(j,U,K,ht);case G:return K=dn(K),q(U,j,I,K,ht)}if(ut(K)||P(K))return U=U.get(I)||null,Y(j,U,K,ht,null);if(typeof K.then=="function")return q(U,j,I,Yo(K),ht);if(K.$$typeof===T)return q(U,j,I,$o(j,K),ht);Xo(j,K)}return null}function rt(U,j,I,K){for(var ht=null,jt=null,ot=j,Et=j=0,Ot=null;ot!==null&&Et<I.length;Et++){ot.index>Et?(Ot=ot,ot=null):Ot=ot.sibling;var Lt=H(U,ot,I[Et],K);if(Lt===null){ot===null&&(ot=Ot);break}i&&ot&&Lt.alternate===null&&n(U,ot),j=y(Lt,j,Et),jt===null?ht=Lt:jt.sibling=Lt,jt=Lt,ot=Ot}if(Et===I.length)return l(U,ot),kt&&Ws(U,Et),ht;if(ot===null){for(;Et<I.length;Et++)ot=W(U,I[Et],K),ot!==null&&(j=y(ot,j,Et),jt===null?ht=ot:jt.sibling=ot,jt=ot);return kt&&Ws(U,Et),ht}for(ot=h(ot);Et<I.length;Et++)Ot=q(ot,U,Et,I[Et],K),Ot!==null&&(i&&Ot.alternate!==null&&ot.delete(Ot.key===null?Et:Ot.key),j=y(Ot,j,Et),jt===null?ht=Ot:jt.sibling=Ot,jt=Ot);return i&&ot.forEach(function(Hi){return n(U,Hi)}),kt&&Ws(U,Et),ht}function pt(U,j,I,K){if(I==null)throw Error(s(151));for(var ht=null,jt=null,ot=j,Et=j=0,Ot=null,Lt=I.next();ot!==null&&!Lt.done;Et++,Lt=I.next()){ot.index>Et?(Ot=ot,ot=null):Ot=ot.sibling;var Hi=H(U,ot,Lt.value,K);if(Hi===null){ot===null&&(ot=Ot);break}i&&ot&&Hi.alternate===null&&n(U,ot),j=y(Hi,j,Et),jt===null?ht=Hi:jt.sibling=Hi,jt=Hi,ot=Ot}if(Lt.done)return l(U,ot),kt&&Ws(U,Et),ht;if(ot===null){for(;!Lt.done;Et++,Lt=I.next())Lt=W(U,Lt.value,K),Lt!==null&&(j=y(Lt,j,Et),jt===null?ht=Lt:jt.sibling=Lt,jt=Lt);return kt&&Ws(U,Et),ht}for(ot=h(ot);!Lt.done;Et++,Lt=I.next())Lt=q(ot,U,Et,Lt.value,K),Lt!==null&&(i&&Lt.alternate!==null&&ot.delete(Lt.key===null?Et:Lt.key),j=y(Lt,j,Et),jt===null?ht=Lt:jt.sibling=Lt,jt=Lt);return i&&ot.forEach(function(yA){return n(U,yA)}),kt&&Ws(U,Et),ht}function Ft(U,j,I,K){if(typeof I=="object"&&I!==null&&I.type===w&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case v:t:{for(var ht=I.key;j!==null;){if(j.key===ht){if(ht=I.type,ht===w){if(j.tag===7){l(U,j.sibling),K=p(j,I.props.children),K.return=U,U=K;break t}}else if(j.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===G&&dn(ht)===j.type){l(U,j.sibling),K=p(j,I.props),da(K,I),K.return=U,U=K;break t}l(U,j);break}else n(U,j);j=j.sibling}I.type===w?(K=on(I.props.children,U.mode,K,I.key),K.return=U,U=K):(K=zo(I.type,I.key,I.props,null,U.mode,K),da(K,I),K.return=U,U=K)}return A(U);case x:t:{for(ht=I.key;j!==null;){if(j.key===ht)if(j.tag===4&&j.stateNode.containerInfo===I.containerInfo&&j.stateNode.implementation===I.implementation){l(U,j.sibling),K=p(j,I.children||[]),K.return=U,U=K;break t}else{l(U,j);break}else n(U,j);j=j.sibling}K=gu(I,U.mode,K),K.return=U,U=K}return A(U);case G:return I=dn(I),Ft(U,j,I,K)}if(ut(I))return rt(U,j,I,K);if(P(I)){if(ht=P(I),typeof ht!="function")throw Error(s(150));return I=ht.call(I),pt(U,j,I,K)}if(typeof I.then=="function")return Ft(U,j,Yo(I),K);if(I.$$typeof===T)return Ft(U,j,$o(U,I),K);Xo(U,I)}return typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint"?(I=""+I,j!==null&&j.tag===6?(l(U,j.sibling),K=p(j,I),K.return=U,U=K):(l(U,j),K=fu(I,U.mode,K),K.return=U,U=K),A(U)):l(U,j)}return function(U,j,I,K){try{ha=0;var ht=Ft(U,j,I,K);return er=null,ht}catch(ot){if(ot===tr||ot===Go)throw ot;var jt=ts(29,ot,null,U.mode);return jt.lanes=K,jt.return=U,jt}finally{}}}var gn=Yg(!0),Xg=Yg(!1),Ei=!1;function Tu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cu(i,n){i=i.updateQueue,n.updateQueue===i&&(n.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ti(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ci(i,n,l){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Pt&2)!==0){var p=h.pending;return p===null?n.next=n:(n.next=p.next,p.next=n),h.pending=n,n=Io(i),kg(i,null,l),n}return Uo(i,h,n,l),Io(i)}function fa(i,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var h=n.lanes;h&=i.pendingLanes,l|=h,n.lanes=l,If(i,l)}}function Ru(i,n){var l=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var p=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var A={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?p=y=A:y=y.next=A,l=l.next}while(l!==null);y===null?p=y=n:y=y.next=n}else p=y=n;l={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=n:i.next=n,l.lastBaseUpdate=n}var Nu=!1;function ga(){if(Nu){var i=Zn;if(i!==null)throw i}}function pa(i,n,l,h){Nu=!1;var p=i.updateQueue;Ei=!1;var y=p.firstBaseUpdate,A=p.lastBaseUpdate,C=p.shared.pending;if(C!==null){p.shared.pending=null;var O=C,z=O.next;O.next=null,A===null?y=z:A.next=z,A=O;var Y=i.alternate;Y!==null&&(Y=Y.updateQueue,C=Y.lastBaseUpdate,C!==A&&(C===null?Y.firstBaseUpdate=z:C.next=z,Y.lastBaseUpdate=O))}if(y!==null){var W=p.baseState;A=0,Y=z=O=null,C=y;do{var H=C.lane&-536870913,q=H!==C.lane;if(q?(Nt&H)===H:(h&H)===H){H!==0&&H===Jn&&(Nu=!0),Y!==null&&(Y=Y.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});t:{var rt=i,pt=C;H=n;var Ft=l;switch(pt.tag){case 1:if(rt=pt.payload,typeof rt=="function"){W=rt.call(Ft,W,H);break t}W=rt;break t;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=pt.payload,H=typeof rt=="function"?rt.call(Ft,W,H):rt,H==null)break t;W=m({},W,H);break t;case 2:Ei=!0}}H=C.callback,H!==null&&(i.flags|=64,q&&(i.flags|=8192),q=p.callbacks,q===null?p.callbacks=[H]:q.push(H))}else q={lane:H,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Y===null?(z=Y=q,O=W):Y=Y.next=q,A|=H;if(C=C.next,C===null){if(C=p.shared.pending,C===null)break;q=C,C=q.next,q.next=null,p.lastBaseUpdate=q,p.shared.pending=null}}while(!0);Y===null&&(O=W),p.baseState=O,p.firstBaseUpdate=z,p.lastBaseUpdate=Y,y===null&&(p.shared.lanes=0),Di|=A,i.lanes=A,i.memoizedState=W}}function Kg(i,n){if(typeof i!="function")throw Error(s(191,i));i.call(n)}function Wg(i,n){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Kg(l[i],n)}var sr=k(null),Ko=k(0);function Qg(i,n){i=oi,J(Ko,i),J(sr,n),oi=i|n.baseLanes}function Ou(){J(Ko,oi),J(sr,sr.current)}function ku(){oi=Ko.current,V(sr),V(Ko)}var es=k(null),bs=null;function Ri(i){var n=i.alternate;J(le,le.current&1),J(es,i),bs===null&&(n===null||sr.current!==null||n.memoizedState!==null)&&(bs=i)}function Du(i){J(le,le.current),J(es,i),bs===null&&(bs=i)}function Jg(i){i.tag===22?(J(le,le.current),J(es,i),bs===null&&(bs=i)):Ni()}function Ni(){J(le,le.current),J(es,es.current)}function ss(i){V(es),bs===i&&(bs=null),V(le)}var le=k(0);function Wo(i){for(var n=i;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Uh(l)||Ih(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Zs=0,xt=null,It=null,de=null,Qo=!1,ir=!1,pn=!1,Jo=0,ma=0,nr=null,o_=0;function ne(){throw Error(s(321))}function Mu(i,n){if(n===null)return!1;for(var l=0;l<n.length&&l<i.length;l++)if(!Ze(i[l],n[l]))return!1;return!0}function ju(i,n,l,h,p,y){return Zs=y,xt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,B.H=i===null||i.memoizedState===null?Lp:Ku,pn=!1,y=l(h,p),pn=!1,ir&&(y=tp(n,l,h,p)),Zg(i),y}function Zg(i){B.H=va;var n=It!==null&&It.next!==null;if(Zs=0,de=It=xt=null,Qo=!1,ma=0,nr=null,n)throw Error(s(300));i===null||fe||(i=i.dependencies,i!==null&&Ho(i)&&(fe=!0))}function tp(i,n,l,h){xt=i;var p=0;do{if(ir&&(nr=null),ma=0,ir=!1,25<=p)throw Error(s(301));if(p+=1,de=It=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=Pp,y=n(l,h)}while(ir);return y}function l_(){var i=B.H,n=i.useState()[0];return n=typeof n.then=="function"?ya(n):n,i=i.useState()[0],(It!==null?It.memoizedState:null)!==i&&(xt.flags|=1024),n}function Lu(){var i=Jo!==0;return Jo=0,i}function Pu(i,n,l){n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~l}function Bu(i){if(Qo){for(i=i.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}Qo=!1}Zs=0,de=It=xt=null,ir=!1,ma=Jo=0,nr=null}function Le(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return de===null?xt.memoizedState=de=i:de=de.next=i,de}function ce(){if(It===null){var i=xt.alternate;i=i!==null?i.memoizedState:null}else i=It.next;var n=de===null?xt.memoizedState:de.next;if(n!==null)de=n,It=i;else{if(i===null)throw xt.alternate===null?Error(s(467)):Error(s(310));It=i,i={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},de===null?xt.memoizedState=de=i:de=de.next=i}return de}function Zo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ya(i){var n=ma;return ma+=1,nr===null&&(nr=[]),i=qg(nr,i,n),n=xt,(de===null?n.memoizedState:de.next)===null&&(n=n.alternate,B.H=n===null||n.memoizedState===null?Lp:Ku),i}function tl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ya(i);if(i.$$typeof===T)return Ee(i)}throw Error(s(438,String(i)))}function Uu(i){var n=null,l=xt.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var h=xt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(n={data:h.data.map(function(p){return p.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=Zo(),xt.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(i),h=0;h<i;h++)l[h]=et;return n.index++,l}function ti(i,n){return typeof n=="function"?n(i):n}function el(i){var n=ce();return Iu(n,It,i)}function Iu(i,n,l){var h=i.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var p=i.baseQueue,y=h.pending;if(y!==null){if(p!==null){var A=p.next;p.next=y.next,y.next=A}n.baseQueue=p=y,h.pending=null}if(y=i.baseState,p===null)i.memoizedState=y;else{n=p.next;var C=A=null,O=null,z=n,Y=!1;do{var W=z.lane&-536870913;if(W!==z.lane?(Nt&W)===W:(Zs&W)===W){var H=z.revertLane;if(H===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),W===Jn&&(Y=!0);else if((Zs&H)===H){z=z.next,H===Jn&&(Y=!0);continue}else W={lane:0,revertLane:z.revertLane,gesture:null,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},O===null?(C=O=W,A=y):O=O.next=W,xt.lanes|=H,Di|=H;W=z.action,pn&&l(y,W),y=z.hasEagerState?z.eagerState:l(y,W)}else H={lane:W,revertLane:z.revertLane,gesture:z.gesture,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},O===null?(C=O=H,A=y):O=O.next=H,xt.lanes|=W,Di|=W;z=z.next}while(z!==null&&z!==n);if(O===null?A=y:O.next=C,!Ze(y,i.memoizedState)&&(fe=!0,Y&&(l=Zn,l!==null)))throw l;i.memoizedState=y,i.baseState=A,i.baseQueue=O,h.lastRenderedState=y}return p===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function zu(i){var n=ce(),l=n.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=i;var h=l.dispatch,p=l.pending,y=n.memoizedState;if(p!==null){l.pending=null;var A=p=p.next;do y=i(y,A.action),A=A.next;while(A!==p);Ze(y,n.memoizedState)||(fe=!0),n.memoizedState=y,n.baseQueue===null&&(n.baseState=y),l.lastRenderedState=y}return[y,h]}function ep(i,n,l){var h=xt,p=ce(),y=kt;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=n();var A=!Ze((It||p).memoizedState,l);if(A&&(p.memoizedState=l,fe=!0),p=p.queue,$u(np.bind(null,h,p,i),[i]),p.getSnapshot!==n||A||de!==null&&de.memoizedState.tag&1){if(h.flags|=2048,rr(9,{destroy:void 0},ip.bind(null,h,p,l,n),null),qt===null)throw Error(s(349));y||(Zs&127)!==0||sp(h,n,l)}return l}function sp(i,n,l){i.flags|=16384,i={getSnapshot:n,value:l},n=xt.updateQueue,n===null?(n=Zo(),xt.updateQueue=n,n.stores=[i]):(l=n.stores,l===null?n.stores=[i]:l.push(i))}function ip(i,n,l,h){n.value=l,n.getSnapshot=h,rp(n)&&ap(i)}function np(i,n,l){return l(function(){rp(n)&&ap(i)})}function rp(i){var n=i.getSnapshot;i=i.value;try{var l=n();return!Ze(i,l)}catch{return!0}}function ap(i){var n=an(i,2);n!==null&&Ve(n,i,2)}function Fu(i){var n=Le();if(typeof i=="function"){var l=i;if(i=l(),pn){bi(!0);try{l()}finally{bi(!1)}}}return n.memoizedState=n.baseState=i,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:i},n}function op(i,n,l,h){return i.baseState=l,Iu(i,It,typeof h=="function"?h:ti)}function c_(i,n,l,h,p){if(nl(i))throw Error(s(485));if(i=n.action,i!==null){var y={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){y.listeners.push(A)}};B.T!==null?l(!0):y.isTransition=!1,h(y),l=n.pending,l===null?(y.next=n.pending=y,lp(n,y)):(y.next=l.next,n.pending=l.next=y)}}function lp(i,n){var l=n.action,h=n.payload,p=i.state;if(n.isTransition){var y=B.T,A={};B.T=A;try{var C=l(p,h),O=B.S;O!==null&&O(A,C),cp(i,n,C)}catch(z){Hu(i,n,z)}finally{y!==null&&A.types!==null&&(y.types=A.types),B.T=y}}else try{y=l(p,h),cp(i,n,y)}catch(z){Hu(i,n,z)}}function cp(i,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){up(i,n,h)},function(h){return Hu(i,n,h)}):up(i,n,l)}function up(i,n,l){n.status="fulfilled",n.value=l,hp(n),i.state=l,n=i.pending,n!==null&&(l=n.next,l===n?i.pending=null:(l=l.next,n.next=l,lp(i,l)))}function Hu(i,n,l){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do n.status="rejected",n.reason=l,hp(n),n=n.next;while(n!==h)}i.action=null}function hp(i){i=i.listeners;for(var n=0;n<i.length;n++)(0,i[n])()}function dp(i,n){return n}function fp(i,n){if(kt){var l=qt.formState;if(l!==null){t:{var h=xt;if(kt){if(Xt){e:{for(var p=Xt,y=ys;p.nodeType!==8;){if(!y){p=null;break e}if(p=vs(p.nextSibling),p===null){p=null;break e}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){Xt=vs(p.nextSibling),h=p.data==="F!";break t}}xi(h)}h=!1}h&&(n=l[0])}}return l=Le(),l.memoizedState=l.baseState=n,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dp,lastRenderedState:n},l.queue=h,l=Dp.bind(null,xt,h),h.dispatch=l,h=Fu(!1),y=Xu.bind(null,xt,!1,h.queue),h=Le(),p={state:n,dispatch:null,action:i,pending:null},h.queue=p,l=c_.bind(null,xt,p,y,l),p.dispatch=l,h.memoizedState=i,[n,l,!1]}function gp(i){var n=ce();return pp(n,It,i)}function pp(i,n,l){if(n=Iu(i,n,dp)[0],i=el(ti)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var h=ya(n)}catch(A){throw A===tr?Go:A}else h=n;n=ce();var p=n.queue,y=p.dispatch;return l!==n.memoizedState&&(xt.flags|=2048,rr(9,{destroy:void 0},u_.bind(null,p,l),null)),[h,y,i]}function u_(i,n){i.action=n}function mp(i){var n=ce(),l=It;if(l!==null)return pp(n,l,i);ce(),n=n.memoizedState,l=ce();var h=l.queue.dispatch;return l.memoizedState=i,[n,h,!1]}function rr(i,n,l,h){return i={tag:i,create:l,deps:h,inst:n,next:null},n=xt.updateQueue,n===null&&(n=Zo(),xt.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=i.next=i:(h=l.next,l.next=i,i.next=h,n.lastEffect=i),i}function yp(){return ce().memoizedState}function sl(i,n,l,h){var p=Le();xt.flags|=i,p.memoizedState=rr(1|n,{destroy:void 0},l,h===void 0?null:h)}function il(i,n,l,h){var p=ce();h=h===void 0?null:h;var y=p.memoizedState.inst;It!==null&&h!==null&&Mu(h,It.memoizedState.deps)?p.memoizedState=rr(n,y,l,h):(xt.flags|=i,p.memoizedState=rr(1|n,y,l,h))}function bp(i,n){sl(8390656,8,i,n)}function $u(i,n){il(2048,8,i,n)}function h_(i){xt.flags|=4;var n=xt.updateQueue;if(n===null)n=Zo(),xt.updateQueue=n,n.events=[i];else{var l=n.events;l===null?n.events=[i]:l.push(i)}}function vp(i){var n=ce().memoizedState;return h_({ref:n,nextImpl:i}),function(){if((Pt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function wp(i,n){return il(4,2,i,n)}function _p(i,n){return il(4,4,i,n)}function Ap(i,n){if(typeof n=="function"){i=i();var l=n(i);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return i=i(),n.current=i,function(){n.current=null}}function xp(i,n,l){l=l!=null?l.concat([i]):null,il(4,4,Ap.bind(null,n,i),l)}function qu(){}function Sp(i,n){var l=ce();n=n===void 0?null:n;var h=l.memoizedState;return n!==null&&Mu(n,h[1])?h[0]:(l.memoizedState=[i,n],i)}function Ep(i,n){var l=ce();n=n===void 0?null:n;var h=l.memoizedState;if(n!==null&&Mu(n,h[1]))return h[0];if(h=i(),pn){bi(!0);try{i()}finally{bi(!1)}}return l.memoizedState=[h,n],h}function Gu(i,n,l){return l===void 0||(Zs&1073741824)!==0&&(Nt&261930)===0?i.memoizedState=n:(i.memoizedState=l,i=Tm(),xt.lanes|=i,Di|=i,l)}function Tp(i,n,l,h){return Ze(l,n)?l:sr.current!==null?(i=Gu(i,l,h),Ze(i,n)||(fe=!0),i):(Zs&42)===0||(Zs&1073741824)!==0&&(Nt&261930)===0?(fe=!0,i.memoizedState=l):(i=Tm(),xt.lanes|=i,Di|=i,n)}function Cp(i,n,l,h,p){var y=$.p;$.p=y!==0&&8>y?y:8;var A=B.T,C={};B.T=C,Xu(i,!1,n,l);try{var O=p(),z=B.S;if(z!==null&&z(C,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var Y=a_(O,h);ba(i,n,Y,rs(i))}else ba(i,n,h,rs(i))}catch(W){ba(i,n,{then:function(){},status:"rejected",reason:W},rs())}finally{$.p=y,A!==null&&C.types!==null&&(A.types=C.types),B.T=A}}function d_(){}function Vu(i,n,l,h){if(i.tag!==5)throw Error(s(476));var p=Rp(i).queue;Cp(i,p,n,st,l===null?d_:function(){return Np(i),l(h)})}function Rp(i){var n=i.memoizedState;if(n!==null)return n;n={memoizedState:st,baseState:st,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:st},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:l},next:null},i.memoizedState=n,i=i.alternate,i!==null&&(i.memoizedState=n),n}function Np(i){var n=Rp(i);n.next===null&&(n=i.alternate.memoizedState),ba(i,n.next.queue,{},rs())}function Yu(){return Ee(La)}function Op(){return ce().memoizedState}function kp(){return ce().memoizedState}function f_(i){for(var n=i.return;n!==null;){switch(n.tag){case 24:case 3:var l=rs();i=Ti(l);var h=Ci(n,i,l);h!==null&&(Ve(h,n,l),fa(h,n,l)),n={cache:Au()},i.payload=n;return}n=n.return}}function g_(i,n,l){var h=rs();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},nl(i)?Mp(n,l):(l=hu(i,n,l,h),l!==null&&(Ve(l,i,h),jp(l,n,h)))}function Dp(i,n,l){var h=rs();ba(i,n,l,h)}function ba(i,n,l,h){var p={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(nl(i))Mp(n,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=n.lastRenderedReducer,y!==null))try{var A=n.lastRenderedState,C=y(A,l);if(p.hasEagerState=!0,p.eagerState=C,Ze(C,A))return Uo(i,n,p,0),qt===null&&Bo(),!1}catch{}finally{}if(l=hu(i,n,p,h),l!==null)return Ve(l,i,h),jp(l,n,h),!0}return!1}function Xu(i,n,l,h){if(h={lane:2,revertLane:Th(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},nl(i)){if(n)throw Error(s(479))}else n=hu(i,l,h,2),n!==null&&Ve(n,i,2)}function nl(i){var n=i.alternate;return i===xt||n!==null&&n===xt}function Mp(i,n){ir=Qo=!0;var l=i.pending;l===null?n.next=n:(n.next=l.next,l.next=n),i.pending=n}function jp(i,n,l){if((l&4194048)!==0){var h=n.lanes;h&=i.pendingLanes,l|=h,n.lanes=l,If(i,l)}}var va={readContext:Ee,use:tl,useCallback:ne,useContext:ne,useEffect:ne,useImperativeHandle:ne,useLayoutEffect:ne,useInsertionEffect:ne,useMemo:ne,useReducer:ne,useRef:ne,useState:ne,useDebugValue:ne,useDeferredValue:ne,useTransition:ne,useSyncExternalStore:ne,useId:ne,useHostTransitionStatus:ne,useFormState:ne,useActionState:ne,useOptimistic:ne,useMemoCache:ne,useCacheRefresh:ne};va.useEffectEvent=ne;var Lp={readContext:Ee,use:tl,useCallback:function(i,n){return Le().memoizedState=[i,n===void 0?null:n],i},useContext:Ee,useEffect:bp,useImperativeHandle:function(i,n,l){l=l!=null?l.concat([i]):null,sl(4194308,4,Ap.bind(null,n,i),l)},useLayoutEffect:function(i,n){return sl(4194308,4,i,n)},useInsertionEffect:function(i,n){sl(4,2,i,n)},useMemo:function(i,n){var l=Le();n=n===void 0?null:n;var h=i();if(pn){bi(!0);try{i()}finally{bi(!1)}}return l.memoizedState=[h,n],h},useReducer:function(i,n,l){var h=Le();if(l!==void 0){var p=l(n);if(pn){bi(!0);try{l(n)}finally{bi(!1)}}}else p=n;return h.memoizedState=h.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},h.queue=i,i=i.dispatch=g_.bind(null,xt,i),[h.memoizedState,i]},useRef:function(i){var n=Le();return i={current:i},n.memoizedState=i},useState:function(i){i=Fu(i);var n=i.queue,l=Dp.bind(null,xt,n);return n.dispatch=l,[i.memoizedState,l]},useDebugValue:qu,useDeferredValue:function(i,n){var l=Le();return Gu(l,i,n)},useTransition:function(){var i=Fu(!1);return i=Cp.bind(null,xt,i.queue,!0,!1),Le().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,n,l){var h=xt,p=Le();if(kt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=n(),qt===null)throw Error(s(349));(Nt&127)!==0||sp(h,n,l)}p.memoizedState=l;var y={value:l,getSnapshot:n};return p.queue=y,bp(np.bind(null,h,y,i),[i]),h.flags|=2048,rr(9,{destroy:void 0},ip.bind(null,h,y,l,n),null),l},useId:function(){var i=Le(),n=qt.identifierPrefix;if(kt){var l=js,h=Ms;l=(h&~(1<<32-Je(h)-1)).toString(32)+l,n="_"+n+"R_"+l,l=Jo++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=o_++,n="_"+n+"r_"+l.toString(32)+"_";return i.memoizedState=n},useHostTransitionStatus:Yu,useFormState:fp,useActionState:fp,useOptimistic:function(i){var n=Le();n.memoizedState=n.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=Xu.bind(null,xt,!0,l),l.dispatch=n,[i,n]},useMemoCache:Uu,useCacheRefresh:function(){return Le().memoizedState=f_.bind(null,xt)},useEffectEvent:function(i){var n=Le(),l={impl:i};return n.memoizedState=l,function(){if((Pt&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Ku={readContext:Ee,use:tl,useCallback:Sp,useContext:Ee,useEffect:$u,useImperativeHandle:xp,useInsertionEffect:wp,useLayoutEffect:_p,useMemo:Ep,useReducer:el,useRef:yp,useState:function(){return el(ti)},useDebugValue:qu,useDeferredValue:function(i,n){var l=ce();return Tp(l,It.memoizedState,i,n)},useTransition:function(){var i=el(ti)[0],n=ce().memoizedState;return[typeof i=="boolean"?i:ya(i),n]},useSyncExternalStore:ep,useId:Op,useHostTransitionStatus:Yu,useFormState:gp,useActionState:gp,useOptimistic:function(i,n){var l=ce();return op(l,It,i,n)},useMemoCache:Uu,useCacheRefresh:kp};Ku.useEffectEvent=vp;var Pp={readContext:Ee,use:tl,useCallback:Sp,useContext:Ee,useEffect:$u,useImperativeHandle:xp,useInsertionEffect:wp,useLayoutEffect:_p,useMemo:Ep,useReducer:zu,useRef:yp,useState:function(){return zu(ti)},useDebugValue:qu,useDeferredValue:function(i,n){var l=ce();return It===null?Gu(l,i,n):Tp(l,It.memoizedState,i,n)},useTransition:function(){var i=zu(ti)[0],n=ce().memoizedState;return[typeof i=="boolean"?i:ya(i),n]},useSyncExternalStore:ep,useId:Op,useHostTransitionStatus:Yu,useFormState:mp,useActionState:mp,useOptimistic:function(i,n){var l=ce();return It!==null?op(l,It,i,n):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Uu,useCacheRefresh:kp};Pp.useEffectEvent=vp;function Wu(i,n,l,h){n=i.memoizedState,l=l(h,n),l=l==null?n:m({},n,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Qu={enqueueSetState:function(i,n,l){i=i._reactInternals;var h=rs(),p=Ti(h);p.payload=n,l!=null&&(p.callback=l),n=Ci(i,p,h),n!==null&&(Ve(n,i,h),fa(n,i,h))},enqueueReplaceState:function(i,n,l){i=i._reactInternals;var h=rs(),p=Ti(h);p.tag=1,p.payload=n,l!=null&&(p.callback=l),n=Ci(i,p,h),n!==null&&(Ve(n,i,h),fa(n,i,h))},enqueueForceUpdate:function(i,n){i=i._reactInternals;var l=rs(),h=Ti(l);h.tag=2,n!=null&&(h.callback=n),n=Ci(i,h,l),n!==null&&(Ve(n,i,l),fa(n,i,l))}};function Bp(i,n,l,h,p,y,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,A):n.prototype&&n.prototype.isPureReactComponent?!ra(l,h)||!ra(p,y):!0}function Up(i,n,l,h){i=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,h),n.state!==i&&Qu.enqueueReplaceState(n,n.state,null)}function mn(i,n){var l=n;if("ref"in n){l={};for(var h in n)h!=="ref"&&(l[h]=n[h])}if(i=i.defaultProps){l===n&&(l=m({},l));for(var p in i)l[p]===void 0&&(l[p]=i[p])}return l}function Ip(i){Po(i)}function zp(i){console.error(i)}function Fp(i){Po(i)}function rl(i,n){try{var l=i.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(h){setTimeout(function(){throw h})}}function Hp(i,n,l){try{var h=i.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Ju(i,n,l){return l=Ti(l),l.tag=3,l.payload={element:null},l.callback=function(){rl(i,n)},l}function $p(i){return i=Ti(i),i.tag=3,i}function qp(i,n,l,h){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var y=h.value;i.payload=function(){return p(y)},i.callback=function(){Hp(n,l,h)}}var A=l.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){Hp(n,l,h),typeof p!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var C=h.stack;this.componentDidCatch(h.value,{componentStack:C!==null?C:""})})}function p_(i,n,l,h,p){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(n=l.alternate,n!==null&&Qn(n,l,p,!0),l=es.current,l!==null){switch(l.tag){case 31:case 13:return bs===null?yl():l.alternate===null&&re===0&&(re=3),l.flags&=-257,l.flags|=65536,l.lanes=p,h===Vo?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([h]):n.add(h),xh(i,h,p)),!1;case 22:return l.flags|=65536,h===Vo?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([h]):l.add(h)),xh(i,h,p)),!1}throw Error(s(435,l.tag))}return xh(i,h,p),yl(),!1}if(kt)return n=es.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=p,h!==yu&&(i=Error(s(422),{cause:h}),la(gs(i,l)))):(h!==yu&&(n=Error(s(423),{cause:h}),la(gs(n,l))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,h=gs(h,l),p=Ju(i.stateNode,h,p),Ru(i,p),re!==4&&(re=2)),!1;var y=Error(s(520),{cause:h});if(y=gs(y,l),Ca===null?Ca=[y]:Ca.push(y),re!==4&&(re=2),n===null)return!0;h=gs(h,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,i=p&-p,l.lanes|=i,i=Ju(l.stateNode,h,i),Ru(l,i),!1;case 1:if(n=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Mi===null||!Mi.has(y))))return l.flags|=65536,p&=-p,l.lanes|=p,p=$p(p),qp(p,i,l,h),Ru(l,p),!1}l=l.return}while(l!==null);return!1}var Zu=Error(s(461)),fe=!1;function Te(i,n,l,h){n.child=i===null?Xg(n,null,l,h):gn(n,i.child,l,h)}function Gp(i,n,l,h,p){l=l.render;var y=n.ref;if("ref"in h){var A={};for(var C in h)C!=="ref"&&(A[C]=h[C])}else A=h;return un(n),h=ju(i,n,l,A,y,p),C=Lu(),i!==null&&!fe?(Pu(i,n,p),ei(i,n,p)):(kt&&C&&pu(n),n.flags|=1,Te(i,n,h,p),n.child)}function Vp(i,n,l,h,p){if(i===null){var y=l.type;return typeof y=="function"&&!du(y)&&y.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=y,Yp(i,n,y,h,p)):(i=zo(l.type,null,h,n,n.mode,p),i.ref=n.ref,i.return=n,n.child=i)}if(y=i.child,!oh(i,p)){var A=y.memoizedProps;if(l=l.compare,l=l!==null?l:ra,l(A,h)&&i.ref===n.ref)return ei(i,n,p)}return n.flags|=1,i=Ks(y,h),i.ref=n.ref,i.return=n,n.child=i}function Yp(i,n,l,h,p){if(i!==null){var y=i.memoizedProps;if(ra(y,h)&&i.ref===n.ref)if(fe=!1,n.pendingProps=h=y,oh(i,p))(i.flags&131072)!==0&&(fe=!0);else return n.lanes=i.lanes,ei(i,n,p)}return th(i,n,l,h,p)}function Xp(i,n,l,h){var p=h.children,y=i!==null?i.memoizedState:null;if(i===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((n.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,i!==null){for(h=n.child=i.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;h=p&~y}else h=0,n.child=null;return Kp(i,n,y,l,h)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},i!==null&&qo(n,y!==null?y.cachePool:null),y!==null?Qg(n,y):Ou(),Jg(n);else return h=n.lanes=536870912,Kp(i,n,y!==null?y.baseLanes|l:l,l,h)}else y!==null?(qo(n,y.cachePool),Qg(n,y),Ni(),n.memoizedState=null):(i!==null&&qo(n,null),Ou(),Ni());return Te(i,n,p,l),n.child}function wa(i,n){return i!==null&&i.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Kp(i,n,l,h,p){var y=Su();return y=y===null?null:{parent:he._currentValue,pool:y},n.memoizedState={baseLanes:l,cachePool:y},i!==null&&qo(n,null),Ou(),Jg(n),i!==null&&Qn(i,n,h,!0),n.childLanes=p,null}function al(i,n){return n=ll({mode:n.mode,children:n.children},i.mode),n.ref=i.ref,i.child=n,n.return=i,n}function Wp(i,n,l){return gn(n,i.child,null,l),i=al(n,n.pendingProps),i.flags|=2,ss(n),n.memoizedState=null,i}function m_(i,n,l){var h=n.pendingProps,p=(n.flags&128)!==0;if(n.flags&=-129,i===null){if(kt){if(h.mode==="hidden")return i=al(n,h),n.lanes=536870912,wa(null,i);if(Du(n),(i=Xt)?(i=ly(i,ys),i=i!==null&&i.data==="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:_i!==null?{id:Ms,overflow:js}:null,retryLane:536870912,hydrationErrors:null},l=Mg(i),l.return=n,n.child=l,Se=n,Xt=null)):i=null,i===null)throw xi(n);return n.lanes=536870912,null}return al(n,h)}var y=i.memoizedState;if(y!==null){var A=y.dehydrated;if(Du(n),p)if(n.flags&256)n.flags&=-257,n=Wp(i,n,l);else if(n.memoizedState!==null)n.child=i.child,n.flags|=128,n=null;else throw Error(s(558));else if(fe||Qn(i,n,l,!1),p=(l&i.childLanes)!==0,fe||p){if(h=qt,h!==null&&(A=zf(h,l),A!==0&&A!==y.retryLane))throw y.retryLane=A,an(i,A),Ve(h,i,A),Zu;yl(),n=Wp(i,n,l)}else i=y.treeContext,Xt=vs(A.nextSibling),Se=n,kt=!0,Ai=null,ys=!1,i!==null&&Pg(n,i),n=al(n,h),n.flags|=4096;return n}return i=Ks(i.child,{mode:h.mode,children:h.children}),i.ref=n.ref,n.child=i,i.return=n,i}function ol(i,n){var l=n.ref;if(l===null)i!==null&&i.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(i===null||i.ref!==l)&&(n.flags|=4194816)}}function th(i,n,l,h,p){return un(n),l=ju(i,n,l,h,void 0,p),h=Lu(),i!==null&&!fe?(Pu(i,n,p),ei(i,n,p)):(kt&&h&&pu(n),n.flags|=1,Te(i,n,l,p),n.child)}function Qp(i,n,l,h,p,y){return un(n),n.updateQueue=null,l=tp(n,h,l,p),Zg(i),h=Lu(),i!==null&&!fe?(Pu(i,n,y),ei(i,n,y)):(kt&&h&&pu(n),n.flags|=1,Te(i,n,l,y),n.child)}function Jp(i,n,l,h,p){if(un(n),n.stateNode===null){var y=Yn,A=l.contextType;typeof A=="object"&&A!==null&&(y=Ee(A)),y=new l(h,y),n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Qu,n.stateNode=y,y._reactInternals=n,y=n.stateNode,y.props=h,y.state=n.memoizedState,y.refs={},Tu(n),A=l.contextType,y.context=typeof A=="object"&&A!==null?Ee(A):Yn,y.state=n.memoizedState,A=l.getDerivedStateFromProps,typeof A=="function"&&(Wu(n,l,A,h),y.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(A=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),A!==y.state&&Qu.enqueueReplaceState(y,y.state,null),pa(n,h,y,p),ga(),y.state=n.memoizedState),typeof y.componentDidMount=="function"&&(n.flags|=4194308),h=!0}else if(i===null){y=n.stateNode;var C=n.memoizedProps,O=mn(l,C);y.props=O;var z=y.context,Y=l.contextType;A=Yn,typeof Y=="object"&&Y!==null&&(A=Ee(Y));var W=l.getDerivedStateFromProps;Y=typeof W=="function"||typeof y.getSnapshotBeforeUpdate=="function",C=n.pendingProps!==C,Y||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C||z!==A)&&Up(n,y,h,A),Ei=!1;var H=n.memoizedState;y.state=H,pa(n,h,y,p),ga(),z=n.memoizedState,C||H!==z||Ei?(typeof W=="function"&&(Wu(n,l,W,h),z=n.memoizedState),(O=Ei||Bp(n,l,O,h,H,z,A))?(Y||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(n.flags|=4194308)):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=h,n.memoizedState=z),y.props=h,y.state=z,y.context=A,h=O):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),h=!1)}else{y=n.stateNode,Cu(i,n),A=n.memoizedProps,Y=mn(l,A),y.props=Y,W=n.pendingProps,H=y.context,z=l.contextType,O=Yn,typeof z=="object"&&z!==null&&(O=Ee(z)),C=l.getDerivedStateFromProps,(z=typeof C=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(A!==W||H!==O)&&Up(n,y,h,O),Ei=!1,H=n.memoizedState,y.state=H,pa(n,h,y,p),ga();var q=n.memoizedState;A!==W||H!==q||Ei||i!==null&&i.dependencies!==null&&Ho(i.dependencies)?(typeof C=="function"&&(Wu(n,l,C,h),q=n.memoizedState),(Y=Ei||Bp(n,l,Y,h,H,q,O)||i!==null&&i.dependencies!==null&&Ho(i.dependencies))?(z||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,q,O),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,q,O)),typeof y.componentDidUpdate=="function"&&(n.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof y.componentDidUpdate!="function"||A===i.memoizedProps&&H===i.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&H===i.memoizedState||(n.flags|=1024),n.memoizedProps=h,n.memoizedState=q),y.props=h,y.state=q,y.context=O,h=Y):(typeof y.componentDidUpdate!="function"||A===i.memoizedProps&&H===i.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&H===i.memoizedState||(n.flags|=1024),h=!1)}return y=h,ol(i,n),h=(n.flags&128)!==0,y||h?(y=n.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:y.render(),n.flags|=1,i!==null&&h?(n.child=gn(n,i.child,null,p),n.child=gn(n,null,l,p)):Te(i,n,l,p),n.memoizedState=y.state,i=n.child):i=ei(i,n,p),i}function Zp(i,n,l,h){return ln(),n.flags|=256,Te(i,n,l,h),n.child}var eh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sh(i){return{baseLanes:i,cachePool:Hg()}}function ih(i,n,l){return i=i!==null?i.childLanes&~l:0,n&&(i|=ns),i}function tm(i,n,l){var h=n.pendingProps,p=!1,y=(n.flags&128)!==0,A;if((A=y)||(A=i!==null&&i.memoizedState===null?!1:(le.current&2)!==0),A&&(p=!0,n.flags&=-129),A=(n.flags&32)!==0,n.flags&=-33,i===null){if(kt){if(p?Ri(n):Ni(),(i=Xt)?(i=ly(i,ys),i=i!==null&&i.data!=="&"?i:null,i!==null&&(n.memoizedState={dehydrated:i,treeContext:_i!==null?{id:Ms,overflow:js}:null,retryLane:536870912,hydrationErrors:null},l=Mg(i),l.return=n,n.child=l,Se=n,Xt=null)):i=null,i===null)throw xi(n);return Ih(i)?n.lanes=32:n.lanes=536870912,null}var C=h.children;return h=h.fallback,p?(Ni(),p=n.mode,C=ll({mode:"hidden",children:C},p),h=on(h,p,l,null),C.return=n,h.return=n,C.sibling=h,n.child=C,h=n.child,h.memoizedState=sh(l),h.childLanes=ih(i,A,l),n.memoizedState=eh,wa(null,h)):(Ri(n),nh(n,C))}var O=i.memoizedState;if(O!==null&&(C=O.dehydrated,C!==null)){if(y)n.flags&256?(Ri(n),n.flags&=-257,n=rh(i,n,l)):n.memoizedState!==null?(Ni(),n.child=i.child,n.flags|=128,n=null):(Ni(),C=h.fallback,p=n.mode,h=ll({mode:"visible",children:h.children},p),C=on(C,p,l,null),C.flags|=2,h.return=n,C.return=n,h.sibling=C,n.child=h,gn(n,i.child,null,l),h=n.child,h.memoizedState=sh(l),h.childLanes=ih(i,A,l),n.memoizedState=eh,n=wa(null,h));else if(Ri(n),Ih(C)){if(A=C.nextSibling&&C.nextSibling.dataset,A)var z=A.dgst;A=z,h=Error(s(419)),h.stack="",h.digest=A,la({value:h,source:null,stack:null}),n=rh(i,n,l)}else if(fe||Qn(i,n,l,!1),A=(l&i.childLanes)!==0,fe||A){if(A=qt,A!==null&&(h=zf(A,l),h!==0&&h!==O.retryLane))throw O.retryLane=h,an(i,h),Ve(A,i,h),Zu;Uh(C)||yl(),n=rh(i,n,l)}else Uh(C)?(n.flags|=192,n.child=i.child,n=null):(i=O.treeContext,Xt=vs(C.nextSibling),Se=n,kt=!0,Ai=null,ys=!1,i!==null&&Pg(n,i),n=nh(n,h.children),n.flags|=4096);return n}return p?(Ni(),C=h.fallback,p=n.mode,O=i.child,z=O.sibling,h=Ks(O,{mode:"hidden",children:h.children}),h.subtreeFlags=O.subtreeFlags&65011712,z!==null?C=Ks(z,C):(C=on(C,p,l,null),C.flags|=2),C.return=n,h.return=n,h.sibling=C,n.child=h,wa(null,h),h=n.child,C=i.child.memoizedState,C===null?C=sh(l):(p=C.cachePool,p!==null?(O=he._currentValue,p=p.parent!==O?{parent:O,pool:O}:p):p=Hg(),C={baseLanes:C.baseLanes|l,cachePool:p}),h.memoizedState=C,h.childLanes=ih(i,A,l),n.memoizedState=eh,wa(i.child,h)):(Ri(n),l=i.child,i=l.sibling,l=Ks(l,{mode:"visible",children:h.children}),l.return=n,l.sibling=null,i!==null&&(A=n.deletions,A===null?(n.deletions=[i],n.flags|=16):A.push(i)),n.child=l,n.memoizedState=null,l)}function nh(i,n){return n=ll({mode:"visible",children:n},i.mode),n.return=i,i.child=n}function ll(i,n){return i=ts(22,i,null,n),i.lanes=0,i}function rh(i,n,l){return gn(n,i.child,null,l),i=nh(n,n.pendingProps.children),i.flags|=2,n.memoizedState=null,i}function em(i,n,l){i.lanes|=n;var h=i.alternate;h!==null&&(h.lanes|=n),wu(i.return,n,l)}function ah(i,n,l,h,p,y){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:p,treeForkCount:y}:(A.isBackwards=n,A.rendering=null,A.renderingStartTime=0,A.last=h,A.tail=l,A.tailMode=p,A.treeForkCount=y)}function sm(i,n,l){var h=n.pendingProps,p=h.revealOrder,y=h.tail;h=h.children;var A=le.current,C=(A&2)!==0;if(C?(A=A&1|2,n.flags|=128):A&=1,J(le,A),Te(i,n,h,l),h=kt?oa:0,!C&&i!==null&&(i.flags&128)!==0)t:for(i=n.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&em(i,l,n);else if(i.tag===19)em(i,l,n);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break t;for(;i.sibling===null;){if(i.return===null||i.return===n)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(p){case"forwards":for(l=n.child,p=null;l!==null;)i=l.alternate,i!==null&&Wo(i)===null&&(p=l),l=l.sibling;l=p,l===null?(p=n.child,n.child=null):(p=l.sibling,l.sibling=null),ah(n,!1,p,l,y,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=n.child,n.child=null;p!==null;){if(i=p.alternate,i!==null&&Wo(i)===null){n.child=p;break}i=p.sibling,p.sibling=l,l=p,p=i}ah(n,!0,l,null,y,h);break;case"together":ah(n,!1,null,null,void 0,h);break;default:n.memoizedState=null}return n.child}function ei(i,n,l){if(i!==null&&(n.dependencies=i.dependencies),Di|=n.lanes,(l&n.childLanes)===0)if(i!==null){if(Qn(i,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(i!==null&&n.child!==i.child)throw Error(s(153));if(n.child!==null){for(i=n.child,l=Ks(i,i.pendingProps),n.child=l,l.return=n;i.sibling!==null;)i=i.sibling,l=l.sibling=Ks(i,i.pendingProps),l.return=n;l.sibling=null}return n.child}function oh(i,n){return(i.lanes&n)!==0?!0:(i=i.dependencies,!!(i!==null&&Ho(i)))}function y_(i,n,l){switch(n.tag){case 3:oe(n,n.stateNode.containerInfo),Si(n,he,i.memoizedState.cache),ln();break;case 27:case 5:Ji(n);break;case 4:oe(n,n.stateNode.containerInfo);break;case 10:Si(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Du(n),null;break;case 13:var h=n.memoizedState;if(h!==null)return h.dehydrated!==null?(Ri(n),n.flags|=128,null):(l&n.child.childLanes)!==0?tm(i,n,l):(Ri(n),i=ei(i,n,l),i!==null?i.sibling:null);Ri(n);break;case 19:var p=(i.flags&128)!==0;if(h=(l&n.childLanes)!==0,h||(Qn(i,n,l,!1),h=(l&n.childLanes)!==0),p){if(h)return sm(i,n,l);n.flags|=128}if(p=n.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),J(le,le.current),h)break;return null;case 22:return n.lanes=0,Xp(i,n,l,n.pendingProps);case 24:Si(n,he,i.memoizedState.cache)}return ei(i,n,l)}function im(i,n,l){if(i!==null)if(i.memoizedProps!==n.pendingProps)fe=!0;else{if(!oh(i,l)&&(n.flags&128)===0)return fe=!1,y_(i,n,l);fe=(i.flags&131072)!==0}else fe=!1,kt&&(n.flags&1048576)!==0&&Lg(n,oa,n.index);switch(n.lanes=0,n.tag){case 16:t:{var h=n.pendingProps;if(i=dn(n.elementType),n.type=i,typeof i=="function")du(i)?(h=mn(i,h),n.tag=1,n=Jp(null,n,i,h,l)):(n.tag=0,n=th(null,n,i,h,l));else{if(i!=null){var p=i.$$typeof;if(p===N){n.tag=11,n=Gp(null,n,i,h,l);break t}else if(p===L){n.tag=14,n=Vp(null,n,i,h,l);break t}}throw n=tt(i)||i,Error(s(306,n,""))}}return n;case 0:return th(i,n,n.type,n.pendingProps,l);case 1:return h=n.type,p=mn(h,n.pendingProps),Jp(i,n,h,p,l);case 3:t:{if(oe(n,n.stateNode.containerInfo),i===null)throw Error(s(387));h=n.pendingProps;var y=n.memoizedState;p=y.element,Cu(i,n),pa(n,h,null,l);var A=n.memoizedState;if(h=A.cache,Si(n,he,h),h!==y.cache&&_u(n,[he],l,!0),ga(),h=A.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:A.cache},n.updateQueue.baseState=y,n.memoizedState=y,n.flags&256){n=Zp(i,n,h,l);break t}else if(h!==p){p=gs(Error(s(424)),n),la(p),n=Zp(i,n,h,l);break t}else{switch(i=n.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Xt=vs(i.firstChild),Se=n,kt=!0,Ai=null,ys=!0,l=Xg(n,null,h,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ln(),h===p){n=ei(i,n,l);break t}Te(i,n,h,l)}n=n.child}return n;case 26:return ol(i,n),i===null?(l=gy(n.type,null,n.pendingProps,null))?n.memoizedState=l:kt||(l=n.type,i=n.pendingProps,h=Sl(vt.current).createElement(l),h[xe]=n,h[ze]=i,Ce(h,l,i),we(h),n.stateNode=h):n.memoizedState=gy(n.type,i.memoizedProps,n.pendingProps,i.memoizedState),null;case 27:return Ji(n),i===null&&kt&&(h=n.stateNode=hy(n.type,n.pendingProps,vt.current),Se=n,ys=!0,p=Xt,Bi(n.type)?(zh=p,Xt=vs(h.firstChild)):Xt=p),Te(i,n,n.pendingProps.children,l),ol(i,n),i===null&&(n.flags|=4194304),n.child;case 5:return i===null&&kt&&((p=h=Xt)&&(h=Y_(h,n.type,n.pendingProps,ys),h!==null?(n.stateNode=h,Se=n,Xt=vs(h.firstChild),ys=!1,p=!0):p=!1),p||xi(n)),Ji(n),p=n.type,y=n.pendingProps,A=i!==null?i.memoizedProps:null,h=y.children,Lh(p,y)?h=null:A!==null&&Lh(p,A)&&(n.flags|=32),n.memoizedState!==null&&(p=ju(i,n,l_,null,null,l),La._currentValue=p),ol(i,n),Te(i,n,h,l),n.child;case 6:return i===null&&kt&&((i=l=Xt)&&(l=X_(l,n.pendingProps,ys),l!==null?(n.stateNode=l,Se=n,Xt=null,i=!0):i=!1),i||xi(n)),null;case 13:return tm(i,n,l);case 4:return oe(n,n.stateNode.containerInfo),h=n.pendingProps,i===null?n.child=gn(n,null,h,l):Te(i,n,h,l),n.child;case 11:return Gp(i,n,n.type,n.pendingProps,l);case 7:return Te(i,n,n.pendingProps,l),n.child;case 8:return Te(i,n,n.pendingProps.children,l),n.child;case 12:return Te(i,n,n.pendingProps.children,l),n.child;case 10:return h=n.pendingProps,Si(n,n.type,h.value),Te(i,n,h.children,l),n.child;case 9:return p=n.type._context,h=n.pendingProps.children,un(n),p=Ee(p),h=h(p),n.flags|=1,Te(i,n,h,l),n.child;case 14:return Vp(i,n,n.type,n.pendingProps,l);case 15:return Yp(i,n,n.type,n.pendingProps,l);case 19:return sm(i,n,l);case 31:return m_(i,n,l);case 22:return Xp(i,n,l,n.pendingProps);case 24:return un(n),h=Ee(he),i===null?(p=Su(),p===null&&(p=qt,y=Au(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=l),p=y),n.memoizedState={parent:h,cache:p},Tu(n),Si(n,he,p)):((i.lanes&l)!==0&&(Cu(i,n),pa(n,null,null,l),ga()),p=i.memoizedState,y=n.memoizedState,p.parent!==h?(p={parent:h,cache:h},n.memoizedState=p,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=p),Si(n,he,h)):(h=y.cache,Si(n,he,h),h!==p.cache&&_u(n,[he],l,!0))),Te(i,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function si(i){i.flags|=4}function lh(i,n,l,h,p){if((n=(i.mode&32)!==0)&&(n=!1),n){if(i.flags|=16777216,(p&335544128)===p)if(i.stateNode.complete)i.flags|=8192;else if(Om())i.flags|=8192;else throw fn=Vo,Eu}else i.flags&=-16777217}function nm(i,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!vy(n))if(Om())i.flags|=8192;else throw fn=Vo,Eu}function cl(i,n){n!==null&&(i.flags|=4),i.flags&16384&&(n=i.tag!==22?Bf():536870912,i.lanes|=n,cr|=n)}function _a(i,n){if(!kt)switch(i.tailMode){case"hidden":n=i.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?n||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function Kt(i){var n=i.alternate!==null&&i.alternate.child===i.child,l=0,h=0;if(n)for(var p=i.child;p!==null;)l|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)l|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=l,n}function b_(i,n,l){var h=n.pendingProps;switch(mu(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(n),null;case 1:return Kt(n),null;case 3:return l=n.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),n.memoizedState.cache!==h&&(n.flags|=2048),Js(he),$t(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Wn(n)?si(n):i===null||i.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,bu())),Kt(n),null;case 26:var p=n.type,y=n.memoizedState;return i===null?(si(n),y!==null?(Kt(n),nm(n,y)):(Kt(n),lh(n,p,null,h,l))):y?y!==i.memoizedState?(si(n),Kt(n),nm(n,y)):(Kt(n),n.flags&=-16777217):(i=i.memoizedProps,i!==h&&si(n),Kt(n),lh(n,p,i,h,l)),null;case 27:if(yi(n),l=vt.current,p=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==h&&si(n);else{if(!h){if(n.stateNode===null)throw Error(s(166));return Kt(n),null}i=it.current,Wn(n)?Bg(n):(i=hy(p,h,l),n.stateNode=i,si(n))}return Kt(n),null;case 5:if(yi(n),p=n.type,i!==null&&n.stateNode!=null)i.memoizedProps!==h&&si(n);else{if(!h){if(n.stateNode===null)throw Error(s(166));return Kt(n),null}if(y=it.current,Wn(n))Bg(n);else{var A=Sl(vt.current);switch(y){case 1:y=A.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=A.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=A.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof h.is=="string"?A.createElement("select",{is:h.is}):A.createElement("select"),h.multiple?y.multiple=!0:h.size&&(y.size=h.size);break;default:y=typeof h.is=="string"?A.createElement(p,{is:h.is}):A.createElement(p)}}y[xe]=n,y[ze]=h;t:for(A=n.child;A!==null;){if(A.tag===5||A.tag===6)y.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===n)break t;for(;A.sibling===null;){if(A.return===null||A.return===n)break t;A=A.return}A.sibling.return=A.return,A=A.sibling}n.stateNode=y;t:switch(Ce(y,p,h),p){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&si(n)}}return Kt(n),lh(n,n.type,i===null?null:i.memoizedProps,n.pendingProps,l),null;case 6:if(i&&n.stateNode!=null)i.memoizedProps!==h&&si(n);else{if(typeof h!="string"&&n.stateNode===null)throw Error(s(166));if(i=vt.current,Wn(n)){if(i=n.stateNode,l=n.memoizedProps,h=null,p=Se,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}i[xe]=n,i=!!(i.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||ty(i.nodeValue,l)),i||xi(n,!0)}else i=Sl(i).createTextNode(h),i[xe]=n,n.stateNode=i}return Kt(n),null;case 31:if(l=n.memoizedState,i===null||i.memoizedState!==null){if(h=Wn(n),l!==null){if(i===null){if(!h)throw Error(s(318));if(i=n.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[xe]=n}else ln(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Kt(n),i=!1}else l=bu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return n.flags&256?(ss(n),n):(ss(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Kt(n),null;case 13:if(h=n.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Wn(n),h!==null&&h.dehydrated!==null){if(i===null){if(!p)throw Error(s(318));if(p=n.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[xe]=n}else ln(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Kt(n),p=!1}else p=bu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return n.flags&256?(ss(n),n):(ss(n),null)}return ss(n),(n.flags&128)!==0?(n.lanes=l,n):(l=h!==null,i=i!==null&&i.memoizedState!==null,l&&(h=n.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool),y=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==p&&(h.flags|=2048)),l!==i&&l&&(n.child.flags|=8192),cl(n,n.updateQueue),Kt(n),null);case 4:return $t(),i===null&&Oh(n.stateNode.containerInfo),Kt(n),null;case 10:return Js(n.type),Kt(n),null;case 19:if(V(le),h=n.memoizedState,h===null)return Kt(n),null;if(p=(n.flags&128)!==0,y=h.rendering,y===null)if(p)_a(h,!1);else{if(re!==0||i!==null&&(i.flags&128)!==0)for(i=n.child;i!==null;){if(y=Wo(i),y!==null){for(n.flags|=128,_a(h,!1),i=y.updateQueue,n.updateQueue=i,cl(n,i),n.subtreeFlags=0,i=l,l=n.child;l!==null;)Dg(l,i),l=l.sibling;return J(le,le.current&1|2),kt&&Ws(n,h.treeForkCount),n.child}i=i.sibling}h.tail!==null&&We()>gl&&(n.flags|=128,p=!0,_a(h,!1),n.lanes=4194304)}else{if(!p)if(i=Wo(y),i!==null){if(n.flags|=128,p=!0,i=i.updateQueue,n.updateQueue=i,cl(n,i),_a(h,!0),h.tail===null&&h.tailMode==="hidden"&&!y.alternate&&!kt)return Kt(n),null}else 2*We()-h.renderingStartTime>gl&&l!==536870912&&(n.flags|=128,p=!0,_a(h,!1),n.lanes=4194304);h.isBackwards?(y.sibling=n.child,n.child=y):(i=h.last,i!==null?i.sibling=y:n.child=y,h.last=y)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=We(),i.sibling=null,l=le.current,J(le,p?l&1|2:l&1),kt&&Ws(n,h.treeForkCount),i):(Kt(n),null);case 22:case 23:return ss(n),ku(),h=n.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(n.flags|=8192):h&&(n.flags|=8192),h?(l&536870912)!==0&&(n.flags&128)===0&&(Kt(n),n.subtreeFlags&6&&(n.flags|=8192)):Kt(n),l=n.updateQueue,l!==null&&cl(n,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),h=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(h=n.memoizedState.cachePool.pool),h!==l&&(n.flags|=2048),i!==null&&V(hn),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),Js(he),Kt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function v_(i,n){switch(mu(n),n.tag){case 1:return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 3:return Js(he),$t(),i=n.flags,(i&65536)!==0&&(i&128)===0?(n.flags=i&-65537|128,n):null;case 26:case 27:case 5:return yi(n),null;case 31:if(n.memoizedState!==null){if(ss(n),n.alternate===null)throw Error(s(340));ln()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 13:if(ss(n),i=n.memoizedState,i!==null&&i.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ln()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 19:return V(le),null;case 4:return $t(),null;case 10:return Js(n.type),null;case 22:case 23:return ss(n),ku(),i!==null&&V(hn),i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 24:return Js(he),null;case 25:return null;default:return null}}function rm(i,n){switch(mu(n),n.tag){case 3:Js(he),$t();break;case 26:case 27:case 5:yi(n);break;case 4:$t();break;case 31:n.memoizedState!==null&&ss(n);break;case 13:ss(n);break;case 19:V(le);break;case 10:Js(n.type);break;case 22:case 23:ss(n),ku(),i!==null&&V(hn);break;case 24:Js(he)}}function Aa(i,n){try{var l=n.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var p=h.next;l=p;do{if((l.tag&i)===i){h=void 0;var y=l.create,A=l.inst;h=y(),A.destroy=h}l=l.next}while(l!==p)}}catch(C){Ut(n,n.return,C)}}function Oi(i,n,l){try{var h=n.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&i)===i){var A=h.inst,C=A.destroy;if(C!==void 0){A.destroy=void 0,p=n;var O=l,z=C;try{z()}catch(Y){Ut(p,O,Y)}}}h=h.next}while(h!==y)}}catch(Y){Ut(n,n.return,Y)}}function am(i){var n=i.updateQueue;if(n!==null){var l=i.stateNode;try{Wg(n,l)}catch(h){Ut(i,i.return,h)}}}function om(i,n,l){l.props=mn(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(h){Ut(i,n,h)}}function xa(i,n){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof l=="function"?i.refCleanup=l(h):l.current=h}}catch(p){Ut(i,n,p)}}function Ls(i,n){var l=i.ref,h=i.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(p){Ut(i,n,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){Ut(i,n,p)}else l.current=null}function lm(i){var n=i.type,l=i.memoizedProps,h=i.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break t;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(p){Ut(i,i.return,p)}}function ch(i,n,l){try{var h=i.stateNode;F_(h,i.type,l,n),h[ze]=n}catch(p){Ut(i,i.return,p)}}function cm(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Bi(i.type)||i.tag===4}function uh(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||cm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Bi(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function hh(i,n,l){var h=i.tag;if(h===5||h===6)i=i.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(i),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=Ys));else if(h!==4&&(h===27&&Bi(i.type)&&(l=i.stateNode,n=null),i=i.child,i!==null))for(hh(i,n,l),i=i.sibling;i!==null;)hh(i,n,l),i=i.sibling}function ul(i,n,l){var h=i.tag;if(h===5||h===6)i=i.stateNode,n?l.insertBefore(i,n):l.appendChild(i);else if(h!==4&&(h===27&&Bi(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(ul(i,n,l),i=i.sibling;i!==null;)ul(i,n,l),i=i.sibling}function um(i){var n=i.stateNode,l=i.memoizedProps;try{for(var h=i.type,p=n.attributes;p.length;)n.removeAttributeNode(p[0]);Ce(n,h,l),n[xe]=i,n[ze]=l}catch(y){Ut(i,i.return,y)}}var ii=!1,ge=!1,dh=!1,hm=typeof WeakSet=="function"?WeakSet:Set,_e=null;function w_(i,n){if(i=i.containerInfo,Mh=kl,i=xg(i),ru(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else t:{l=(l=i.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break t}var A=0,C=-1,O=-1,z=0,Y=0,W=i,H=null;e:for(;;){for(var q;W!==l||p!==0&&W.nodeType!==3||(C=A+p),W!==y||h!==0&&W.nodeType!==3||(O=A+h),W.nodeType===3&&(A+=W.nodeValue.length),(q=W.firstChild)!==null;)H=W,W=q;for(;;){if(W===i)break e;if(H===l&&++z===p&&(C=A),H===y&&++Y===h&&(O=A),(q=W.nextSibling)!==null)break;W=H,H=W.parentNode}W=q}l=C===-1||O===-1?null:{start:C,end:O}}else l=null}l=l||{start:0,end:0}}else l=null;for(jh={focusedElem:i,selectionRange:l},kl=!1,_e=n;_e!==null;)if(n=_e,i=n.child,(n.subtreeFlags&1028)!==0&&i!==null)i.return=n,_e=i;else for(;_e!==null;){switch(n=_e,y=n.alternate,i=n.flags,n.tag){case 0:if((i&4)!==0&&(i=n.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)p=i[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,l=n,p=y.memoizedProps,y=y.memoizedState,h=l.stateNode;try{var rt=mn(l.type,p);i=h.getSnapshotBeforeUpdate(rt,y),h.__reactInternalSnapshotBeforeUpdate=i}catch(pt){Ut(l,l.return,pt)}}break;case 3:if((i&1024)!==0){if(i=n.stateNode.containerInfo,l=i.nodeType,l===9)Bh(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Bh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=n.sibling,i!==null){i.return=n.return,_e=i;break}_e=n.return}}function dm(i,n,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:ri(i,l),h&4&&Aa(5,l);break;case 1:if(ri(i,l),h&4)if(i=l.stateNode,n===null)try{i.componentDidMount()}catch(A){Ut(l,l.return,A)}else{var p=mn(l.type,n.memoizedProps);n=n.memoizedState;try{i.componentDidUpdate(p,n,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Ut(l,l.return,A)}}h&64&&am(l),h&512&&xa(l,l.return);break;case 3:if(ri(i,l),h&64&&(i=l.updateQueue,i!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Wg(i,n)}catch(A){Ut(l,l.return,A)}}break;case 27:n===null&&h&4&&um(l);case 26:case 5:ri(i,l),n===null&&h&4&&lm(l),h&512&&xa(l,l.return);break;case 12:ri(i,l);break;case 31:ri(i,l),h&4&&pm(i,l);break;case 13:ri(i,l),h&4&&mm(i,l),h&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=N_.bind(null,l),K_(i,l))));break;case 22:if(h=l.memoizedState!==null||ii,!h){n=n!==null&&n.memoizedState!==null||ge,p=ii;var y=ge;ii=h,(ge=n)&&!y?ai(i,l,(l.subtreeFlags&8772)!==0):ri(i,l),ii=p,ge=y}break;case 30:break;default:ri(i,l)}}function fm(i){var n=i.alternate;n!==null&&(i.alternate=null,fm(n)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(n=i.stateNode,n!==null&&Hc(n)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Qt=null,He=!1;function ni(i,n,l){for(l=l.child;l!==null;)gm(i,n,l),l=l.sibling}function gm(i,n,l){if(Qe&&typeof Qe.onCommitFiberUnmount=="function")try{Qe.onCommitFiberUnmount(Yr,l)}catch{}switch(l.tag){case 26:ge||Ls(l,n),ni(i,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ge||Ls(l,n);var h=Qt,p=He;Bi(l.type)&&(Qt=l.stateNode,He=!1),ni(i,n,l),Da(l.stateNode),Qt=h,He=p;break;case 5:ge||Ls(l,n);case 6:if(h=Qt,p=He,Qt=null,ni(i,n,l),Qt=h,He=p,Qt!==null)if(He)try{(Qt.nodeType===9?Qt.body:Qt.nodeName==="HTML"?Qt.ownerDocument.body:Qt).removeChild(l.stateNode)}catch(y){Ut(l,n,y)}else try{Qt.removeChild(l.stateNode)}catch(y){Ut(l,n,y)}break;case 18:Qt!==null&&(He?(i=Qt,ay(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),yr(i)):ay(Qt,l.stateNode));break;case 4:h=Qt,p=He,Qt=l.stateNode.containerInfo,He=!0,ni(i,n,l),Qt=h,He=p;break;case 0:case 11:case 14:case 15:Oi(2,l,n),ge||Oi(4,l,n),ni(i,n,l);break;case 1:ge||(Ls(l,n),h=l.stateNode,typeof h.componentWillUnmount=="function"&&om(l,n,h)),ni(i,n,l);break;case 21:ni(i,n,l);break;case 22:ge=(h=ge)||l.memoizedState!==null,ni(i,n,l),ge=h;break;default:ni(i,n,l)}}function pm(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{yr(i)}catch(l){Ut(n,n.return,l)}}}function mm(i,n){if(n.memoizedState===null&&(i=n.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{yr(i)}catch(l){Ut(n,n.return,l)}}function __(i){switch(i.tag){case 31:case 13:case 19:var n=i.stateNode;return n===null&&(n=i.stateNode=new hm),n;case 22:return i=i.stateNode,n=i._retryCache,n===null&&(n=i._retryCache=new hm),n;default:throw Error(s(435,i.tag))}}function hl(i,n){var l=__(i);n.forEach(function(h){if(!l.has(h)){l.add(h);var p=O_.bind(null,i,h);h.then(p,p)}})}function $e(i,n){var l=n.deletions;if(l!==null)for(var h=0;h<l.length;h++){var p=l[h],y=i,A=n,C=A;t:for(;C!==null;){switch(C.tag){case 27:if(Bi(C.type)){Qt=C.stateNode,He=!1;break t}break;case 5:Qt=C.stateNode,He=!1;break t;case 3:case 4:Qt=C.stateNode.containerInfo,He=!0;break t}C=C.return}if(Qt===null)throw Error(s(160));gm(y,A,p),Qt=null,He=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)ym(n,i),n=n.sibling}var Ts=null;function ym(i,n){var l=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:$e(n,i),qe(i),h&4&&(Oi(3,i,i.return),Aa(3,i),Oi(5,i,i.return));break;case 1:$e(n,i),qe(i),h&512&&(ge||l===null||Ls(l,l.return)),h&64&&ii&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var p=Ts;if($e(n,i),qe(i),h&512&&(ge||l===null||Ls(l,l.return)),h&4){var y=l!==null?l.memoizedState:null;if(h=i.memoizedState,l===null)if(h===null)if(i.stateNode===null){t:{h=i.type,l=i.memoizedProps,p=p.ownerDocument||p;e:switch(h){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Wr]||y[xe]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(h),p.head.insertBefore(y,p.querySelector("head > title"))),Ce(y,h,l),y[xe]=i,we(y),h=y;break t;case"link":var A=yy("link","href",p).get(h+(l.href||""));if(A){for(var C=0;C<A.length;C++)if(y=A[C],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){A.splice(C,1);break e}}y=p.createElement(h),Ce(y,h,l),p.head.appendChild(y);break;case"meta":if(A=yy("meta","content",p).get(h+(l.content||""))){for(C=0;C<A.length;C++)if(y=A[C],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){A.splice(C,1);break e}}y=p.createElement(h),Ce(y,h,l),p.head.appendChild(y);break;default:throw Error(s(468,h))}y[xe]=i,we(y),h=y}i.stateNode=h}else by(p,i.type,i.stateNode);else i.stateNode=my(p,h,i.memoizedProps);else y!==h?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,h===null?by(p,i.type,i.stateNode):my(p,h,i.memoizedProps)):h===null&&i.stateNode!==null&&ch(i,i.memoizedProps,l.memoizedProps)}break;case 27:$e(n,i),qe(i),h&512&&(ge||l===null||Ls(l,l.return)),l!==null&&h&4&&ch(i,i.memoizedProps,l.memoizedProps);break;case 5:if($e(n,i),qe(i),h&512&&(ge||l===null||Ls(l,l.return)),i.flags&32){p=i.stateNode;try{zn(p,"")}catch(rt){Ut(i,i.return,rt)}}h&4&&i.stateNode!=null&&(p=i.memoizedProps,ch(i,p,l!==null?l.memoizedProps:p)),h&1024&&(dh=!0);break;case 6:if($e(n,i),qe(i),h&4){if(i.stateNode===null)throw Error(s(162));h=i.memoizedProps,l=i.stateNode;try{l.nodeValue=h}catch(rt){Ut(i,i.return,rt)}}break;case 3:if(Cl=null,p=Ts,Ts=El(n.containerInfo),$e(n,i),Ts=p,qe(i),h&4&&l!==null&&l.memoizedState.isDehydrated)try{yr(n.containerInfo)}catch(rt){Ut(i,i.return,rt)}dh&&(dh=!1,bm(i));break;case 4:h=Ts,Ts=El(i.stateNode.containerInfo),$e(n,i),qe(i),Ts=h;break;case 12:$e(n,i),qe(i);break;case 31:$e(n,i),qe(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,hl(i,h)));break;case 13:$e(n,i),qe(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(fl=We()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,hl(i,h)));break;case 22:p=i.memoizedState!==null;var O=l!==null&&l.memoizedState!==null,z=ii,Y=ge;if(ii=z||p,ge=Y||O,$e(n,i),ge=Y,ii=z,qe(i),h&8192)t:for(n=i.stateNode,n._visibility=p?n._visibility&-2:n._visibility|1,p&&(l===null||O||ii||ge||yn(i)),l=null,n=i;;){if(n.tag===5||n.tag===26){if(l===null){O=l=n;try{if(y=O.stateNode,p)A=y.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{C=O.stateNode;var W=O.memoizedProps.style,H=W!=null&&W.hasOwnProperty("display")?W.display:null;C.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(rt){Ut(O,O.return,rt)}}}else if(n.tag===6){if(l===null){O=n;try{O.stateNode.nodeValue=p?"":O.memoizedProps}catch(rt){Ut(O,O.return,rt)}}}else if(n.tag===18){if(l===null){O=n;try{var q=O.stateNode;p?oy(q,!0):oy(O.stateNode,!1)}catch(rt){Ut(O,O.return,rt)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===i)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break t;for(;n.sibling===null;){if(n.return===null||n.return===i)break t;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}h&4&&(h=i.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,hl(i,l))));break;case 19:$e(n,i),qe(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,hl(i,h)));break;case 30:break;case 21:break;default:$e(n,i),qe(i)}}function qe(i){var n=i.flags;if(n&2){try{for(var l,h=i.return;h!==null;){if(cm(h)){l=h;break}h=h.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var p=l.stateNode,y=uh(i);ul(i,y,p);break;case 5:var A=l.stateNode;l.flags&32&&(zn(A,""),l.flags&=-33);var C=uh(i);ul(i,C,A);break;case 3:case 4:var O=l.stateNode.containerInfo,z=uh(i);hh(i,z,O);break;default:throw Error(s(161))}}catch(Y){Ut(i,i.return,Y)}i.flags&=-3}n&4096&&(i.flags&=-4097)}function bm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var n=i;bm(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),i=i.sibling}}function ri(i,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)dm(i,n.alternate,n),n=n.sibling}function yn(i){for(i=i.child;i!==null;){var n=i;switch(n.tag){case 0:case 11:case 14:case 15:Oi(4,n,n.return),yn(n);break;case 1:Ls(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&om(n,n.return,l),yn(n);break;case 27:Da(n.stateNode);case 26:case 5:Ls(n,n.return),yn(n);break;case 22:n.memoizedState===null&&yn(n);break;case 30:yn(n);break;default:yn(n)}i=i.sibling}}function ai(i,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var h=n.alternate,p=i,y=n,A=y.flags;switch(y.tag){case 0:case 11:case 15:ai(p,y,l),Aa(4,y);break;case 1:if(ai(p,y,l),h=y,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(z){Ut(h,h.return,z)}if(h=y,p=h.updateQueue,p!==null){var C=h.stateNode;try{var O=p.shared.hiddenCallbacks;if(O!==null)for(p.shared.hiddenCallbacks=null,p=0;p<O.length;p++)Kg(O[p],C)}catch(z){Ut(h,h.return,z)}}l&&A&64&&am(y),xa(y,y.return);break;case 27:um(y);case 26:case 5:ai(p,y,l),l&&h===null&&A&4&&lm(y),xa(y,y.return);break;case 12:ai(p,y,l);break;case 31:ai(p,y,l),l&&A&4&&pm(p,y);break;case 13:ai(p,y,l),l&&A&4&&mm(p,y);break;case 22:y.memoizedState===null&&ai(p,y,l),xa(y,y.return);break;case 30:break;default:ai(p,y,l)}n=n.sibling}}function fh(i,n){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&ca(l))}function gh(i,n){i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&ca(i))}function Cs(i,n,l,h){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)vm(i,n,l,h),n=n.sibling}function vm(i,n,l,h){var p=n.flags;switch(n.tag){case 0:case 11:case 15:Cs(i,n,l,h),p&2048&&Aa(9,n);break;case 1:Cs(i,n,l,h);break;case 3:Cs(i,n,l,h),p&2048&&(i=null,n.alternate!==null&&(i=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==i&&(n.refCount++,i!=null&&ca(i)));break;case 12:if(p&2048){Cs(i,n,l,h),i=n.stateNode;try{var y=n.memoizedProps,A=y.id,C=y.onPostCommit;typeof C=="function"&&C(A,n.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(O){Ut(n,n.return,O)}}else Cs(i,n,l,h);break;case 31:Cs(i,n,l,h);break;case 13:Cs(i,n,l,h);break;case 23:break;case 22:y=n.stateNode,A=n.alternate,n.memoizedState!==null?y._visibility&2?Cs(i,n,l,h):Sa(i,n):y._visibility&2?Cs(i,n,l,h):(y._visibility|=2,ar(i,n,l,h,(n.subtreeFlags&10256)!==0||!1)),p&2048&&fh(A,n);break;case 24:Cs(i,n,l,h),p&2048&&gh(n.alternate,n);break;default:Cs(i,n,l,h)}}function ar(i,n,l,h,p){for(p=p&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var y=i,A=n,C=l,O=h,z=A.flags;switch(A.tag){case 0:case 11:case 15:ar(y,A,C,O,p),Aa(8,A);break;case 23:break;case 22:var Y=A.stateNode;A.memoizedState!==null?Y._visibility&2?ar(y,A,C,O,p):Sa(y,A):(Y._visibility|=2,ar(y,A,C,O,p)),p&&z&2048&&fh(A.alternate,A);break;case 24:ar(y,A,C,O,p),p&&z&2048&&gh(A.alternate,A);break;default:ar(y,A,C,O,p)}n=n.sibling}}function Sa(i,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=i,h=n,p=h.flags;switch(h.tag){case 22:Sa(l,h),p&2048&&fh(h.alternate,h);break;case 24:Sa(l,h),p&2048&&gh(h.alternate,h);break;default:Sa(l,h)}n=n.sibling}}var Ea=8192;function or(i,n,l){if(i.subtreeFlags&Ea)for(i=i.child;i!==null;)wm(i,n,l),i=i.sibling}function wm(i,n,l){switch(i.tag){case 26:or(i,n,l),i.flags&Ea&&i.memoizedState!==null&&oA(l,Ts,i.memoizedState,i.memoizedProps);break;case 5:or(i,n,l);break;case 3:case 4:var h=Ts;Ts=El(i.stateNode.containerInfo),or(i,n,l),Ts=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=Ea,Ea=16777216,or(i,n,l),Ea=h):or(i,n,l));break;default:or(i,n,l)}}function _m(i){var n=i.alternate;if(n!==null&&(i=n.child,i!==null)){n.child=null;do n=i.sibling,i.sibling=null,i=n;while(i!==null)}}function Ta(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var h=n[l];_e=h,xm(h,i)}_m(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Am(i),i=i.sibling}function Am(i){switch(i.tag){case 0:case 11:case 15:Ta(i),i.flags&2048&&Oi(9,i,i.return);break;case 3:Ta(i);break;case 12:Ta(i);break;case 22:var n=i.stateNode;i.memoizedState!==null&&n._visibility&2&&(i.return===null||i.return.tag!==13)?(n._visibility&=-3,dl(i)):Ta(i);break;default:Ta(i)}}function dl(i){var n=i.deletions;if((i.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var h=n[l];_e=h,xm(h,i)}_m(i)}for(i=i.child;i!==null;){switch(n=i,n.tag){case 0:case 11:case 15:Oi(8,n,n.return),dl(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,dl(n));break;default:dl(n)}i=i.sibling}}function xm(i,n){for(;_e!==null;){var l=_e;switch(l.tag){case 0:case 11:case 15:Oi(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:ca(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,_e=h;else t:for(l=i;_e!==null;){h=_e;var p=h.sibling,y=h.return;if(fm(h),h===l){_e=null;break t}if(p!==null){p.return=y,_e=p;break t}_e=y}}}var A_={getCacheForType:function(i){var n=Ee(he),l=n.data.get(i);return l===void 0&&(l=i(),n.data.set(i,l)),l},cacheSignal:function(){return Ee(he).controller.signal}},x_=typeof WeakMap=="function"?WeakMap:Map,Pt=0,qt=null,Ct=null,Nt=0,Bt=0,is=null,ki=!1,lr=!1,ph=!1,oi=0,re=0,Di=0,bn=0,mh=0,ns=0,cr=0,Ca=null,Ge=null,yh=!1,fl=0,Sm=0,gl=1/0,pl=null,Mi=null,be=0,ji=null,ur=null,li=0,bh=0,vh=null,Em=null,Ra=0,wh=null;function rs(){return(Pt&2)!==0&&Nt!==0?Nt&-Nt:B.T!==null?Th():Ff()}function Tm(){if(ns===0)if((Nt&536870912)===0||kt){var i=xo;xo<<=1,(xo&3932160)===0&&(xo=262144),ns=i}else ns=536870912;return i=es.current,i!==null&&(i.flags|=32),ns}function Ve(i,n,l){(i===qt&&(Bt===2||Bt===9)||i.cancelPendingCommit!==null)&&(hr(i,0),Li(i,Nt,ns,!1)),Kr(i,l),((Pt&2)===0||i!==qt)&&(i===qt&&((Pt&2)===0&&(bn|=l),re===4&&Li(i,Nt,ns,!1)),Ps(i))}function Cm(i,n,l){if((Pt&6)!==0)throw Error(s(327));var h=!l&&(n&127)===0&&(n&i.expiredLanes)===0||Xr(i,n),p=h?T_(i,n):Ah(i,n,!0),y=h;do{if(p===0){lr&&!h&&Li(i,n,0,!1);break}else{if(l=i.current.alternate,y&&!S_(l)){p=Ah(i,n,!1),y=!1;continue}if(p===2){if(y=n,i.errorRecoveryDisabledLanes&y)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){n=A;t:{var C=i;p=Ca;var O=C.current.memoizedState.isDehydrated;if(O&&(hr(C,A).flags|=256),A=Ah(C,A,!1),A!==2){if(ph&&!O){C.errorRecoveryDisabledLanes|=y,bn|=y,p=4;break t}y=Ge,Ge=p,y!==null&&(Ge===null?Ge=y:Ge.push.apply(Ge,y))}p=A}if(y=!1,p!==2)continue}}if(p===1){hr(i,0),Li(i,n,0,!0);break}t:{switch(h=i,y=p,y){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Li(h,n,ns,!ki);break t;case 2:Ge=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(p=fl+300-We(),10<p)){if(Li(h,n,ns,!ki),Eo(h,0,!0)!==0)break t;li=n,h.timeoutHandle=ny(Rm.bind(null,h,l,Ge,pl,yh,n,ns,bn,cr,ki,y,"Throttled",-0,0),p);break t}Rm(h,l,Ge,pl,yh,n,ns,bn,cr,ki,y,null,-0,0)}}break}while(!0);Ps(i)}function Rm(i,n,l,h,p,y,A,C,O,z,Y,W,H,q){if(i.timeoutHandle=-1,W=n.subtreeFlags,W&8192||(W&16785408)===16785408){W={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ys},wm(n,y,W);var rt=(y&62914560)===y?fl-We():(y&4194048)===y?Sm-We():0;if(rt=lA(W,rt),rt!==null){li=y,i.cancelPendingCommit=rt(Pm.bind(null,i,n,y,l,h,p,A,C,O,Y,W,null,H,q)),Li(i,y,A,!z);return}}Pm(i,n,y,l,h,p,A,C,O)}function S_(i){for(var n=i;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var p=l[h],y=p.getSnapshot;p=p.value;try{if(!Ze(y(),p))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Li(i,n,l,h){n&=~mh,n&=~bn,i.suspendedLanes|=n,i.pingedLanes&=~n,h&&(i.warmLanes|=n),h=i.expirationTimes;for(var p=n;0<p;){var y=31-Je(p),A=1<<y;h[y]=-1,p&=~A}l!==0&&Uf(i,l,n)}function ml(){return(Pt&6)===0?(Na(0),!1):!0}function _h(){if(Ct!==null){if(Bt===0)var i=Ct.return;else i=Ct,Qs=cn=null,Bu(i),er=null,ha=0,i=Ct;for(;i!==null;)rm(i.alternate,i),i=i.return;Ct=null}}function hr(i,n){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,q_(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),li=0,_h(),qt=i,Ct=l=Ks(i.current,null),Nt=n,Bt=0,is=null,ki=!1,lr=Xr(i,n),ph=!1,cr=ns=mh=bn=Di=re=0,Ge=Ca=null,yh=!1,(n&8)!==0&&(n|=n&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=n;0<h;){var p=31-Je(h),y=1<<p;n|=i[p],h&=~y}return oi=n,Bo(),l}function Nm(i,n){xt=null,B.H=va,n===tr||n===Go?(n=Gg(),Bt=3):n===Eu?(n=Gg(),Bt=4):Bt=n===Zu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,is=n,Ct===null&&(re=1,rl(i,gs(n,i.current)))}function Om(){var i=es.current;return i===null?!0:(Nt&4194048)===Nt?bs===null:(Nt&62914560)===Nt||(Nt&536870912)!==0?i===bs:!1}function km(){var i=B.H;return B.H=va,i===null?va:i}function Dm(){var i=B.A;return B.A=A_,i}function yl(){re=4,ki||(Nt&4194048)!==Nt&&es.current!==null||(lr=!0),(Di&134217727)===0&&(bn&134217727)===0||qt===null||Li(qt,Nt,ns,!1)}function Ah(i,n,l){var h=Pt;Pt|=2;var p=km(),y=Dm();(qt!==i||Nt!==n)&&(pl=null,hr(i,n)),n=!1;var A=re;t:do try{if(Bt!==0&&Ct!==null){var C=Ct,O=is;switch(Bt){case 8:_h(),A=6;break t;case 3:case 2:case 9:case 6:es.current===null&&(n=!0);var z=Bt;if(Bt=0,is=null,dr(i,C,O,z),l&&lr){A=0;break t}break;default:z=Bt,Bt=0,is=null,dr(i,C,O,z)}}E_(),A=re;break}catch(Y){Nm(i,Y)}while(!0);return n&&i.shellSuspendCounter++,Qs=cn=null,Pt=h,B.H=p,B.A=y,Ct===null&&(qt=null,Nt=0,Bo()),A}function E_(){for(;Ct!==null;)Mm(Ct)}function T_(i,n){var l=Pt;Pt|=2;var h=km(),p=Dm();qt!==i||Nt!==n?(pl=null,gl=We()+500,hr(i,n)):lr=Xr(i,n);t:do try{if(Bt!==0&&Ct!==null){n=Ct;var y=is;e:switch(Bt){case 1:Bt=0,is=null,dr(i,n,y,1);break;case 2:case 9:if($g(y)){Bt=0,is=null,jm(n);break}n=function(){Bt!==2&&Bt!==9||qt!==i||(Bt=7),Ps(i)},y.then(n,n);break t;case 3:Bt=7;break t;case 4:Bt=5;break t;case 7:$g(y)?(Bt=0,is=null,jm(n)):(Bt=0,is=null,dr(i,n,y,7));break;case 5:var A=null;switch(Ct.tag){case 26:A=Ct.memoizedState;case 5:case 27:var C=Ct;if(A?vy(A):C.stateNode.complete){Bt=0,is=null;var O=C.sibling;if(O!==null)Ct=O;else{var z=C.return;z!==null?(Ct=z,bl(z)):Ct=null}break e}}Bt=0,is=null,dr(i,n,y,5);break;case 6:Bt=0,is=null,dr(i,n,y,6);break;case 8:_h(),re=6;break t;default:throw Error(s(462))}}C_();break}catch(Y){Nm(i,Y)}while(!0);return Qs=cn=null,B.H=h,B.A=p,Pt=l,Ct!==null?0:(qt=null,Nt=0,Bo(),re)}function C_(){for(;Ct!==null&&!Wv();)Mm(Ct)}function Mm(i){var n=im(i.alternate,i,oi);i.memoizedProps=i.pendingProps,n===null?bl(i):Ct=n}function jm(i){var n=i,l=n.alternate;switch(n.tag){case 15:case 0:n=Qp(l,n,n.pendingProps,n.type,void 0,Nt);break;case 11:n=Qp(l,n,n.pendingProps,n.type.render,n.ref,Nt);break;case 5:Bu(n);default:rm(l,n),n=Ct=Dg(n,oi),n=im(l,n,oi)}i.memoizedProps=i.pendingProps,n===null?bl(i):Ct=n}function dr(i,n,l,h){Qs=cn=null,Bu(n),er=null,ha=0;var p=n.return;try{if(p_(i,p,n,l,Nt)){re=1,rl(i,gs(l,i.current)),Ct=null;return}}catch(y){if(p!==null)throw Ct=p,y;re=1,rl(i,gs(l,i.current)),Ct=null;return}n.flags&32768?(kt||h===1?i=!0:lr||(Nt&536870912)!==0?i=!1:(ki=i=!0,(h===2||h===9||h===3||h===6)&&(h=es.current,h!==null&&h.tag===13&&(h.flags|=16384))),Lm(n,i)):bl(n)}function bl(i){var n=i;do{if((n.flags&32768)!==0){Lm(n,ki);return}i=n.return;var l=b_(n.alternate,n,oi);if(l!==null){Ct=l;return}if(n=n.sibling,n!==null){Ct=n;return}Ct=n=i}while(n!==null);re===0&&(re=5)}function Lm(i,n){do{var l=v_(i.alternate,i);if(l!==null){l.flags&=32767,Ct=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(i=i.sibling,i!==null)){Ct=i;return}Ct=i=l}while(i!==null);re=6,Ct=null}function Pm(i,n,l,h,p,y,A,C,O){i.cancelPendingCommit=null;do vl();while(be!==0);if((Pt&6)!==0)throw Error(s(327));if(n!==null){if(n===i.current)throw Error(s(177));if(y=n.lanes|n.childLanes,y|=uu,aw(i,l,y,A,C,O),i===qt&&(Ct=qt=null,Nt=0),ur=n,ji=i,li=l,bh=y,vh=p,Em=h,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,k_(_o,function(){return Fm(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||h){h=B.T,B.T=null,p=$.p,$.p=2,A=Pt,Pt|=4;try{w_(i,n,l)}finally{Pt=A,$.p=p,B.T=h}}be=1,Bm(),Um(),Im()}}function Bm(){if(be===1){be=0;var i=ji,n=ur,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=B.T,B.T=null;var h=$.p;$.p=2;var p=Pt;Pt|=4;try{ym(n,i);var y=jh,A=xg(i.containerInfo),C=y.focusedElem,O=y.selectionRange;if(A!==C&&C&&C.ownerDocument&&Ag(C.ownerDocument.documentElement,C)){if(O!==null&&ru(C)){var z=O.start,Y=O.end;if(Y===void 0&&(Y=z),"selectionStart"in C)C.selectionStart=z,C.selectionEnd=Math.min(Y,C.value.length);else{var W=C.ownerDocument||document,H=W&&W.defaultView||window;if(H.getSelection){var q=H.getSelection(),rt=C.textContent.length,pt=Math.min(O.start,rt),Ft=O.end===void 0?pt:Math.min(O.end,rt);!q.extend&&pt>Ft&&(A=Ft,Ft=pt,pt=A);var U=_g(C,pt),j=_g(C,Ft);if(U&&j&&(q.rangeCount!==1||q.anchorNode!==U.node||q.anchorOffset!==U.offset||q.focusNode!==j.node||q.focusOffset!==j.offset)){var I=W.createRange();I.setStart(U.node,U.offset),q.removeAllRanges(),pt>Ft?(q.addRange(I),q.extend(j.node,j.offset)):(I.setEnd(j.node,j.offset),q.addRange(I))}}}}for(W=[],q=C;q=q.parentNode;)q.nodeType===1&&W.push({element:q,left:q.scrollLeft,top:q.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<W.length;C++){var K=W[C];K.element.scrollLeft=K.left,K.element.scrollTop=K.top}}kl=!!Mh,jh=Mh=null}finally{Pt=p,$.p=h,B.T=l}}i.current=n,be=2}}function Um(){if(be===2){be=0;var i=ji,n=ur,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=B.T,B.T=null;var h=$.p;$.p=2;var p=Pt;Pt|=4;try{dm(i,n.alternate,n)}finally{Pt=p,$.p=h,B.T=l}}be=3}}function Im(){if(be===4||be===3){be=0,Qv();var i=ji,n=ur,l=li,h=Em;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?be=5:(be=0,ur=ji=null,zm(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(Mi=null),zc(l),n=n.stateNode,Qe&&typeof Qe.onCommitFiberRoot=="function")try{Qe.onCommitFiberRoot(Yr,n,void 0,(n.current.flags&128)===128)}catch{}if(h!==null){n=B.T,p=$.p,$.p=2,B.T=null;try{for(var y=i.onRecoverableError,A=0;A<h.length;A++){var C=h[A];y(C.value,{componentStack:C.stack})}}finally{B.T=n,$.p=p}}(li&3)!==0&&vl(),Ps(i),p=i.pendingLanes,(l&261930)!==0&&(p&42)!==0?i===wh?Ra++:(Ra=0,wh=i):Ra=0,Na(0)}}function zm(i,n){(i.pooledCacheLanes&=n)===0&&(n=i.pooledCache,n!=null&&(i.pooledCache=null,ca(n)))}function vl(){return Bm(),Um(),Im(),Fm()}function Fm(){if(be!==5)return!1;var i=ji,n=bh;bh=0;var l=zc(li),h=B.T,p=$.p;try{$.p=32>l?32:l,B.T=null,l=vh,vh=null;var y=ji,A=li;if(be=0,ur=ji=null,li=0,(Pt&6)!==0)throw Error(s(331));var C=Pt;if(Pt|=4,Am(y.current),vm(y,y.current,A,l),Pt=C,Na(0,!1),Qe&&typeof Qe.onPostCommitFiberRoot=="function")try{Qe.onPostCommitFiberRoot(Yr,y)}catch{}return!0}finally{$.p=p,B.T=h,zm(i,n)}}function Hm(i,n,l){n=gs(l,n),n=Ju(i.stateNode,n,2),i=Ci(i,n,2),i!==null&&(Kr(i,2),Ps(i))}function Ut(i,n,l){if(i.tag===3)Hm(i,i,l);else for(;n!==null;){if(n.tag===3){Hm(n,i,l);break}else if(n.tag===1){var h=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Mi===null||!Mi.has(h))){i=gs(l,i),l=$p(2),h=Ci(n,l,2),h!==null&&(qp(l,h,n,i),Kr(h,2),Ps(h));break}}n=n.return}}function xh(i,n,l){var h=i.pingCache;if(h===null){h=i.pingCache=new x_;var p=new Set;h.set(n,p)}else p=h.get(n),p===void 0&&(p=new Set,h.set(n,p));p.has(l)||(ph=!0,p.add(l),i=R_.bind(null,i,n,l),n.then(i,i))}function R_(i,n,l){var h=i.pingCache;h!==null&&h.delete(n),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,qt===i&&(Nt&l)===l&&(re===4||re===3&&(Nt&62914560)===Nt&&300>We()-fl?(Pt&2)===0&&hr(i,0):mh|=l,cr===Nt&&(cr=0)),Ps(i)}function $m(i,n){n===0&&(n=Bf()),i=an(i,n),i!==null&&(Kr(i,n),Ps(i))}function N_(i){var n=i.memoizedState,l=0;n!==null&&(l=n.retryLane),$m(i,l)}function O_(i,n){var l=0;switch(i.tag){case 31:case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(l=p.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(s(314))}h!==null&&h.delete(n),$m(i,l)}function k_(i,n){return Pc(i,n)}var wl=null,fr=null,Sh=!1,_l=!1,Eh=!1,Pi=0;function Ps(i){i!==fr&&i.next===null&&(fr===null?wl=fr=i:fr=fr.next=i),_l=!0,Sh||(Sh=!0,M_())}function Na(i,n){if(!Eh&&_l){Eh=!0;do for(var l=!1,h=wl;h!==null;){if(i!==0){var p=h.pendingLanes;if(p===0)var y=0;else{var A=h.suspendedLanes,C=h.pingedLanes;y=(1<<31-Je(42|i)+1)-1,y&=p&~(A&~C),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,Ym(h,y))}else y=Nt,y=Eo(h,h===qt?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||Xr(h,y)||(l=!0,Ym(h,y));h=h.next}while(l);Eh=!1}}function D_(){qm()}function qm(){_l=Sh=!1;var i=0;Pi!==0&&$_()&&(i=Pi);for(var n=We(),l=null,h=wl;h!==null;){var p=h.next,y=Gm(h,n);y===0?(h.next=null,l===null?wl=p:l.next=p,p===null&&(fr=l)):(l=h,(i!==0||(y&3)!==0)&&(_l=!0)),h=p}be!==0&&be!==5||Na(i),Pi!==0&&(Pi=0)}function Gm(i,n){for(var l=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var A=31-Je(y),C=1<<A,O=p[A];O===-1?((C&l)===0||(C&h)!==0)&&(p[A]=rw(C,n)):O<=n&&(i.expiredLanes|=C),y&=~C}if(n=qt,l=Nt,l=Eo(i,i===n?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,l===0||i===n&&(Bt===2||Bt===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Bc(h),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||Xr(i,l)){if(n=l&-l,n===i.callbackPriority)return n;switch(h!==null&&Bc(h),zc(l)){case 2:case 8:l=Lf;break;case 32:l=_o;break;case 268435456:l=Pf;break;default:l=_o}return h=Vm.bind(null,i),l=Pc(l,h),i.callbackPriority=n,i.callbackNode=l,n}return h!==null&&h!==null&&Bc(h),i.callbackPriority=2,i.callbackNode=null,2}function Vm(i,n){if(be!==0&&be!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(vl()&&i.callbackNode!==l)return null;var h=Nt;return h=Eo(i,i===qt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(Cm(i,h,n),Gm(i,We()),i.callbackNode!=null&&i.callbackNode===l?Vm.bind(null,i):null)}function Ym(i,n){if(vl())return null;Cm(i,n,!0)}function M_(){G_(function(){(Pt&6)!==0?Pc(jf,D_):qm()})}function Th(){if(Pi===0){var i=Jn;i===0&&(i=Ao,Ao<<=1,(Ao&261888)===0&&(Ao=256)),Pi=i}return Pi}function Xm(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:No(""+i)}function Km(i,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,i.id&&l.setAttribute("form",i.id),n.parentNode.insertBefore(l,n),i=new FormData(i),l.parentNode.removeChild(l),i}function j_(i,n,l,h,p){if(n==="submit"&&l&&l.stateNode===p){var y=Xm((p[ze]||null).action),A=h.submitter;A&&(n=(n=A[ze]||null)?Xm(n.formAction):A.getAttribute("formAction"),n!==null&&(y=n,A=null));var C=new Mo("action","action",null,h,p);i.push({event:C,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Pi!==0){var O=A?Km(p,A):new FormData(p);Vu(l,{pending:!0,data:O,method:p.method,action:y},null,O)}}else typeof y=="function"&&(C.preventDefault(),O=A?Km(p,A):new FormData(p),Vu(l,{pending:!0,data:O,method:p.method,action:y},y,O))},currentTarget:p}]})}}for(var Ch=0;Ch<cu.length;Ch++){var Rh=cu[Ch],L_=Rh.toLowerCase(),P_=Rh[0].toUpperCase()+Rh.slice(1);Es(L_,"on"+P_)}Es(Tg,"onAnimationEnd"),Es(Cg,"onAnimationIteration"),Es(Rg,"onAnimationStart"),Es("dblclick","onDoubleClick"),Es("focusin","onFocus"),Es("focusout","onBlur"),Es(Jw,"onTransitionRun"),Es(Zw,"onTransitionStart"),Es(t_,"onTransitionCancel"),Es(Ng,"onTransitionEnd"),Un("onMouseEnter",["mouseout","mouseover"]),Un("onMouseLeave",["mouseout","mouseover"]),Un("onPointerEnter",["pointerout","pointerover"]),Un("onPointerLeave",["pointerout","pointerover"]),en("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),en("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),en("onBeforeInput",["compositionend","keypress","textInput","paste"]),en("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oa));function Wm(i,n){n=(n&4)!==0;for(var l=0;l<i.length;l++){var h=i[l],p=h.event;h=h.listeners;t:{var y=void 0;if(n)for(var A=h.length-1;0<=A;A--){var C=h[A],O=C.instance,z=C.currentTarget;if(C=C.listener,O!==y&&p.isPropagationStopped())break t;y=C,p.currentTarget=z;try{y(p)}catch(Y){Po(Y)}p.currentTarget=null,y=O}else for(A=0;A<h.length;A++){if(C=h[A],O=C.instance,z=C.currentTarget,C=C.listener,O!==y&&p.isPropagationStopped())break t;y=C,p.currentTarget=z;try{y(p)}catch(Y){Po(Y)}p.currentTarget=null,y=O}}}}function Rt(i,n){var l=n[Fc];l===void 0&&(l=n[Fc]=new Set);var h=i+"__bubble";l.has(h)||(Qm(n,i,2,!1),l.add(h))}function Nh(i,n,l){var h=0;n&&(h|=4),Qm(l,i,h,n)}var Al="_reactListening"+Math.random().toString(36).slice(2);function Oh(i){if(!i[Al]){i[Al]=!0,qf.forEach(function(l){l!=="selectionchange"&&(B_.has(l)||Nh(l,!1,i),Nh(l,!0,i))});var n=i.nodeType===9?i:i.ownerDocument;n===null||n[Al]||(n[Al]=!0,Nh("selectionchange",!1,n))}}function Qm(i,n,l,h){switch(Ty(n)){case 2:var p=hA;break;case 8:p=dA;break;default:p=Gh}l=p.bind(null,n,l,i),p=void 0,!Wc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(n,l,{capture:!0,passive:p}):i.addEventListener(n,l,!0):p!==void 0?i.addEventListener(n,l,{passive:p}):i.addEventListener(n,l,!1)}function kh(i,n,l,h,p){var y=h;if((n&1)===0&&(n&2)===0&&h!==null)t:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var C=h.stateNode.containerInfo;if(C===p)break;if(A===4)for(A=h.return;A!==null;){var O=A.tag;if((O===3||O===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;C!==null;){if(A=Ln(C),A===null)return;if(O=A.tag,O===5||O===6||O===26||O===27){h=y=A;continue t}C=C.parentNode}}h=h.return}sg(function(){var z=y,Y=Xc(l),W=[];t:{var H=Og.get(i);if(H!==void 0){var q=Mo,rt=i;switch(i){case"keypress":if(ko(l)===0)break t;case"keydown":case"keyup":q=Ow;break;case"focusin":rt="focus",q=tu;break;case"focusout":rt="blur",q=tu;break;case"beforeblur":case"afterblur":q=tu;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=bw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Mw;break;case Tg:case Cg:case Rg:q=_w;break;case Ng:q=Lw;break;case"scroll":case"scrollend":q=mw;break;case"wheel":q=Bw;break;case"copy":case"cut":case"paste":q=xw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=og;break;case"toggle":case"beforetoggle":q=Iw}var pt=(n&4)!==0,Ft=!pt&&(i==="scroll"||i==="scrollend"),U=pt?H!==null?H+"Capture":null:H;pt=[];for(var j=z,I;j!==null;){var K=j;if(I=K.stateNode,K=K.tag,K!==5&&K!==26&&K!==27||I===null||U===null||(K=Jr(j,U),K!=null&&pt.push(ka(j,K,I))),Ft)break;j=j.return}0<pt.length&&(H=new q(H,rt,null,l,Y),W.push({event:H,listeners:pt}))}}if((n&7)===0){t:{if(H=i==="mouseover"||i==="pointerover",q=i==="mouseout"||i==="pointerout",H&&l!==Yc&&(rt=l.relatedTarget||l.fromElement)&&(Ln(rt)||rt[jn]))break t;if((q||H)&&(H=Y.window===Y?Y:(H=Y.ownerDocument)?H.defaultView||H.parentWindow:window,q?(rt=l.relatedTarget||l.toElement,q=z,rt=rt?Ln(rt):null,rt!==null&&(Ft=a(rt),pt=rt.tag,rt!==Ft||pt!==5&&pt!==27&&pt!==6)&&(rt=null)):(q=null,rt=z),q!==rt)){if(pt=rg,K="onMouseLeave",U="onMouseEnter",j="mouse",(i==="pointerout"||i==="pointerover")&&(pt=og,K="onPointerLeave",U="onPointerEnter",j="pointer"),Ft=q==null?H:Qr(q),I=rt==null?H:Qr(rt),H=new pt(K,j+"leave",q,l,Y),H.target=Ft,H.relatedTarget=I,K=null,Ln(Y)===z&&(pt=new pt(U,j+"enter",rt,l,Y),pt.target=I,pt.relatedTarget=Ft,K=pt),Ft=K,q&&rt)e:{for(pt=U_,U=q,j=rt,I=0,K=U;K;K=pt(K))I++;K=0;for(var ht=j;ht;ht=pt(ht))K++;for(;0<I-K;)U=pt(U),I--;for(;0<K-I;)j=pt(j),K--;for(;I--;){if(U===j||j!==null&&U===j.alternate){pt=U;break e}U=pt(U),j=pt(j)}pt=null}else pt=null;q!==null&&Jm(W,H,q,pt,!1),rt!==null&&Ft!==null&&Jm(W,Ft,rt,pt,!0)}}t:{if(H=z?Qr(z):window,q=H.nodeName&&H.nodeName.toLowerCase(),q==="select"||q==="input"&&H.type==="file")var jt=pg;else if(fg(H))if(mg)jt=Kw;else{jt=Yw;var ot=Vw}else q=H.nodeName,!q||q.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?z&&Vc(z.elementType)&&(jt=pg):jt=Xw;if(jt&&(jt=jt(i,z))){gg(W,jt,l,Y);break t}ot&&ot(i,H,z),i==="focusout"&&z&&H.type==="number"&&z.memoizedProps.value!=null&&Gc(H,"number",H.value)}switch(ot=z?Qr(z):window,i){case"focusin":(fg(ot)||ot.contentEditable==="true")&&(qn=ot,au=z,aa=null);break;case"focusout":aa=au=qn=null;break;case"mousedown":ou=!0;break;case"contextmenu":case"mouseup":case"dragend":ou=!1,Sg(W,l,Y);break;case"selectionchange":if(Qw)break;case"keydown":case"keyup":Sg(W,l,Y)}var Et;if(su)t:{switch(i){case"compositionstart":var Ot="onCompositionStart";break t;case"compositionend":Ot="onCompositionEnd";break t;case"compositionupdate":Ot="onCompositionUpdate";break t}Ot=void 0}else $n?hg(i,l)&&(Ot="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Ot="onCompositionStart");Ot&&(lg&&l.locale!=="ko"&&($n||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&$n&&(Et=ig()):(wi=Y,Qc="value"in wi?wi.value:wi.textContent,$n=!0)),ot=xl(z,Ot),0<ot.length&&(Ot=new ag(Ot,i,null,l,Y),W.push({event:Ot,listeners:ot}),Et?Ot.data=Et:(Et=dg(l),Et!==null&&(Ot.data=Et)))),(Et=Fw?Hw(i,l):$w(i,l))&&(Ot=xl(z,"onBeforeInput"),0<Ot.length&&(ot=new ag("onBeforeInput","beforeinput",null,l,Y),W.push({event:ot,listeners:Ot}),ot.data=Et)),j_(W,i,z,l,Y)}Wm(W,n)})}function ka(i,n,l){return{instance:i,listener:n,currentTarget:l}}function xl(i,n){for(var l=n+"Capture",h=[];i!==null;){var p=i,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Jr(i,l),p!=null&&h.unshift(ka(i,p,y)),p=Jr(i,n),p!=null&&h.push(ka(i,p,y))),i.tag===3)return h;i=i.return}return[]}function U_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Jm(i,n,l,h,p){for(var y=n._reactName,A=[];l!==null&&l!==h;){var C=l,O=C.alternate,z=C.stateNode;if(C=C.tag,O!==null&&O===h)break;C!==5&&C!==26&&C!==27||z===null||(O=z,p?(z=Jr(l,y),z!=null&&A.unshift(ka(l,z,O))):p||(z=Jr(l,y),z!=null&&A.push(ka(l,z,O)))),l=l.return}A.length!==0&&i.push({event:n,listeners:A})}var I_=/\r\n?/g,z_=/\u0000|\uFFFD/g;function Zm(i){return(typeof i=="string"?i:""+i).replace(I_,`
`).replace(z_,"")}function ty(i,n){return n=Zm(n),Zm(i)===n}function zt(i,n,l,h,p,y){switch(l){case"children":typeof h=="string"?n==="body"||n==="textarea"&&h===""||zn(i,h):(typeof h=="number"||typeof h=="bigint")&&n!=="body"&&zn(i,""+h);break;case"className":Co(i,"class",h);break;case"tabIndex":Co(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Co(i,l,h);break;case"style":tg(i,h,y);break;case"data":if(n!=="object"){Co(i,"data",h);break}case"src":case"href":if(h===""&&(n!=="a"||l!=="href")){i.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(l);break}h=No(""+h),i.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(n!=="input"&&zt(i,n,"name",p.name,p,null),zt(i,n,"formEncType",p.formEncType,p,null),zt(i,n,"formMethod",p.formMethod,p,null),zt(i,n,"formTarget",p.formTarget,p,null)):(zt(i,n,"encType",p.encType,p,null),zt(i,n,"method",p.method,p,null),zt(i,n,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(l);break}h=No(""+h),i.setAttribute(l,h);break;case"onClick":h!=null&&(i.onclick=Ys);break;case"onScroll":h!=null&&Rt("scroll",i);break;case"onScrollEnd":h!=null&&Rt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(p.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}l=No(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(l,""+h):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":h===!0?i.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(l,h):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(l,h):i.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(l):i.setAttribute(l,h);break;case"popover":Rt("beforetoggle",i),Rt("toggle",i),To(i,"popover",h);break;case"xlinkActuate":Vs(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Vs(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Vs(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Vs(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Vs(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Vs(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Vs(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Vs(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Vs(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":To(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=gw.get(l)||l,To(i,l,h))}}function Dh(i,n,l,h,p,y){switch(l){case"style":tg(i,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(s(61));if(l=h.__html,l!=null){if(p.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"children":typeof h=="string"?zn(i,h):(typeof h=="number"||typeof h=="bigint")&&zn(i,""+h);break;case"onScroll":h!=null&&Rt("scroll",i);break;case"onScrollEnd":h!=null&&Rt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Ys);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gf.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),n=l.slice(2,p?l.length-7:void 0),y=i[ze]||null,y=y!=null?y[l]:null,typeof y=="function"&&i.removeEventListener(n,y,p),typeof h=="function")){typeof y!="function"&&y!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(n,h,p);break t}l in i?i[l]=h:h===!0?i.setAttribute(l,""):To(i,l,h)}}}function Ce(i,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",i),Rt("load",i);var h=!1,p=!1,y;for(y in l)if(l.hasOwnProperty(y)){var A=l[y];if(A!=null)switch(y){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(i,n,y,A,l,null)}}p&&zt(i,n,"srcSet",l.srcSet,l,null),h&&zt(i,n,"src",l.src,l,null);return;case"input":Rt("invalid",i);var C=y=A=p=null,O=null,z=null;for(h in l)if(l.hasOwnProperty(h)){var Y=l[h];if(Y!=null)switch(h){case"name":p=Y;break;case"type":A=Y;break;case"checked":O=Y;break;case"defaultChecked":z=Y;break;case"value":y=Y;break;case"defaultValue":C=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(137,n));break;default:zt(i,n,h,Y,l,null)}}Wf(i,y,C,O,z,A,p,!1);return;case"select":Rt("invalid",i),h=A=y=null;for(p in l)if(l.hasOwnProperty(p)&&(C=l[p],C!=null))switch(p){case"value":y=C;break;case"defaultValue":A=C;break;case"multiple":h=C;default:zt(i,n,p,C,l,null)}n=y,l=A,i.multiple=!!h,n!=null?In(i,!!h,n,!1):l!=null&&In(i,!!h,l,!0);return;case"textarea":Rt("invalid",i),y=p=h=null;for(A in l)if(l.hasOwnProperty(A)&&(C=l[A],C!=null))switch(A){case"value":h=C;break;case"defaultValue":p=C;break;case"children":y=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:zt(i,n,A,C,l,null)}Jf(i,h,p,y);return;case"option":for(O in l)if(l.hasOwnProperty(O)&&(h=l[O],h!=null))switch(O){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:zt(i,n,O,h,l,null)}return;case"dialog":Rt("beforetoggle",i),Rt("toggle",i),Rt("cancel",i),Rt("close",i);break;case"iframe":case"object":Rt("load",i);break;case"video":case"audio":for(h=0;h<Oa.length;h++)Rt(Oa[h],i);break;case"image":Rt("error",i),Rt("load",i);break;case"details":Rt("toggle",i);break;case"embed":case"source":case"link":Rt("error",i),Rt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in l)if(l.hasOwnProperty(z)&&(h=l[z],h!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(i,n,z,h,l,null)}return;default:if(Vc(n)){for(Y in l)l.hasOwnProperty(Y)&&(h=l[Y],h!==void 0&&Dh(i,n,Y,h,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(h=l[C],h!=null&&zt(i,n,C,h,l,null))}function F_(i,n,l,h){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,A=null,C=null,O=null,z=null,Y=null;for(q in l){var W=l[q];if(l.hasOwnProperty(q)&&W!=null)switch(q){case"checked":break;case"value":break;case"defaultValue":O=W;default:h.hasOwnProperty(q)||zt(i,n,q,null,h,W)}}for(var H in h){var q=h[H];if(W=l[H],h.hasOwnProperty(H)&&(q!=null||W!=null))switch(H){case"type":y=q;break;case"name":p=q;break;case"checked":z=q;break;case"defaultChecked":Y=q;break;case"value":A=q;break;case"defaultValue":C=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(s(137,n));break;default:q!==W&&zt(i,n,H,q,h,W)}}qc(i,A,C,O,z,Y,y,p);return;case"select":q=A=C=H=null;for(y in l)if(O=l[y],l.hasOwnProperty(y)&&O!=null)switch(y){case"value":break;case"multiple":q=O;default:h.hasOwnProperty(y)||zt(i,n,y,null,h,O)}for(p in h)if(y=h[p],O=l[p],h.hasOwnProperty(p)&&(y!=null||O!=null))switch(p){case"value":H=y;break;case"defaultValue":C=y;break;case"multiple":A=y;default:y!==O&&zt(i,n,p,y,h,O)}n=C,l=A,h=q,H!=null?In(i,!!l,H,!1):!!h!=!!l&&(n!=null?In(i,!!l,n,!0):In(i,!!l,l?[]:"",!1));return;case"textarea":q=H=null;for(C in l)if(p=l[C],l.hasOwnProperty(C)&&p!=null&&!h.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:zt(i,n,C,null,h,p)}for(A in h)if(p=h[A],y=l[A],h.hasOwnProperty(A)&&(p!=null||y!=null))switch(A){case"value":H=p;break;case"defaultValue":q=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==y&&zt(i,n,A,p,h,y)}Qf(i,H,q);return;case"option":for(var rt in l)if(H=l[rt],l.hasOwnProperty(rt)&&H!=null&&!h.hasOwnProperty(rt))switch(rt){case"selected":i.selected=!1;break;default:zt(i,n,rt,null,h,H)}for(O in h)if(H=h[O],q=l[O],h.hasOwnProperty(O)&&H!==q&&(H!=null||q!=null))switch(O){case"selected":i.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:zt(i,n,O,H,h,q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in l)H=l[pt],l.hasOwnProperty(pt)&&H!=null&&!h.hasOwnProperty(pt)&&zt(i,n,pt,null,h,H);for(z in h)if(H=h[z],q=l[z],h.hasOwnProperty(z)&&H!==q&&(H!=null||q!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:zt(i,n,z,H,h,q)}return;default:if(Vc(n)){for(var Ft in l)H=l[Ft],l.hasOwnProperty(Ft)&&H!==void 0&&!h.hasOwnProperty(Ft)&&Dh(i,n,Ft,void 0,h,H);for(Y in h)H=h[Y],q=l[Y],!h.hasOwnProperty(Y)||H===q||H===void 0&&q===void 0||Dh(i,n,Y,H,h,q);return}}for(var U in l)H=l[U],l.hasOwnProperty(U)&&H!=null&&!h.hasOwnProperty(U)&&zt(i,n,U,null,h,H);for(W in h)H=h[W],q=l[W],!h.hasOwnProperty(W)||H===q||H==null&&q==null||zt(i,n,W,H,h,q)}function ey(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function H_(){if(typeof performance.getEntriesByType=="function"){for(var i=0,n=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var p=l[h],y=p.transferSize,A=p.initiatorType,C=p.duration;if(y&&C&&ey(A)){for(A=0,C=p.responseEnd,h+=1;h<l.length;h++){var O=l[h],z=O.startTime;if(z>C)break;var Y=O.transferSize,W=O.initiatorType;Y&&ey(W)&&(O=O.responseEnd,A+=Y*(O<C?1:(C-z)/(O-z)))}if(--h,n+=8*(y+A)/(p.duration/1e3),i++,10<i)break}}if(0<i)return n/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Mh=null,jh=null;function Sl(i){return i.nodeType===9?i:i.ownerDocument}function sy(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iy(i,n){if(i===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&n==="foreignObject"?0:i}function Lh(i,n){return i==="textarea"||i==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Ph=null;function $_(){var i=window.event;return i&&i.type==="popstate"?i===Ph?!1:(Ph=i,!0):(Ph=null,!1)}var ny=typeof setTimeout=="function"?setTimeout:void 0,q_=typeof clearTimeout=="function"?clearTimeout:void 0,ry=typeof Promise=="function"?Promise:void 0,G_=typeof queueMicrotask=="function"?queueMicrotask:typeof ry<"u"?function(i){return ry.resolve(null).then(i).catch(V_)}:ny;function V_(i){setTimeout(function(){throw i})}function Bi(i){return i==="head"}function ay(i,n){var l=n,h=0;do{var p=l.nextSibling;if(i.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(h===0){i.removeChild(p),yr(n);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")Da(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,Da(l);for(var y=l.firstChild;y;){var A=y.nextSibling,C=y.nodeName;y[Wr]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=A}}else l==="body"&&Da(i.ownerDocument.body);l=p}while(l);yr(n)}function oy(i,n){var l=i;i=0;do{var h=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=h}while(l)}function Bh(i){var n=i.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Bh(l),Hc(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function Y_(i,n,l,h){for(;i.nodeType===1;){var p=l;if(i.nodeName.toLowerCase()!==n.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[Wr])switch(n){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(n==="input"&&i.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=vs(i.nextSibling),i===null)break}return null}function X_(i,n,l){if(n==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=vs(i.nextSibling),i===null))return null;return i}function ly(i,n){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!n||(i=vs(i.nextSibling),i===null))return null;return i}function Uh(i){return i.data==="$?"||i.data==="$~"}function Ih(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function K_(i,n){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=n;else if(i.data!=="$?"||l.readyState!=="loading")n();else{var h=function(){n(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function vs(i){for(;i!=null;i=i.nextSibling){var n=i.nodeType;if(n===1||n===3)break;if(n===8){if(n=i.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return i}var zh=null;function cy(i){i=i.nextSibling;for(var n=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(n===0)return vs(i.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}i=i.nextSibling}return null}function uy(i){i=i.previousSibling;for(var n=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return i;n--}else l!=="/$"&&l!=="/&"||n++}i=i.previousSibling}return null}function hy(i,n,l){switch(n=Sl(l),i){case"html":if(i=n.documentElement,!i)throw Error(s(452));return i;case"head":if(i=n.head,!i)throw Error(s(453));return i;case"body":if(i=n.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function Da(i){for(var n=i.attributes;n.length;)i.removeAttributeNode(n[0]);Hc(i)}var ws=new Map,dy=new Set;function El(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ci=$.d;$.d={f:W_,r:Q_,D:J_,C:Z_,L:tA,m:eA,X:iA,S:sA,M:nA};function W_(){var i=ci.f(),n=ml();return i||n}function Q_(i){var n=Pn(i);n!==null&&n.tag===5&&n.type==="form"?Np(n):ci.r(i)}var gr=typeof document>"u"?null:document;function fy(i,n,l){var h=gr;if(h&&typeof n=="string"&&n){var p=ds(n);p='link[rel="'+i+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),dy.has(p)||(dy.add(p),i={rel:i,crossOrigin:l,href:n},h.querySelector(p)===null&&(n=h.createElement("link"),Ce(n,"link",i),we(n),h.head.appendChild(n)))}}function J_(i){ci.D(i),fy("dns-prefetch",i,null)}function Z_(i,n){ci.C(i,n),fy("preconnect",i,n)}function tA(i,n,l){ci.L(i,n,l);var h=gr;if(h&&i&&n){var p='link[rel="preload"][as="'+ds(n)+'"]';n==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+ds(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+ds(l.imageSizes)+'"]')):p+='[href="'+ds(i)+'"]';var y=p;switch(n){case"style":y=pr(i);break;case"script":y=mr(i)}ws.has(y)||(i=m({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:i,as:n},l),ws.set(y,i),h.querySelector(p)!==null||n==="style"&&h.querySelector(Ma(y))||n==="script"&&h.querySelector(ja(y))||(n=h.createElement("link"),Ce(n,"link",i),we(n),h.head.appendChild(n)))}}function eA(i,n){ci.m(i,n);var l=gr;if(l&&i){var h=n&&typeof n.as=="string"?n.as:"script",p='link[rel="modulepreload"][as="'+ds(h)+'"][href="'+ds(i)+'"]',y=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=mr(i)}if(!ws.has(y)&&(i=m({rel:"modulepreload",href:i},n),ws.set(y,i),l.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ja(y)))return}h=l.createElement("link"),Ce(h,"link",i),we(h),l.head.appendChild(h)}}}function sA(i,n,l){ci.S(i,n,l);var h=gr;if(h&&i){var p=Bn(h).hoistableStyles,y=pr(i);n=n||"default";var A=p.get(y);if(!A){var C={loading:0,preload:null};if(A=h.querySelector(Ma(y)))C.loading=5;else{i=m({rel:"stylesheet",href:i,"data-precedence":n},l),(l=ws.get(y))&&Fh(i,l);var O=A=h.createElement("link");we(O),Ce(O,"link",i),O._p=new Promise(function(z,Y){O.onload=z,O.onerror=Y}),O.addEventListener("load",function(){C.loading|=1}),O.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Tl(A,n,h)}A={type:"stylesheet",instance:A,count:1,state:C},p.set(y,A)}}}function iA(i,n){ci.X(i,n);var l=gr;if(l&&i){var h=Bn(l).hoistableScripts,p=mr(i),y=h.get(p);y||(y=l.querySelector(ja(p)),y||(i=m({src:i,async:!0},n),(n=ws.get(p))&&Hh(i,n),y=l.createElement("script"),we(y),Ce(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function nA(i,n){ci.M(i,n);var l=gr;if(l&&i){var h=Bn(l).hoistableScripts,p=mr(i),y=h.get(p);y||(y=l.querySelector(ja(p)),y||(i=m({src:i,async:!0,type:"module"},n),(n=ws.get(p))&&Hh(i,n),y=l.createElement("script"),we(y),Ce(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function gy(i,n,l,h){var p=(p=vt.current)?El(p):null;if(!p)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=pr(l.href),l=Bn(p).hoistableStyles,h=l.get(n),h||(h={type:"style",instance:null,count:0,state:null},l.set(n,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=pr(l.href);var y=Bn(p).hoistableStyles,A=y.get(i);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,A),(y=p.querySelector(Ma(i)))&&!y._p&&(A.instance=y,A.state.loading=5),ws.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ws.set(i,l),y||rA(p,i,l,A.state))),n&&h===null)throw Error(s(528,""));return A}if(n&&h!==null)throw Error(s(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=mr(l),l=Bn(p).hoistableScripts,h=l.get(n),h||(h={type:"script",instance:null,count:0,state:null},l.set(n,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function pr(i){return'href="'+ds(i)+'"'}function Ma(i){return'link[rel="stylesheet"]['+i+"]"}function py(i){return m({},i,{"data-precedence":i.precedence,precedence:null})}function rA(i,n,l,h){i.querySelector('link[rel="preload"][as="style"]['+n+"]")?h.loading=1:(n=i.createElement("link"),h.preload=n,n.addEventListener("load",function(){return h.loading|=1}),n.addEventListener("error",function(){return h.loading|=2}),Ce(n,"link",l),we(n),i.head.appendChild(n))}function mr(i){return'[src="'+ds(i)+'"]'}function ja(i){return"script[async]"+i}function my(i,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var h=i.querySelector('style[data-href~="'+ds(l.href)+'"]');if(h)return n.instance=h,we(h),h;var p=m({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),we(h),Ce(h,"style",p),Tl(h,l.precedence,i),n.instance=h;case"stylesheet":p=pr(l.href);var y=i.querySelector(Ma(p));if(y)return n.state.loading|=4,n.instance=y,we(y),y;h=py(l),(p=ws.get(p))&&Fh(h,p),y=(i.ownerDocument||i).createElement("link"),we(y);var A=y;return A._p=new Promise(function(C,O){A.onload=C,A.onerror=O}),Ce(y,"link",h),n.state.loading|=4,Tl(y,l.precedence,i),n.instance=y;case"script":return y=mr(l.src),(p=i.querySelector(ja(y)))?(n.instance=p,we(p),p):(h=l,(p=ws.get(y))&&(h=m({},l),Hh(h,p)),i=i.ownerDocument||i,p=i.createElement("script"),we(p),Ce(p,"link",h),i.head.appendChild(p),n.instance=p);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(h=n.instance,n.state.loading|=4,Tl(h,l.precedence,i));return n.instance}function Tl(i,n,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,y=p,A=0;A<h.length;A++){var C=h[A];if(C.dataset.precedence===n)y=C;else if(y!==p)break}y?y.parentNode.insertBefore(i,y.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(i,n.firstChild))}function Fh(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.title==null&&(i.title=n.title)}function Hh(i,n){i.crossOrigin==null&&(i.crossOrigin=n.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=n.referrerPolicy),i.integrity==null&&(i.integrity=n.integrity)}var Cl=null;function yy(i,n,l){if(Cl===null){var h=new Map,p=Cl=new Map;p.set(l,h)}else p=Cl,h=p.get(l),h||(h=new Map,p.set(l,h));if(h.has(i))return h;for(h.set(i,null),l=l.getElementsByTagName(i),p=0;p<l.length;p++){var y=l[p];if(!(y[Wr]||y[xe]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var A=y.getAttribute(n)||"";A=i+A;var C=h.get(A);C?C.push(y):h.set(A,[y])}}return h}function by(i,n,l){i=i.ownerDocument||i,i.head.insertBefore(l,n==="title"?i.querySelector("head > title"):null)}function aA(i,n,l){if(l===1||n.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return i=n.disabled,typeof n.precedence=="string"&&i==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function vy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function oA(i,n,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=pr(h.href),y=n.querySelector(Ma(p));if(y){n=y._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(i.count++,i=Rl.bind(i),n.then(i,i)),l.state.loading|=4,l.instance=y,we(y);return}y=n.ownerDocument||n,h=py(h),(p=ws.get(p))&&Fh(h,p),y=y.createElement("link"),we(y);var A=y;A._p=new Promise(function(C,O){A.onload=C,A.onerror=O}),Ce(y,"link",h),l.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=Rl.bind(i),n.addEventListener("load",l),n.addEventListener("error",l))}}var $h=0;function lA(i,n){return i.stylesheets&&i.count===0&&Ol(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var h=setTimeout(function(){if(i.stylesheets&&Ol(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+n);0<i.imgBytes&&$h===0&&($h=62500*H_());var p=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Ol(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>$h?50:800)+n);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(p)}}:null}function Rl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ol(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Nl=null;function Ol(i,n){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Nl=new Map,n.forEach(cA,i),Nl=null,Rl.call(i))}function cA(i,n){if(!(n.state.loading&4)){var l=Nl.get(i);if(l)var h=l.get(null);else{l=new Map,Nl.set(i,l);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var A=p[y];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(l.set(A.dataset.precedence,A),h=A)}h&&l.set(null,h)}p=n.instance,A=p.getAttribute("data-precedence"),y=l.get(A)||h,y===h&&l.set(null,p),l.set(A,p),this.count++,h=Rl.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),y?y.parentNode.insertBefore(p,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),n.state.loading|=4}}var La={$$typeof:T,Provider:null,Consumer:null,_currentValue:st,_currentValue2:st,_threadCount:0};function uA(i,n,l,h,p,y,A,C,O){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Uc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uc(0),this.hiddenUpdates=Uc(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function wy(i,n,l,h,p,y,A,C,O,z,Y,W){return i=new uA(i,n,l,A,O,z,Y,W,C),n=1,y===!0&&(n|=24),y=ts(3,null,null,n),i.current=y,y.stateNode=i,n=Au(),n.refCount++,i.pooledCache=n,n.refCount++,y.memoizedState={element:h,isDehydrated:l,cache:n},Tu(y),i}function _y(i){return i?(i=Yn,i):Yn}function Ay(i,n,l,h,p,y){p=_y(p),h.context===null?h.context=p:h.pendingContext=p,h=Ti(n),h.payload={element:l},y=y===void 0?null:y,y!==null&&(h.callback=y),l=Ci(i,h,n),l!==null&&(Ve(l,i,n),fa(l,i,n))}function xy(i,n){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<n?l:n}}function qh(i,n){xy(i,n),(i=i.alternate)&&xy(i,n)}function Sy(i){if(i.tag===13||i.tag===31){var n=an(i,67108864);n!==null&&Ve(n,i,67108864),qh(i,67108864)}}function Ey(i){if(i.tag===13||i.tag===31){var n=rs();n=Ic(n);var l=an(i,n);l!==null&&Ve(l,i,n),qh(i,n)}}var kl=!0;function hA(i,n,l,h){var p=B.T;B.T=null;var y=$.p;try{$.p=2,Gh(i,n,l,h)}finally{$.p=y,B.T=p}}function dA(i,n,l,h){var p=B.T;B.T=null;var y=$.p;try{$.p=8,Gh(i,n,l,h)}finally{$.p=y,B.T=p}}function Gh(i,n,l,h){if(kl){var p=Vh(h);if(p===null)kh(i,n,h,Dl,l),Cy(i,h);else if(gA(p,i,n,l,h))h.stopPropagation();else if(Cy(i,h),n&4&&-1<fA.indexOf(i)){for(;p!==null;){var y=Pn(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var A=tn(y.pendingLanes);if(A!==0){var C=y;for(C.pendingLanes|=2,C.entangledLanes|=2;A;){var O=1<<31-Je(A);C.entanglements[1]|=O,A&=~O}Ps(y),(Pt&6)===0&&(gl=We()+500,Na(0))}}break;case 31:case 13:C=an(y,2),C!==null&&Ve(C,y,2),ml(),qh(y,2)}if(y=Vh(h),y===null&&kh(i,n,h,Dl,l),y===p)break;p=y}p!==null&&h.stopPropagation()}else kh(i,n,h,null,l)}}function Vh(i){return i=Xc(i),Yh(i)}var Dl=null;function Yh(i){if(Dl=null,i=Ln(i),i!==null){var n=a(i);if(n===null)i=null;else{var l=n.tag;if(l===13){if(i=o(n),i!==null)return i;i=null}else if(l===31){if(i=u(n),i!==null)return i;i=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null)}}return Dl=i,null}function Ty(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jv()){case jf:return 2;case Lf:return 8;case _o:case Zv:return 32;case Pf:return 268435456;default:return 32}default:return 32}}var Xh=!1,Ui=null,Ii=null,zi=null,Pa=new Map,Ba=new Map,Fi=[],fA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cy(i,n){switch(i){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":Pa.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ba.delete(n.pointerId)}}function Ua(i,n,l,h,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:n,domEventName:l,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},n!==null&&(n=Pn(n),n!==null&&Sy(n)),i):(i.eventSystemFlags|=h,n=i.targetContainers,p!==null&&n.indexOf(p)===-1&&n.push(p),i)}function gA(i,n,l,h,p){switch(n){case"focusin":return Ui=Ua(Ui,i,n,l,h,p),!0;case"dragenter":return Ii=Ua(Ii,i,n,l,h,p),!0;case"mouseover":return zi=Ua(zi,i,n,l,h,p),!0;case"pointerover":var y=p.pointerId;return Pa.set(y,Ua(Pa.get(y)||null,i,n,l,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Ba.set(y,Ua(Ba.get(y)||null,i,n,l,h,p)),!0}return!1}function Ry(i){var n=Ln(i.target);if(n!==null){var l=a(n);if(l!==null){if(n=l.tag,n===13){if(n=o(l),n!==null){i.blockedOn=n,Hf(i.priority,function(){Ey(l)});return}}else if(n===31){if(n=u(l),n!==null){i.blockedOn=n,Hf(i.priority,function(){Ey(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ml(i){if(i.blockedOn!==null)return!1;for(var n=i.targetContainers;0<n.length;){var l=Vh(i.nativeEvent);if(l===null){l=i.nativeEvent;var h=new l.constructor(l.type,l);Yc=h,l.target.dispatchEvent(h),Yc=null}else return n=Pn(l),n!==null&&Sy(n),i.blockedOn=l,!1;n.shift()}return!0}function Ny(i,n,l){Ml(i)&&l.delete(n)}function pA(){Xh=!1,Ui!==null&&Ml(Ui)&&(Ui=null),Ii!==null&&Ml(Ii)&&(Ii=null),zi!==null&&Ml(zi)&&(zi=null),Pa.forEach(Ny),Ba.forEach(Ny)}function jl(i,n){i.blockedOn===n&&(i.blockedOn=null,Xh||(Xh=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,pA)))}var Ll=null;function Oy(i){Ll!==i&&(Ll=i,c.unstable_scheduleCallback(c.unstable_NormalPriority,function(){Ll===i&&(Ll=null);for(var n=0;n<i.length;n+=3){var l=i[n],h=i[n+1],p=i[n+2];if(typeof h!="function"){if(Yh(h||l)===null)continue;break}var y=Pn(l);y!==null&&(i.splice(n,3),n-=3,Vu(y,{pending:!0,data:p,method:l.method,action:h},h,p))}}))}function yr(i){function n(O){return jl(O,i)}Ui!==null&&jl(Ui,i),Ii!==null&&jl(Ii,i),zi!==null&&jl(zi,i),Pa.forEach(n),Ba.forEach(n);for(var l=0;l<Fi.length;l++){var h=Fi[l];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Fi.length&&(l=Fi[0],l.blockedOn===null);)Ry(l),l.blockedOn===null&&Fi.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var p=l[h],y=l[h+1],A=p[ze]||null;if(typeof y=="function")A||Oy(l);else if(A){var C=null;if(y&&y.hasAttribute("formAction")){if(p=y,A=y[ze]||null)C=A.formAction;else if(Yh(p)!==null)continue}else C=A.action;typeof C=="function"?l[h+1]=C:(l.splice(h,3),h-=3),Oy(l)}}}function ky(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(A){return p=A})},focusReset:"manual",scroll:"manual"})}function n(){p!==null&&(p(),p=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,p=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),p!==null&&(p(),p=null)}}}function Kh(i){this._internalRoot=i}Pl.prototype.render=Kh.prototype.render=function(i){var n=this._internalRoot;if(n===null)throw Error(s(409));var l=n.current,h=rs();Ay(l,h,i,n,null,null)},Pl.prototype.unmount=Kh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var n=i.containerInfo;Ay(i.current,2,null,i,null,null),ml(),n[jn]=null}};function Pl(i){this._internalRoot=i}Pl.prototype.unstable_scheduleHydration=function(i){if(i){var n=Ff();i={blockedOn:null,target:i,priority:n};for(var l=0;l<Fi.length&&n!==0&&n<Fi[l].priority;l++);Fi.splice(l,0,i),l===0&&Ry(i)}};var Dy=t.version;if(Dy!=="19.2.0")throw Error(s(527,Dy,"19.2.0"));$.findDOMNode=function(i){var n=i._reactInternals;if(n===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=f(n),i=i!==null?g(i):null,i=i===null?null:i.stateNode,i};var mA={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bl.isDisabled&&Bl.supportsFiber)try{Yr=Bl.inject(mA),Qe=Bl}catch{}}return za.createRoot=function(i,n){if(!r(i))throw Error(s(299));var l=!1,h="",p=Ip,y=zp,A=Fp;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onUncaughtError!==void 0&&(p=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(A=n.onRecoverableError)),n=wy(i,1,!1,null,null,l,h,null,p,y,A,ky),i[jn]=n.current,Oh(i),new Kh(n)},za.hydrateRoot=function(i,n,l){if(!r(i))throw Error(s(299));var h=!1,p="",y=Ip,A=zp,C=Fp,O=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(A=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.formState!==void 0&&(O=l.formState)),n=wy(i,1,!0,n,l??null,h,p,O,y,A,C,ky),n.context=_y(null),l=n.current,h=rs(),h=Ic(h),p=Ti(h),p.callback=null,Ci(l,p,h),l=h,n.current.lanes=l,Kr(n,l),Ps(n),i[jn]=n.current,Oh(i),new Pl(n)},za.version="19.2.0",za}var qy;function NA(){if(qy)return Zh.exports;qy=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(t){console.error(t)}}return c(),Zh.exports=RA(),Zh.exports}var OA=NA();var Gy="popstate";function kA(c={}){function t(s,r){let{pathname:a,search:o,hash:u}=s.location;return Ad("",{pathname:a,search:o,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function e(s,r){return typeof r=="string"?r:to(r)}return MA(t,e,null,c)}function se(c,t){if(c===!1||c===null||typeof c>"u")throw new Error(t)}function Ds(c,t){if(!c){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function DA(){return Math.random().toString(36).substring(2,10)}function Vy(c,t){return{usr:c.state,key:c.key,idx:t}}function Ad(c,t,e=null,s){return{pathname:typeof c=="string"?c:c.pathname,search:"",hash:"",...typeof t=="string"?Hr(t):t,state:e,key:t&&t.key||s||DA()}}function to({pathname:c="/",search:t="",hash:e=""}){return t&&t!=="?"&&(c+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(c+=e.charAt(0)==="#"?e:"#"+e),c}function Hr(c){let t={};if(c){let e=c.indexOf("#");e>=0&&(t.hash=c.substring(e),c=c.substring(0,e));let s=c.indexOf("?");s>=0&&(t.search=c.substring(s),c=c.substring(0,s)),c&&(t.pathname=c)}return t}function MA(c,t,e,s={}){let{window:r=document.defaultView,v5Compat:a=!1}=s,o=r.history,u="POP",d=null,f=g();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function g(){return(o.state||{idx:null}).idx}function m(){u="POP";let S=g(),E=S==null?null:S-f;f=S,d&&d({action:u,location:w.location,delta:E})}function b(S,E){u="PUSH";let R=Ad(w.location,S,E);f=g()+1;let T=Vy(R,f),N=w.createHref(R);try{o.pushState(T,"",N)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;r.location.assign(N)}a&&d&&d({action:u,location:w.location,delta:1})}function v(S,E){u="REPLACE";let R=Ad(w.location,S,E);f=g();let T=Vy(R,f),N=w.createHref(R);o.replaceState(T,"",N),a&&d&&d({action:u,location:w.location,delta:0})}function x(S){return jA(S)}let w={get action(){return u},get location(){return c(r,o)},listen(S){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(Gy,m),d=S,()=>{r.removeEventListener(Gy,m),d=null}},createHref(S){return t(r,S)},createURL:x,encodeLocation(S){let E=x(S);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:v,go(S){return o.go(S)}};return w}function jA(c,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),se(e,"No window.location.(origin|href) available to create URL");let s=typeof c=="string"?c:to(c);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=e+s),new URL(s,e)}function eb(c,t,e="/"){return LA(c,t,e,!1)}function LA(c,t,e,s){let r=typeof t=="string"?Hr(t):t,a=pi(r.pathname||"/",e);if(a==null)return null;let o=sb(c);PA(o);let u=null;for(let d=0;u==null&&d<o.length;++d){let f=YA(a);u=GA(o[d],f,s)}return u}function sb(c,t=[],e=[],s="",r=!1){let a=(o,u,d=r,f)=>{let g={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&d)return;se(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let m=gi([s,g.relativePath]),b=e.concat(g);o.children&&o.children.length>0&&(se(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),sb(o.children,t,b,m,d)),!(o.path==null&&!o.index)&&t.push({path:m,score:$A(m,o.index),routesMeta:b})};return c.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))a(o,u);else for(let d of ib(o.path))a(o,u,!0,d)}),t}function ib(c){let t=c.split("/");if(t.length===0)return[];let[e,...s]=t,r=e.endsWith("?"),a=e.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let o=ib(s.join("/")),u=[];return u.push(...o.map(d=>d===""?a:[a,d].join("/"))),r&&u.push(...o),u.map(d=>c.startsWith("/")&&d===""?"/":d)}function PA(c){c.sort((t,e)=>t.score!==e.score?e.score-t.score:qA(t.routesMeta.map(s=>s.childrenIndex),e.routesMeta.map(s=>s.childrenIndex)))}var BA=/^:[\w-]+$/,UA=3,IA=2,zA=1,FA=10,HA=-2,Yy=c=>c==="*";function $A(c,t){let e=c.split("/"),s=e.length;return e.some(Yy)&&(s+=HA),t&&(s+=IA),e.filter(r=>!Yy(r)).reduce((r,a)=>r+(BA.test(a)?UA:a===""?zA:FA),s)}function qA(c,t){return c.length===t.length&&c.slice(0,-1).every((s,r)=>s===t[r])?c[c.length-1]-t[t.length-1]:0}function GA(c,t,e=!1){let{routesMeta:s}=c,r={},a="/",o=[];for(let u=0;u<s.length;++u){let d=s[u],f=u===s.length-1,g=a==="/"?t:t.slice(a.length)||"/",m=cc({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},g),b=d.route;if(!m&&f&&e&&!s[s.length-1].route.index&&(m=cc({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!m)return null;Object.assign(r,m.params),o.push({params:r,pathname:gi([a,m.pathname]),pathnameBase:JA(gi([a,m.pathnameBase])),route:b}),m.pathnameBase!=="/"&&(a=gi([a,m.pathnameBase]))}return o}function cc(c,t){typeof c=="string"&&(c={path:c,caseSensitive:!1,end:!0});let[e,s]=VA(c.path,c.caseSensitive,c.end),r=t.match(e);if(!r)return null;let a=r[0],o=a.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:s.reduce((f,{paramName:g,isOptional:m},b)=>{if(g==="*"){let x=u[b]||"";o=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=u[b];return m&&!v?f[g]=void 0:f[g]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:o,pattern:c}}function VA(c,t=!1,e=!0){Ds(c==="*"||!c.endsWith("*")||c.endsWith("/*"),`Route path "${c}" will be treated as if it were "${c.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${c.replace(/\*$/,"/*")}".`);let s=[],r="^"+c.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return c.endsWith("*")?(s.push({paramName:"*"}),r+=c==="*"||c==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?r+="\\/*$":c!==""&&c!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function YA(c){try{return c.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ds(!1,`The URL path "${c}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),c}}function pi(c,t){if(t==="/")return c;if(!c.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,s=c.charAt(e);return s&&s!=="/"?null:c.slice(e)||"/"}var XA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KA=c=>XA.test(c);function WA(c,t="/"){let{pathname:e,search:s="",hash:r=""}=typeof c=="string"?Hr(c):c,a;if(e)if(KA(e))a=e;else{if(e.includes("//")){let o=e;e=e.replace(/\/\/+/g,"/"),Ds(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${e}`)}e.startsWith("/")?a=Xy(e.substring(1),"/"):a=Xy(e,t)}else a=t;return{pathname:a,search:ZA(s),hash:tx(r)}}function Xy(c,t){let e=t.replace(/\/+$/,"").split("/");return c.split("/").forEach(r=>{r===".."?e.length>1&&e.pop():r!=="."&&e.push(r)}),e.length>1?e.join("/"):"/"}function id(c,t,e,s){return`Cannot include a '${c}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function QA(c){return c.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function nb(c){let t=QA(c);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function rb(c,t,e,s=!1){let r;typeof c=="string"?r=Hr(c):(r={...c},se(!r.pathname||!r.pathname.includes("?"),id("?","pathname","search",r)),se(!r.pathname||!r.pathname.includes("#"),id("#","pathname","hash",r)),se(!r.search||!r.search.includes("#"),id("#","search","hash",r)));let a=c===""||r.pathname==="",o=a?"/":r.pathname,u;if(o==null)u=e;else{let m=t.length-1;if(!s&&o.startsWith("..")){let b=o.split("/");for(;b[0]==="..";)b.shift(),m-=1;r.pathname=b.join("/")}u=m>=0?t[m]:"/"}let d=WA(r,u),f=o&&o!=="/"&&o.endsWith("/"),g=(a||o===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||g)&&(d.pathname+="/"),d}var gi=c=>c.join("/").replace(/\/\/+/g,"/"),JA=c=>c.replace(/\/+$/,"").replace(/^\/*/,"/"),ZA=c=>!c||c==="?"?"":c.startsWith("?")?c:"?"+c,tx=c=>!c||c==="#"?"":c.startsWith("#")?c:"#"+c;function ex(c){return c!=null&&typeof c.status=="number"&&typeof c.statusText=="string"&&typeof c.internal=="boolean"&&"data"in c}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ab=["POST","PUT","PATCH","DELETE"];new Set(ab);var sx=["GET",...ab];new Set(sx);var $r=F.createContext(null);$r.displayName="DataRouter";var _c=F.createContext(null);_c.displayName="DataRouterState";F.createContext(!1);var ob=F.createContext({isTransitioning:!1});ob.displayName="ViewTransition";var ix=F.createContext(new Map);ix.displayName="Fetchers";var nx=F.createContext(null);nx.displayName="Await";var qs=F.createContext(null);qs.displayName="Navigation";var co=F.createContext(null);co.displayName="Location";var mi=F.createContext({outlet:null,matches:[],isDataRoute:!1});mi.displayName="Route";var Jd=F.createContext(null);Jd.displayName="RouteError";function rx(c,{relative:t}={}){se(uo(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:s}=F.useContext(qs),{hash:r,pathname:a,search:o}=ho(c,{relative:t}),u=a;return e!=="/"&&(u=a==="/"?e:gi([e,a])),s.createHref({pathname:u,search:o,hash:r})}function uo(){return F.useContext(co)!=null}function Wi(){return se(uo(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(co).location}var lb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cb(c){F.useContext(qs).static||F.useLayoutEffect(c)}function ub(){let{isDataRoute:c}=F.useContext(mi);return c?bx():ax()}function ax(){se(uo(),"useNavigate() may be used only in the context of a <Router> component.");let c=F.useContext($r),{basename:t,navigator:e}=F.useContext(qs),{matches:s}=F.useContext(mi),{pathname:r}=Wi(),a=JSON.stringify(nb(s)),o=F.useRef(!1);return cb(()=>{o.current=!0}),F.useCallback((d,f={})=>{if(Ds(o.current,lb),!o.current)return;if(typeof d=="number"){e.go(d);return}let g=rb(d,JSON.parse(a),r,f.relative==="path");c==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:gi([t,g.pathname])),(f.replace?e.replace:e.push)(g,f.state,f)},[t,e,a,r,c])}F.createContext(null);function ho(c,{relative:t}={}){let{matches:e}=F.useContext(mi),{pathname:s}=Wi(),r=JSON.stringify(nb(e));return F.useMemo(()=>rb(c,JSON.parse(r),s,t==="path"),[c,r,s,t])}function ox(c,t){return hb(c,t)}function hb(c,t,e,s,r){se(uo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=F.useContext(qs),{matches:o}=F.useContext(mi),u=o[o.length-1],d=u?u.params:{},f=u?u.pathname:"/",g=u?u.pathnameBase:"/",m=u&&u.route;{let R=m&&m.path||"";db(f,!m||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let b=Wi(),v;if(t){let R=typeof t=="string"?Hr(t):t;se(g==="/"||R.pathname?.startsWith(g),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=b;let x=v.pathname||"/",w=x;if(g!=="/"){let R=g.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(R.length).join("/")}let S=eb(c,{pathname:w});Ds(m||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ds(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=dx(S&&S.map(R=>Object.assign({},R,{params:Object.assign({},d,R.params),pathname:gi([g,a.encodeLocation?a.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?g:gi([g,a.encodeLocation?a.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),o,e,s,r);return t&&E?F.createElement(co.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function lx(){let c=yx(),t=ex(c)?`${c.status} ${c.statusText}`:c instanceof Error?c.message:JSON.stringify(c),e=c instanceof Error?c.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",c),o=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:a},"ErrorBoundary")," or"," ",F.createElement("code",{style:a},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},t),e?F.createElement("pre",{style:r},e):null,o)}var cx=F.createElement(lx,null),ux=class extends F.Component{constructor(c){super(c),this.state={location:c.location,revalidation:c.revalidation,error:c.error}}static getDerivedStateFromError(c){return{error:c}}static getDerivedStateFromProps(c,t){return t.location!==c.location||t.revalidation!=="idle"&&c.revalidation==="idle"?{error:c.error,location:c.location,revalidation:c.revalidation}:{error:c.error!==void 0?c.error:t.error,location:t.location,revalidation:c.revalidation||t.revalidation}}componentDidCatch(c,t){this.props.onError?this.props.onError(c,t):console.error("React Router caught the following error during render",c)}render(){return this.state.error!==void 0?F.createElement(mi.Provider,{value:this.props.routeContext},F.createElement(Jd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function hx({routeContext:c,match:t,children:e}){let s=F.useContext($r);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),F.createElement(mi.Provider,{value:c},e)}function dx(c,t=[],e=null,s=null,r=null){if(c==null){if(!e)return null;if(e.errors)c=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)c=e.matches;else return null}let a=c,o=e?.errors;if(o!=null){let g=a.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);se(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,g+1))}let u=!1,d=-1;if(e)for(let g=0;g<a.length;g++){let m=a[g];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=g),m.route.id){let{loaderData:b,errors:v}=e,x=m.route.loader&&!b.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||x){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}let f=e&&s?(g,m)=>{s(g,{location:e.location,params:e.matches?.[0]?.params??{},errorInfo:m})}:void 0;return a.reduceRight((g,m,b)=>{let v,x=!1,w=null,S=null;e&&(v=o&&m.route.id?o[m.route.id]:void 0,w=m.route.errorElement||cx,u&&(d<0&&b===0?(db("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,S=null):d===b&&(x=!0,S=m.route.hydrateFallbackElement||null)));let E=t.concat(a.slice(0,b+1)),R=()=>{let T;return v?T=w:x?T=S:m.route.Component?T=F.createElement(m.route.Component,null):m.route.element?T=m.route.element:T=g,F.createElement(hx,{match:m,routeContext:{outlet:g,matches:E,isDataRoute:e!=null},children:T})};return e&&(m.route.ErrorBoundary||m.route.errorElement||b===0)?F.createElement(ux,{location:e.location,revalidation:e.revalidation,component:w,error:v,children:R(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:f}):R()},null)}function Zd(c){return`${c} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fx(c){let t=F.useContext($r);return se(t,Zd(c)),t}function gx(c){let t=F.useContext(_c);return se(t,Zd(c)),t}function px(c){let t=F.useContext(mi);return se(t,Zd(c)),t}function tf(c){let t=px(c),e=t.matches[t.matches.length-1];return se(e.route.id,`${c} can only be used on routes that contain a unique "id"`),e.route.id}function mx(){return tf("useRouteId")}function yx(){let c=F.useContext(Jd),t=gx("useRouteError"),e=tf("useRouteError");return c!==void 0?c:t.errors?.[e]}function bx(){let{router:c}=fx("useNavigate"),t=tf("useNavigate"),e=F.useRef(!1);return cb(()=>{e.current=!0}),F.useCallback(async(r,a={})=>{Ds(e.current,lb),e.current&&(typeof r=="number"?c.navigate(r):await c.navigate(r,{fromRouteId:t,...a}))},[c,t])}var Ky={};function db(c,t,e){!t&&!Ky[c]&&(Ky[c]=!0,Ds(!1,e))}F.memo(vx);function vx({routes:c,future:t,state:e,unstable_onError:s}){return hb(c,void 0,e,s,t)}function Va(c){se(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function wx({basename:c="/",children:t=null,location:e,navigationType:s="POP",navigator:r,static:a=!1}){se(!uo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=c.replace(/^\/*/,"/"),u=F.useMemo(()=>({basename:o,navigator:r,static:a,future:{}}),[o,r,a]);typeof e=="string"&&(e=Hr(e));let{pathname:d="/",search:f="",hash:g="",state:m=null,key:b="default"}=e,v=F.useMemo(()=>{let x=pi(d,o);return x==null?null:{location:{pathname:x,search:f,hash:g,state:m,key:b},navigationType:s}},[o,d,f,g,m,b,s]);return Ds(v!=null,`<Router basename="${o}"> is not able to match the URL "${d}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:F.createElement(qs.Provider,{value:u},F.createElement(co.Provider,{children:t,value:v}))}function _x({children:c,location:t}){return ox(xd(c),t)}function xd(c,t=[]){let e=[];return F.Children.forEach(c,(s,r)=>{if(!F.isValidElement(s))return;let a=[...t,r];if(s.type===F.Fragment){e.push.apply(e,xd(s.props.children,a));return}se(s.type===Va,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),se(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=xd(s.props.children,a)),e.push(o)}),e}var nc="get",rc="application/x-www-form-urlencoded";function Ac(c){return c!=null&&typeof c.tagName=="string"}function Ax(c){return Ac(c)&&c.tagName.toLowerCase()==="button"}function xx(c){return Ac(c)&&c.tagName.toLowerCase()==="form"}function Sx(c){return Ac(c)&&c.tagName.toLowerCase()==="input"}function Ex(c){return!!(c.metaKey||c.altKey||c.ctrlKey||c.shiftKey)}function Tx(c,t){return c.button===0&&(!t||t==="_self")&&!Ex(c)}var Ul=null;function Cx(){if(Ul===null)try{new FormData(document.createElement("form"),0),Ul=!1}catch{Ul=!0}return Ul}var Rx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nd(c){return c!=null&&!Rx.has(c)?(Ds(!1,`"${c}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rc}"`),null):c}function Nx(c,t){let e,s,r,a,o;if(xx(c)){let u=c.getAttribute("action");s=u?pi(u,t):null,e=c.getAttribute("method")||nc,r=nd(c.getAttribute("enctype"))||rc,a=new FormData(c)}else if(Ax(c)||Sx(c)&&(c.type==="submit"||c.type==="image")){let u=c.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=c.getAttribute("formaction")||u.getAttribute("action");if(s=d?pi(d,t):null,e=c.getAttribute("formmethod")||u.getAttribute("method")||nc,r=nd(c.getAttribute("formenctype"))||nd(u.getAttribute("enctype"))||rc,a=new FormData(u,c),!Cx()){let{name:f,type:g,value:m}=c;if(g==="image"){let b=f?`${f}.`:"";a.append(`${b}x`,"0"),a.append(`${b}y`,"0")}else f&&a.append(f,m)}}else{if(Ac(c))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=nc,s=null,r=rc,o=c}return a&&r==="text/plain"&&(o=a,a=void 0),{action:s,method:e.toLowerCase(),encType:r,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ef(c,t){if(c===!1||c===null||typeof c>"u")throw new Error(t)}function Ox(c,t,e){let s=typeof c=="string"?new URL(c,typeof window>"u"?"server://singlefetch/":window.location.origin):c;return s.pathname==="/"?s.pathname=`_root.${e}`:t&&pi(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${e}`,s}async function kx(c,t){if(c.id in t)return t[c.id];try{let e=await import(c.module);return t[c.id]=e,e}catch(e){return console.error(`Error loading route module \`${c.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Dx(c){return c==null?!1:c.href==null?c.rel==="preload"&&typeof c.imageSrcSet=="string"&&typeof c.imageSizes=="string":typeof c.rel=="string"&&typeof c.href=="string"}async function Mx(c,t,e){let s=await Promise.all(c.map(async r=>{let a=t.routes[r.route.id];if(a){let o=await kx(a,e);return o.links?o.links():[]}return[]}));return Bx(s.flat(1).filter(Dx).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Wy(c,t,e,s,r,a){let o=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return a==="assets"?t.filter((d,f)=>o(d,f)||u(d,f)):a==="data"?t.filter((d,f)=>{let g=s.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(o(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let m=d.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(c,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function jx(c,t,{includeHydrateFallback:e}={}){return Lx(c.map(s=>{let r=t.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),e&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function Lx(c){return[...new Set(c)]}function Px(c){let t={},e=Object.keys(c).sort();for(let s of e)t[s]=c[s];return t}function Bx(c,t){let e=new Set;return new Set(t),c.reduce((s,r)=>{let a=JSON.stringify(Px(r));return e.has(a)||(e.add(a),s.push({key:a,link:r})),s},[])}function fb(){let c=F.useContext($r);return ef(c,"You must render this element inside a <DataRouterContext.Provider> element"),c}function Ux(){let c=F.useContext(_c);return ef(c,"You must render this element inside a <DataRouterStateContext.Provider> element"),c}var sf=F.createContext(void 0);sf.displayName="FrameworkContext";function gb(){let c=F.useContext(sf);return ef(c,"You must render this element inside a <HydratedRouter> element"),c}function Ix(c,t){let e=F.useContext(sf),[s,r]=F.useState(!1),[a,o]=F.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:g,onTouchStart:m}=t,b=F.useRef(null);F.useEffect(()=>{if(c==="render"&&o(!0),c==="viewport"){let w=E=>{E.forEach(R=>{o(R.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return b.current&&S.observe(b.current),()=>{S.disconnect()}}},[c]),F.useEffect(()=>{if(s){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[s]);let v=()=>{r(!0)},x=()=>{r(!1),o(!1)};return e?c!=="intent"?[a,b,{}]:[a,b,{onFocus:Fa(u,v),onBlur:Fa(d,x),onMouseEnter:Fa(f,v),onMouseLeave:Fa(g,x),onTouchStart:Fa(m,v)}]:[!1,b,{}]}function Fa(c,t){return e=>{c&&c(e),e.defaultPrevented||t(e)}}function zx({page:c,...t}){let{router:e}=fb(),s=F.useMemo(()=>eb(e.routes,c,e.basename),[e.routes,c,e.basename]);return s?F.createElement(Hx,{page:c,matches:s,...t}):null}function Fx(c){let{manifest:t,routeModules:e}=gb(),[s,r]=F.useState([]);return F.useEffect(()=>{let a=!1;return Mx(c,t,e).then(o=>{a||r(o)}),()=>{a=!0}},[c,t,e]),s}function Hx({page:c,matches:t,...e}){let s=Wi(),{manifest:r,routeModules:a}=gb(),{basename:o}=fb(),{loaderData:u,matches:d}=Ux(),f=F.useMemo(()=>Wy(c,t,d,r,s,"data"),[c,t,d,r,s]),g=F.useMemo(()=>Wy(c,t,d,r,s,"assets"),[c,t,d,r,s]),m=F.useMemo(()=>{if(c===s.pathname+s.search+s.hash)return[];let x=new Set,w=!1;if(t.forEach(E=>{let R=r.routes[E.route.id];!R||!R.hasLoader||(!f.some(T=>T.route.id===E.route.id)&&E.route.id in u&&a[E.route.id]?.shouldRevalidate||R.hasClientLoader?w=!0:x.add(E.route.id))}),x.size===0)return[];let S=Ox(c,o,"data");return w&&x.size>0&&S.searchParams.set("_routes",t.filter(E=>x.has(E.route.id)).map(E=>E.route.id).join(",")),[S.pathname+S.search]},[o,u,s,r,f,t,c,a]),b=F.useMemo(()=>jx(g,r),[g,r]),v=Fx(g);return F.createElement(F.Fragment,null,m.map(x=>F.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...e})),b.map(x=>F.createElement("link",{key:x,rel:"modulepreload",href:x,...e})),v.map(({key:x,link:w})=>F.createElement("link",{key:x,nonce:e.nonce,...w})))}function $x(...c){return t=>{c.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var pb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{pb&&(window.__reactRouterVersion="7.9.6")}catch{}function qx({basename:c,children:t,window:e}){let s=F.useRef();s.current==null&&(s.current=kA({window:e,v5Compat:!0}));let r=s.current,[a,o]=F.useState({action:r.action,location:r.location}),u=F.useCallback(d=>{F.startTransition(()=>o(d))},[o]);return F.useLayoutEffect(()=>r.listen(u),[r,u]),F.createElement(wx,{basename:c,children:t,location:a.location,navigationType:a.action,navigator:r})}var mb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nf=F.forwardRef(function({onClick:t,discover:e="render",prefetch:s="none",relative:r,reloadDocument:a,replace:o,state:u,target:d,to:f,preventScrollReset:g,viewTransition:m,...b},v){let{basename:x}=F.useContext(qs),w=typeof f=="string"&&mb.test(f),S,E=!1;if(typeof f=="string"&&w&&(S=f,pb))try{let X=new URL(window.location.href),et=f.startsWith("//")?new URL(X.protocol+f):new URL(f),Z=pi(et.pathname,x);et.origin===X.origin&&Z!=null?f=Z+et.search+et.hash:E=!0}catch{Ds(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let R=rx(f,{relative:r}),[T,N,D]=Ix(s,b),M=Xx(f,{replace:o,state:u,target:d,preventScrollReset:g,relative:r,viewTransition:m});function L(X){t&&t(X),X.defaultPrevented||M(X)}let G=F.createElement("a",{...b,...D,href:S||R,onClick:E||a?t:L,ref:$x(v,N),target:d,"data-discover":!w&&e==="render"?"true":void 0});return T&&!w?F.createElement(F.Fragment,null,G,F.createElement(zx,{page:R})):G});nf.displayName="Link";var Gx=F.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:s="",end:r=!1,style:a,to:o,viewTransition:u,children:d,...f},g){let m=ho(o,{relative:f.relative}),b=Wi(),v=F.useContext(_c),{navigator:x,basename:w}=F.useContext(qs),S=v!=null&&Zx(m)&&u===!0,E=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,R=b.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(R=R.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&w&&(T=pi(T,w)||T);const N=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let D=R===E||!r&&R.startsWith(E)&&R.charAt(N)==="/",M=T!=null&&(T===E||!r&&T.startsWith(E)&&T.charAt(E.length)==="/"),L={isActive:D,isPending:M,isTransitioning:S},G=D?t:void 0,X;typeof s=="function"?X=s(L):X=[s,D?"active":null,M?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let et=typeof a=="function"?a(L):a;return F.createElement(nf,{...f,"aria-current":G,className:X,ref:g,style:et,to:o,viewTransition:u},typeof d=="function"?d(L):d)});Gx.displayName="NavLink";var Vx=F.forwardRef(({discover:c="render",fetcherKey:t,navigate:e,reloadDocument:s,replace:r,state:a,method:o=nc,action:u,onSubmit:d,relative:f,preventScrollReset:g,viewTransition:m,...b},v)=>{let x=Qx(),w=Jx(u,{relative:f}),S=o.toLowerCase()==="get"?"get":"post",E=typeof u=="string"&&mb.test(u),R=T=>{if(d&&d(T),T.defaultPrevented)return;T.preventDefault();let N=T.nativeEvent.submitter,D=N?.getAttribute("formmethod")||o;x(N||T.currentTarget,{fetcherKey:t,method:D,navigate:e,replace:r,state:a,relative:f,preventScrollReset:g,viewTransition:m})};return F.createElement("form",{ref:v,method:S,action:w,onSubmit:s?d:R,...b,"data-discover":!E&&c==="render"?"true":void 0})});Vx.displayName="Form";function Yx(c){return`${c} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yb(c){let t=F.useContext($r);return se(t,Yx(c)),t}function Xx(c,{target:t,replace:e,state:s,preventScrollReset:r,relative:a,viewTransition:o}={}){let u=ub(),d=Wi(),f=ho(c,{relative:a});return F.useCallback(g=>{if(Tx(g,t)){g.preventDefault();let m=e!==void 0?e:to(d)===to(f);u(c,{replace:m,state:s,preventScrollReset:r,relative:a,viewTransition:o})}},[d,u,f,e,s,t,c,r,a,o])}var Kx=0,Wx=()=>`__${String(++Kx)}__`;function Qx(){let{router:c}=yb("useSubmit"),{basename:t}=F.useContext(qs),e=mx();return F.useCallback(async(s,r={})=>{let{action:a,method:o,encType:u,formData:d,body:f}=Nx(s,t);if(r.navigate===!1){let g=r.fetcherKey||Wx();await c.fetch(g,e,r.action||a,{preventScrollReset:r.preventScrollReset,formData:d,body:f,formMethod:r.method||o,formEncType:r.encType||u,flushSync:r.flushSync})}else await c.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:d,body:f,formMethod:r.method||o,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:e,flushSync:r.flushSync,viewTransition:r.viewTransition})},[c,t,e])}function Jx(c,{relative:t}={}){let{basename:e}=F.useContext(qs),s=F.useContext(mi);se(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={...ho(c||".",{relative:t})},o=Wi();if(c==null){a.search=o.search;let u=new URLSearchParams(a.search),d=u.getAll("index");if(d.some(g=>g==="")){u.delete("index"),d.filter(m=>m).forEach(m=>u.append("index",m));let g=u.toString();a.search=g?`?${g}`:""}}return(!c||c===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:gi([e,a.pathname])),to(a)}function Zx(c,{relative:t}={}){let e=F.useContext(ob);se(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=yb("useViewTransitionState"),r=ho(c,{relative:t});if(!e.isTransitioning)return!1;let a=pi(e.currentLocation.pathname,s)||e.currentLocation.pathname,o=pi(e.nextLocation.pathname,s)||e.nextLocation.pathname;return cc(r.pathname,o)!=null||cc(r.pathname,a)!=null}const tS=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eS=c=>c.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,s)=>s?s.toUpperCase():e.toLowerCase()),Qy=c=>{const t=eS(c);return t.charAt(0).toUpperCase()+t.slice(1)},bb=(...c)=>c.filter((t,e,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===e).join(" ").trim(),sS=c=>{for(const t in c)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var iS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nS=F.forwardRef(({color:c="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:s,className:r="",children:a,iconNode:o,...u},d)=>F.createElement("svg",{ref:d,...iS,width:t,height:t,stroke:c,strokeWidth:s?Number(e)*24/Number(t):e,className:bb("lucide",r),...!a&&!sS(u)&&{"aria-hidden":"true"},...u},[...o.map(([f,g])=>F.createElement(f,g)),...Array.isArray(a)?a:[a]]));const Wt=(c,t)=>{const e=F.forwardRef(({className:s,...r},a)=>F.createElement(nS,{ref:a,iconNode:t,className:bb(`lucide-${tS(Qy(c))}`,`lucide-${c}`,s),...r}));return e.displayName=Qy(c),e};const rS=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Sd=Wt("building-2",rS);const aS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],oS=Wt("chart-column",aS);const lS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Yi=Wt("check",lS);const cS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],vb=Wt("chevron-down",cS);const uS=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wb=Wt("chevron-up",uS);const hS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ir=Wt("clock",hS);const dS=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],rf=Wt("credit-card",dS);const fS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Sr=Wt("dollar-sign",fS);const gS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_b=Wt("eye",gS);const pS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ab=Wt("file-text",pS);const mS=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],af=Wt("funnel",mS);const yS=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],bS=Wt("house",yS);const vS=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],wS=Wt("image",vS);const _S=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],AS=Wt("mail",_S);const xS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],uc=Wt("package",xS);const SS=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ES=Wt("phone",SS);const TS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],of=Wt("search",TS);const CS=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],RS=Wt("shopping-bag",CS);const NS=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],OS=Wt("shopping-cart",NS);const kS=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],xb=Wt("trending-up",kS);const DS=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Jy=Wt("user-check",DS);const MS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],jS=Wt("user-plus",MS);const LS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Zy=Wt("user",LS);const PS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],hc=Wt("users",PS);const BS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Or=Wt("x",BS);function US(){const c=Wi(),t=[{name:"Dashboard",path:"/",icon:bS},{name:"Products",path:"/products",icon:uc},{name:"Users",path:"/users",icon:hc},{name:"Payments",path:"/payments",icon:rf}];return _.jsxs("aside",{className:"w-64 bg-gradient-to-b from-[#58C1D1] to-[#4AA8B8] p-6 flex flex-col gap-2",children:[_.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:_.jsx(oS,{className:"text-white",size:24})}),_.jsx("span",{className:"text-white font-bold text-xl",children:"Admin Panel"})]}),_.jsx("nav",{className:"flex flex-col gap-1",children:t.map(e=>{const s=e.icon,r=c.pathname===e.path;return _.jsxs(nf,{to:e.path,className:`
                                flex items-center gap-3 px-4 py-3 rounded-lg
                                transition-all duration-200
                                ${r?"bg-white text-[#58C1D1] shadow-lg font-semibold":"text-white hover:bg-white/10"}
                            `,children:[_.jsx(s,{size:20}),_.jsx("span",{className:"font-medium",children:e.name})]},e.name)})}),_.jsx("div",{className:"mt-auto pt-6 border-t border-white/20",children:_.jsxs("div",{className:"text-white/90 text-sm",children:[_.jsx("p",{className:"font-medium",children:"Admin User"}),_.jsx("p",{className:"text-white/70 text-xs mt-0.5",children:"admin@example.com"})]})})]})}function xc({children:c}){return _.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[_.jsx(US,{}),_.jsx("div",{className:"flex-1 flex flex-col",children:_.jsx("main",{className:"p-6",children:c})})]})}var Ed=function(c,t){return Ed=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])},Ed(c,t)};function Sb(c,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ed(c,t);function e(){this.constructor=c}c.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var dc=function(){return dc=Object.assign||function(t){for(var e,s=1,r=arguments.length;s<r;s++){e=arguments[s];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},dc.apply(this,arguments)};function qr(c,t){var e={};for(var s in c)Object.prototype.hasOwnProperty.call(c,s)&&t.indexOf(s)<0&&(e[s]=c[s]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(c);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(c,s[r])&&(e[s[r]]=c[s[r]]);return e}function Eb(c,t,e,s){var r=arguments.length,a=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(c,t,e,s);else for(var u=c.length-1;u>=0;u--)(o=c[u])&&(a=(r<3?o(a):r>3?o(t,e,a):o(t,e))||a);return r>3&&a&&Object.defineProperty(t,e,a),a}function Tb(c,t){return function(e,s){t(e,s,c)}}function Cb(c,t,e,s,r,a){function o(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var u=s.kind,d=u==="getter"?"get":u==="setter"?"set":"value",f=!t&&c?s.static?c:c.prototype:null,g=t||(f?Object.getOwnPropertyDescriptor(f,s.name):{}),m,b=!1,v=e.length-1;v>=0;v--){var x={};for(var w in s)x[w]=w==="access"?{}:s[w];for(var w in s.access)x.access[w]=s.access[w];x.addInitializer=function(E){if(b)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(E||null))};var S=(0,e[v])(u==="accessor"?{get:g.get,set:g.set}:g[d],x);if(u==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(m=o(S.get))&&(g.get=m),(m=o(S.set))&&(g.set=m),(m=o(S.init))&&r.unshift(m)}else(m=o(S))&&(u==="field"?r.unshift(m):g[d]=m)}f&&Object.defineProperty(f,s.name,g),b=!0}function Rb(c,t,e){for(var s=arguments.length>2,r=0;r<t.length;r++)e=s?t[r].call(c,e):t[r].call(c);return s?e:void 0}function Nb(c){return typeof c=="symbol"?c:"".concat(c)}function Ob(c,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(c,"name",{configurable:!0,value:e?"".concat(e," ",t):t})}function kb(c,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,t)}function lt(c,t,e,s){function r(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function u(g){try{f(s.next(g))}catch(m){o(m)}}function d(g){try{f(s.throw(g))}catch(m){o(m)}}function f(g){g.done?a(g.value):r(g.value).then(u,d)}f((s=s.apply(c,t||[])).next())})}function Db(c,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,r,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(f){return function(g){return d([f,g])}}function d(f){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,f[0]&&(e=0)),e;)try{if(s=1,r&&(a=f[0]&2?r.return:f[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,f[1])).done)return a;switch(r=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,r=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){e.label=f[1];break}if(f[0]===6&&e.label<a[1]){e.label=a[1],a=f;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(f);break}a[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(c,e)}catch(g){f=[6,g],r=0}finally{s=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Sc=Object.create?(function(c,t,e,s){s===void 0&&(s=e);var r=Object.getOwnPropertyDescriptor(t,e);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(c,s,r)}):(function(c,t,e,s){s===void 0&&(s=e),c[s]=t[e]});function Mb(c,t){for(var e in c)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Sc(t,c,e)}function fc(c){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&c[t],s=0;if(e)return e.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&s>=c.length&&(c=void 0),{value:c&&c[s++],done:!c}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function lf(c,t){var e=typeof Symbol=="function"&&c[Symbol.iterator];if(!e)return c;var s=e.call(c),r,a=[],o;try{for(;(t===void 0||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(u){o={error:u}}finally{try{r&&!r.done&&(e=s.return)&&e.call(s)}finally{if(o)throw o.error}}return a}function jb(){for(var c=[],t=0;t<arguments.length;t++)c=c.concat(lf(arguments[t]));return c}function Lb(){for(var c=0,t=0,e=arguments.length;t<e;t++)c+=arguments[t].length;for(var s=Array(c),r=0,t=0;t<e;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,r++)s[r]=a[o];return s}function Pb(c,t,e){if(e||arguments.length===2)for(var s=0,r=t.length,a;s<r;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return c.concat(a||Array.prototype.slice.call(t))}function zr(c){return this instanceof zr?(this.v=c,this):new zr(c)}function Bb(c,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(c,t||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(v){return function(x){return Promise.resolve(x).then(v,m)}}function u(v,x){s[v]&&(r[v]=function(w){return new Promise(function(S,E){a.push([v,w,S,E])>1||d(v,w)})},x&&(r[v]=x(r[v])))}function d(v,x){try{f(s[v](x))}catch(w){b(a[0][3],w)}}function f(v){v.value instanceof zr?Promise.resolve(v.value.v).then(g,m):b(a[0][2],v)}function g(v){d("next",v)}function m(v){d("throw",v)}function b(v,x){v(x),a.shift(),a.length&&d(a[0][0],a[0][1])}}function Ub(c){var t,e;return t={},s("next"),s("throw",function(r){throw r}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(r,a){t[r]=c[r]?function(o){return(e=!e)?{value:zr(c[r](o)),done:!1}:a?a(o):o}:a}}function Ib(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=c[Symbol.asyncIterator],e;return t?t.call(c):(c=typeof fc=="function"?fc(c):c[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(a){e[a]=c[a]&&function(o){return new Promise(function(u,d){o=c[a](o),r(u,d,o.done,o.value)})}}function r(a,o,u,d){Promise.resolve(d).then(function(f){a({value:f,done:u})},o)}}function zb(c,t){return Object.defineProperty?Object.defineProperty(c,"raw",{value:t}):c.raw=t,c}var IS=Object.create?(function(c,t){Object.defineProperty(c,"default",{enumerable:!0,value:t})}):function(c,t){c.default=t},Td=function(c){return Td=Object.getOwnPropertyNames||function(t){var e=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[e.length]=s);return e},Td(c)};function Fb(c){if(c&&c.__esModule)return c;var t={};if(c!=null)for(var e=Td(c),s=0;s<e.length;s++)e[s]!=="default"&&Sc(t,c,e[s]);return IS(t,c),t}function Hb(c){return c&&c.__esModule?c:{default:c}}function $b(c,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?c!==t||!s:!t.has(c))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(c):s?s.value:t.get(c)}function qb(c,t,e,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?c!==t||!r:!t.has(c))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(c,e):r?r.value=e:t.set(c,e),e}function Gb(c,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof c=="function"?t===c:c.has(t)}function Vb(c,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,r;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],e&&(r=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");r&&(s=function(){try{r.call(this)}catch(a){return Promise.reject(a)}}),c.stack.push({value:t,dispose:s,async:e})}else e&&c.stack.push({async:!0});return t}var zS=typeof SuppressedError=="function"?SuppressedError:function(c,t,e){var s=new Error(e);return s.name="SuppressedError",s.error=c,s.suppressed=t,s};function Yb(c){function t(a){c.error=c.hasError?new zS(a,c.error,"An error was suppressed during disposal."):a,c.hasError=!0}var e,s=0;function r(){for(;e=c.stack.pop();)try{if(!e.async&&s===1)return s=0,c.stack.push(e),Promise.resolve().then(r);if(e.dispose){var a=e.dispose.call(e.value);if(e.async)return s|=2,Promise.resolve(a).then(r,function(o){return t(o),r()})}else s|=1}catch(o){t(o)}if(s===1)return c.hasError?Promise.reject(c.error):Promise.resolve();if(c.hasError)throw c.error}return r()}function Xb(c,t){return typeof c=="string"&&/^\.\.?\//.test(c)?c.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,s,r,a,o){return s?t?".jsx":".js":r&&(!a||!o)?e:r+a+"."+o.toLowerCase()+"js"}):c}const FS={__extends:Sb,__assign:dc,__rest:qr,__decorate:Eb,__param:Tb,__esDecorate:Cb,__runInitializers:Rb,__propKey:Nb,__setFunctionName:Ob,__metadata:kb,__awaiter:lt,__generator:Db,__createBinding:Sc,__exportStar:Mb,__values:fc,__read:lf,__spread:jb,__spreadArrays:Lb,__spreadArray:Pb,__await:zr,__asyncGenerator:Bb,__asyncDelegator:Ub,__asyncValues:Ib,__makeTemplateObject:zb,__importStar:Fb,__importDefault:Hb,__classPrivateFieldGet:$b,__classPrivateFieldSet:qb,__classPrivateFieldIn:Gb,__addDisposableResource:Vb,__disposeResources:Yb,__rewriteRelativeImportExtension:Xb},HS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Vb,get __assign(){return dc},__asyncDelegator:Ub,__asyncGenerator:Bb,__asyncValues:Ib,__await:zr,__awaiter:lt,__classPrivateFieldGet:$b,__classPrivateFieldIn:Gb,__classPrivateFieldSet:qb,__createBinding:Sc,__decorate:Eb,__disposeResources:Yb,__esDecorate:Cb,__exportStar:Mb,__extends:Sb,__generator:Db,__importDefault:Hb,__importStar:Fb,__makeTemplateObject:zb,__metadata:kb,__param:Tb,__propKey:Nb,__read:lf,__rest:qr,__rewriteRelativeImportExtension:Xb,__runInitializers:Rb,__setFunctionName:Ob,__spread:jb,__spreadArray:Pb,__spreadArrays:Lb,__values:fc,default:FS},Symbol.toStringTag,{value:"Module"})),$S=c=>c?(...t)=>c(...t):(...t)=>fetch(...t);class cf extends Error{constructor(t,e="FunctionsError",s){super(t),this.name=e,this.context=s}}class qS extends cf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class t0 extends cf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class e0 extends cf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Cd;(function(c){c.Any="any",c.ApNortheast1="ap-northeast-1",c.ApNortheast2="ap-northeast-2",c.ApSouth1="ap-south-1",c.ApSoutheast1="ap-southeast-1",c.ApSoutheast2="ap-southeast-2",c.CaCentral1="ca-central-1",c.EuCentral1="eu-central-1",c.EuWest1="eu-west-1",c.EuWest2="eu-west-2",c.EuWest3="eu-west-3",c.SaEast1="sa-east-1",c.UsEast1="us-east-1",c.UsWest1="us-west-1",c.UsWest2="us-west-2"})(Cd||(Cd={}));class GS{constructor(t,{headers:e={},customFetch:s,region:r=Cd.Any}={}){this.url=t,this.headers=e,this.region=r,this.fetch=$S(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return lt(this,arguments,void 0,function*(e,s={}){var r;let a,o;try{const{headers:u,method:d,body:f,signal:g,timeout:m}=s;let b={},{region:v}=s;v||(v=this.region);const x=new URL(`${this.url}/${e}`);v&&v!=="any"&&(b["x-region"]=v,x.searchParams.set("forceFunctionRegion",v));let w;f&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",w=f):typeof f=="string"?(b["Content-Type"]="text/plain",w=f):typeof FormData<"u"&&f instanceof FormData?w=f:(b["Content-Type"]="application/json",w=JSON.stringify(f)):w=f;let S=g;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),g?(S=o.signal,g.addEventListener("abort",()=>o.abort())):S=o.signal);const E=yield this.fetch(x.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),u),body:w,signal:S}).catch(D=>{throw new qS(D)}),R=E.headers.get("x-relay-error");if(R&&R==="true")throw new t0(E);if(!E.ok)throw new e0(E);let T=((r=E.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),N;return T==="application/json"?N=yield E.json():T==="application/octet-stream"||T==="application/pdf"?N=yield E.blob():T==="text/event-stream"?N=E:T==="multipart/form-data"?N=yield E.formData():N=yield E.text(),{data:N,error:null,response:E}}catch(u){return{data:null,error:u,response:u instanceof e0||u instanceof t0?u.context:void 0}}finally{a&&clearTimeout(a)}})}}var je={};const Gr=wA(HS);var Il={},zl={},Fl={},Hl={},$l={},ql={},s0;function Kb(){if(s0)return ql;s0=1,Object.defineProperty(ql,"__esModule",{value:!0});class c extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return ql.default=c,ql}var i0;function Wb(){if(i0)return $l;i0=1,Object.defineProperty($l,"__esModule",{value:!0});const t=Gr.__importDefault(Kb());class e{constructor(r){var a,o;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(a=r.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=r.signal,this.isMaybeSingle=(o=r.isMaybeSingle)!==null&&o!==void 0?o:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,a){return this.headers=new Headers(this.headers),this.headers.set(r,a),this}then(r,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let u=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var f,g,m,b;let v=null,x=null,w=null,S=d.status,E=d.statusText;if(d.ok){if(this.method!=="HEAD"){const D=await d.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?x=D:x=JSON.parse(D))}const T=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),N=(m=d.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");T&&N&&N.length>1&&(w=parseInt(N[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(v={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,w=null,S=406,E="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const T=await d.text();try{v=JSON.parse(T),Array.isArray(v)&&d.status===404&&(x=[],v=null,S=200,E="OK")}catch{d.status===404&&T===""?(S=204,E="No Content"):v={message:T}}if(v&&this.isMaybeSingle&&(!((b=v?.details)===null||b===void 0)&&b.includes("0 rows"))&&(v=null,S=200,E="OK"),v&&this.shouldThrowOnError)throw new t.default(v)}return{error:v,data:x,count:w,status:S,statusText:E}});return this.shouldThrowOnError||(u=u.catch(d=>{var f,g,m,b,v,x;let w="";const S=d?.cause;if(S){const E=(f=S?.message)!==null&&f!==void 0?f:"",R=(g=S?.code)!==null&&g!==void 0?g:"";w=`${(m=d?.name)!==null&&m!==void 0?m:"FetchError"}: ${d?.message}`,w+=`

Caused by: ${(b=S?.name)!==null&&b!==void 0?b:"Error"}: ${E}`,R&&(w+=` (${R})`),S?.stack&&(w+=`
${S.stack}`)}else w=(v=d?.stack)!==null&&v!==void 0?v:"";return{error:{message:`${(x=d?.name)!==null&&x!==void 0?x:"FetchError"}: ${d?.message}`,details:w,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),u.then(r,a)}returns(){return this}overrideTypes(){return this}}return $l.default=e,$l}var n0;function Qb(){if(n0)return Hl;n0=1,Object.defineProperty(Hl,"__esModule",{value:!0});const t=Gr.__importDefault(Wb());class e extends t.default{select(r){let a=!1;const o=(r??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:a=!0,nullsFirst:o,foreignTable:u,referencedTable:d=u}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${r}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:o=a}={}){const u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${r}`),this}range(r,a,{foreignTable:o,referencedTable:u=o}={}){const d=typeof u>"u"?"offset":`${u}.offset`,f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(d,`${r}`),this.url.searchParams.set(f,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:a=!1,settings:o=!1,buffers:u=!1,wal:d=!1,format:f="text"}={}){var g;const m=[r?"analyze":null,a?"verbose":null,o?"settings":null,u?"buffers":null,d?"wal":null].filter(Boolean).join("|"),b=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${b}"; options=${m};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return Hl.default=e,Hl}var r0;function uf(){if(r0)return Fl;r0=1,Object.defineProperty(Fl,"__esModule",{value:!0});const t=Gr.__importDefault(Qb()),e=new RegExp("[,()]");class s extends t.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}regexMatch(a,o){return this.url.searchParams.append(a,`match.${o}`),this}regexIMatch(a,o){return this.url.searchParams.append(a,`imatch.${o}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}isDistinct(a,o){return this.url.searchParams.append(a,`isdistinct.${o}`),this}in(a,o){const u=Array.from(new Set(o)).map(d=>typeof d=="string"&&e.test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${u})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:u,type:d}={}){let f="";d==="plain"?f="pl":d==="phrase"?f="ph":d==="websearch"&&(f="w");const g=u===void 0?"":`(${u})`;return this.url.searchParams.append(a,`${f}fts${g}.${o}`),this}match(a){return Object.entries(a).forEach(([o,u])=>{this.url.searchParams.append(o,`eq.${u}`)}),this}not(a,o,u){return this.url.searchParams.append(a,`not.${o}.${u}`),this}or(a,{foreignTable:o,referencedTable:u=o}={}){const d=u?`${u}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,o,u){return this.url.searchParams.append(a,`${o}.${u}`),this}}return Fl.default=s,Fl}var a0;function Jb(){if(a0)return zl;a0=1,Object.defineProperty(zl,"__esModule",{value:!0});const t=Gr.__importDefault(uf());class e{constructor(r,{headers:a={},schema:o,fetch:u}){this.url=r,this.headers=new Headers(a),this.schema=o,this.fetch=u}select(r,a){const{head:o=!1,count:u}=a??{},d=o?"HEAD":"GET";let f=!1;const g=(r??"*").split("").map(m=>/\s/.test(m)&&!f?"":(m==='"'&&(f=!f),m)).join("");return this.url.searchParams.set("select",g),u&&this.headers.append("Prefer",`count=${u}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:a,defaultToNull:o=!0}={}){var u;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const f=r.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(f.length>0){const g=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(r,{onConflict:a,ignoreDuplicates:o=!1,count:u,defaultToNull:d=!0}={}){var f;const g="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),u&&this.headers.append("Prefer",`count=${u}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((b,v)=>b.concat(Object.keys(v)),[]);if(m.length>0){const b=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",b.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(r,{count:a}={}){var o;const u="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:r}={}){var a;const o="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return zl.default=e,zl}var o0;function VS(){if(o0)return Il;o0=1,Object.defineProperty(Il,"__esModule",{value:!0});const c=Gr,t=c.__importDefault(Jb()),e=c.__importDefault(uf());class s{constructor(a,{headers:o={},schema:u,fetch:d}={}){this.url=a,this.headers=new Headers(o),this.schemaName=u,this.fetch=d}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:u=!1,get:d=!1,count:f}={}){var g;let m;const b=new URL(`${this.url}/rpc/${a}`);let v;u||d?(m=u?"HEAD":"GET",Object.entries(o).filter(([w,S])=>S!==void 0).map(([w,S])=>[w,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([w,S])=>{b.searchParams.append(w,S)})):(m="POST",v=o);const x=new Headers(this.headers);return f&&x.set("Prefer",`count=${f}`),new e.default({method:m,url:b,headers:x,schema:this.schemaName,body:v,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return Il.default=s,Il}var l0;function YS(){if(l0)return je;l0=1,Object.defineProperty(je,"__esModule",{value:!0}),je.PostgrestError=je.PostgrestBuilder=je.PostgrestTransformBuilder=je.PostgrestFilterBuilder=je.PostgrestQueryBuilder=je.PostgrestClient=void 0;const c=Gr,t=c.__importDefault(VS());je.PostgrestClient=t.default;const e=c.__importDefault(Jb());je.PostgrestQueryBuilder=e.default;const s=c.__importDefault(uf());je.PostgrestFilterBuilder=s.default;const r=c.__importDefault(Qb());je.PostgrestTransformBuilder=r.default;const a=c.__importDefault(Wb());je.PostgrestBuilder=a.default;const o=c.__importDefault(Kb());return je.PostgrestError=o.default,je.default={PostgrestClient:t.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:a.default,PostgrestError:o.default},je}var Zb=YS();const tv=vA(Zb),XS=bA({__proto__:null,default:tv},[Zb]),{PostgrestClient:KS,PostgrestQueryBuilder:dR,PostgrestFilterBuilder:fR,PostgrestTransformBuilder:gR,PostgrestBuilder:pR,PostgrestError:mR}=tv||XS;class WS{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const s=e.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){const s=this.getWebSocketConstructor();return new s(t,e)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const QS="2.84.0",JS=`realtime-js/${QS}`,ev="1.0.0",ZS="2.0.0",c0=ev,Rd=1e4,t1=1e3,e1=100;var An;(function(c){c[c.connecting=0]="connecting",c[c.open=1]="open",c[c.closing=2]="closing",c[c.closed=3]="closed"})(An||(An={}));var ve;(function(c){c.closed="closed",c.errored="errored",c.joined="joined",c.joining="joining",c.leaving="leaving"})(ve||(ve={}));var ks;(function(c){c.close="phx_close",c.error="phx_error",c.join="phx_join",c.reply="phx_reply",c.leave="phx_leave",c.access_token="access_token"})(ks||(ks={}));var Nd;(function(c){c.websocket="websocket"})(Nd||(Nd={}));var xn;(function(c){c.Connecting="connecting",c.Open="open",c.Closing="closing",c.Closed="closed"})(xn||(xn={}));class s1{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,e){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return e(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var e;return this._isArrayBuffer((e=t.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var e,s,r,a;const o=t.topic,u=(e=t.ref)!==null&&e!==void 0?e:"",d=(s=t.join_ref)!==null&&s!==void 0?s:"",f=t.payload.event,g=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+o.length+f.length,b=new ArrayBuffer(this.HEADER_LENGTH+m);let v=new DataView(b),x=0;v.setUint8(x++,this.KINDS.userBroadcastPush),v.setUint8(x++,d.length),v.setUint8(x++,u.length),v.setUint8(x++,o.length),v.setUint8(x++,f.length),v.setUint8(x++,this.BINARY_ENCODING),Array.from(d,S=>v.setUint8(x++,S.charCodeAt(0))),Array.from(u,S=>v.setUint8(x++,S.charCodeAt(0))),Array.from(o,S=>v.setUint8(x++,S.charCodeAt(0))),Array.from(f,S=>v.setUint8(x++,S.charCodeAt(0)));var w=new Uint8Array(b.byteLength+g.byteLength);return w.set(new Uint8Array(b),0),w.set(new Uint8Array(g),b.byteLength),w.buffer}_encodeJsonUserBroadcastPush(t){var e,s,r,a;const o=t.topic,u=(e=t.ref)!==null&&e!==void 0?e:"",d=(s=t.join_ref)!==null&&s!==void 0?s:"",f=t.payload.event,g=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},b=new TextEncoder().encode(JSON.stringify(g)).buffer,v=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+o.length+f.length,x=new ArrayBuffer(this.HEADER_LENGTH+v);let w=new DataView(x),S=0;w.setUint8(S++,this.KINDS.userBroadcastPush),w.setUint8(S++,d.length),w.setUint8(S++,u.length),w.setUint8(S++,o.length),w.setUint8(S++,f.length),w.setUint8(S++,this.JSON_ENCODING),Array.from(d,R=>w.setUint8(S++,R.charCodeAt(0))),Array.from(u,R=>w.setUint8(S++,R.charCodeAt(0))),Array.from(o,R=>w.setUint8(S++,R.charCodeAt(0))),Array.from(f,R=>w.setUint8(S++,R.charCodeAt(0)));var E=new Uint8Array(x.byteLength+b.byteLength);return E.set(new Uint8Array(x),0),E.set(new Uint8Array(b),x.byteLength),E.buffer}decode(t,e){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return e(s)}if(typeof t=="string"){const s=JSON.parse(t),[r,a,o,u,d]=s;return e({join_ref:r,ref:a,topic:o,event:u,payload:d})}return e({})}_binaryDecode(t){const e=new DataView(t),s=e.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,e,r)}}_decodeUserBroadcast(t,e,s){const r=e.getUint8(1),a=e.getUint8(2),o=e.getUint8(3),u=e.getUint8(4);let d=this.HEADER_LENGTH+4;const f=s.decode(t.slice(d,d+r));d=d+r;const g=s.decode(t.slice(d,d+a));d=d+a;const m=s.decode(t.slice(d,d+o));d=d+o;const b=t.slice(d,t.byteLength),v=u===this.JSON_ENCODING?JSON.parse(s.decode(b)):b,x={type:this.BROADCAST_EVENT,event:g,payload:v};return o>0&&(x.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var e;return t instanceof ArrayBuffer||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}}class sv{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Yt;(function(c){c.abstime="abstime",c.bool="bool",c.date="date",c.daterange="daterange",c.float4="float4",c.float8="float8",c.int2="int2",c.int4="int4",c.int4range="int4range",c.int8="int8",c.int8range="int8range",c.json="json",c.jsonb="jsonb",c.money="money",c.numeric="numeric",c.oid="oid",c.reltime="reltime",c.text="text",c.time="time",c.timestamp="timestamp",c.timestamptz="timestamptz",c.timetz="timetz",c.tsrange="tsrange",c.tstzrange="tstzrange"})(Yt||(Yt={}));const u0=(c,t,e={})=>{var s;const r=(s=e.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=i1(o,c,t,r),a),{}):{}},i1=(c,t,e,s)=>{const r=t.find(u=>u.name===c),a=r?.type,o=e[c];return a&&!s.includes(a)?iv(a,o):Od(o)},iv=(c,t)=>{if(c.charAt(0)==="_"){const e=c.slice(1,c.length);return o1(t,e)}switch(c){case Yt.bool:return n1(t);case Yt.float4:case Yt.float8:case Yt.int2:case Yt.int4:case Yt.int8:case Yt.numeric:case Yt.oid:return r1(t);case Yt.json:case Yt.jsonb:return a1(t);case Yt.timestamp:return l1(t);case Yt.abstime:case Yt.date:case Yt.daterange:case Yt.int4range:case Yt.int8range:case Yt.money:case Yt.reltime:case Yt.text:case Yt.time:case Yt.timestamptz:case Yt.timetz:case Yt.tsrange:case Yt.tstzrange:return Od(t);default:return Od(t)}},Od=c=>c,n1=c=>{switch(c){case"t":return!0;case"f":return!1;default:return c}},r1=c=>{if(typeof c=="string"){const t=parseFloat(c);if(!Number.isNaN(t))return t}return c},a1=c=>{if(typeof c=="string")try{return JSON.parse(c)}catch(t){return console.log(`JSON parse error: ${t}`),c}return c},o1=(c,t)=>{if(typeof c!="string")return c;const e=c.length-1,s=c[e];if(c[0]==="{"&&s==="}"){let a;const o=c.slice(1,e);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(u=>iv(t,u))}return c},l1=c=>typeof c=="string"?c.replace(" ","T"):c,nv=c=>{const t=new URL(c);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class rd{constructor(t,e,s={},r=Rd){this.channel=t,this.event=e,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var s;return this._hasReceived(t)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var h0;(function(c){c.SYNC="sync",c.JOIN="join",c.LEAVE="leave"})(h0||(h0={}));class Qa{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qa.syncState(this.state,r,a,o),this.pendingDiffs.forEach(d=>{this.state=Qa.syncDiff(this.state,d,a,o)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},r=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Qa.syncDiff(this.state,r,a,o),u())}),this.onJoin((r,a,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:o})}),this.onLeave((r,a,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,s,r){const a=this.cloneDeep(t),o=this.transformState(e),u={},d={};return this.map(a,(f,g)=>{o[f]||(d[f]=g)}),this.map(o,(f,g)=>{const m=a[f];if(m){const b=g.map(S=>S.presence_ref),v=m.map(S=>S.presence_ref),x=g.filter(S=>v.indexOf(S.presence_ref)<0),w=m.filter(S=>b.indexOf(S.presence_ref)<0);x.length>0&&(u[f]=x),w.length>0&&(d[f]=w)}else u[f]=g}),this.syncDiff(a,{joins:u,leaves:d},s,r)}static syncDiff(t,e,s,r){const{joins:a,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,(u,d)=>{var f;const g=(f=t[u])!==null&&f!==void 0?f:[];if(t[u]=this.cloneDeep(d),g.length>0){const m=t[u].map(v=>v.presence_ref),b=g.filter(v=>m.indexOf(v.presence_ref)<0);t[u].unshift(...b)}s(u,g,d)}),this.map(o,(u,d)=>{let f=t[u];if(!f)return;const g=d.map(m=>m.presence_ref);f=f.filter(m=>g.indexOf(m.presence_ref)<0),t[u]=f,r(u,f,d),f.length===0&&delete t[u]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(s=>e(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,s)=>{const r=t[s];return"metas"in r?e[s]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):e[s]=r,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var d0;(function(c){c.ALL="*",c.INSERT="INSERT",c.UPDATE="UPDATE",c.DELETE="DELETE"})(d0||(d0={}));var Ja;(function(c){c.BROADCAST="broadcast",c.PRESENCE="presence",c.POSTGRES_CHANGES="postgres_changes",c.SYSTEM="system"})(Ja||(Ja={}));var hi;(function(c){c.SUBSCRIBED="SUBSCRIBED",c.TIMED_OUT="TIMED_OUT",c.CLOSED="CLOSED",c.CHANNEL_ERROR="CHANNEL_ERROR"})(hi||(hi={}));class hf{constructor(t,e={config:{}},s){var r,a;if(this.topic=t,this.params=e,this.socket=s,this.bindings={},this.state=ve.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new rd(this,ks.join,this.params,this.timeout),this.rejoinTimer=new sv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ve.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ve.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ve.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ks.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new Qa(this),this.broadcastEndpointURL=nv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var s,r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ve.closed){const{config:{broadcast:o,presence:u,private:d}}=this.params,f=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(v=>v.filter))!==null&&r!==void 0?r:[],g=!!this.bindings[Ja.PRESENCE]&&this.bindings[Ja.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},b={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>t?.(hi.CHANNEL_ERROR,v)),this._onClose(()=>t?.(hi.CLOSED)),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:v})=>{var x;if(this.socket.setAuth(),v===void 0){t?.(hi.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(x=w?.length)!==null&&x!==void 0?x:0,E=[];for(let R=0;R<S;R++){const T=w[R],{filter:{event:N,schema:D,table:M,filter:L}}=T,G=v&&v[R];if(G&&G.event===N&&G.schema===D&&G.table===M&&G.filter===L)E.push(Object.assign(Object.assign({},T),{id:G.id}));else{this.unsubscribe(),this.state=ve.errored,t?.(hi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(hi.SUBSCRIBED);return}}).receive("error",v=>{this.state=ve.errored,t?.(hi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t?.(hi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,s){return this.state===ve.joined&&t===Ja.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,s)}async httpSend(t,e,s={}){var r;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(t,e={}){var s,r;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=e.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=f.body)===null||r===void 0?void 0:r.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,u,d;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ve.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ks.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new rd(this,ks.leave,{},t),s.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ve.closed,this.bindings={}}async _fetchWithTimeout(t,e,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(a),o}_push(t,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new rd(this,t,e,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>e1){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,s){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,s){var r,a;const o=t.toLocaleLowerCase(),{close:u,error:d,leave:f,join:g}=ks;if(s&&[u,d,f,g].indexOf(o)>=0&&s!==this._joinRef())return;let b=this._onMessage(o,e,s);if(e&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(v=>{var x,w,S;return((x=v.filter)===null||x===void 0?void 0:x.event)==="*"||((S=(w=v.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(v=>v.callback(b,s)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var x,w,S,E,R,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const N=v.id,D=(x=v.filter)===null||x===void 0?void 0:x.event;return N&&((w=e.ids)===null||w===void 0?void 0:w.includes(N))&&(D==="*"||D?.toLocaleLowerCase()===((S=e.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const N=(R=(E=v?.filter)===null||E===void 0?void 0:E.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return N==="*"||N===((T=e?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof b=="object"&&"ids"in b){const x=b.data,{schema:w,table:S,commit_timestamp:E,type:R,errors:T}=x;b=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:E,eventType:R,new:{},old:{},errors:T}),this._getPayloadRecords(x))}v.callback(b,s)})}_isClosed(){return this.state===ve.closed}_isJoined(){return this.state===ve.joined}_isJoining(){return this.state===ve.joining}_isLeaving(){return this.state===ve.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,s){const r=t.toLocaleLowerCase(),a={type:r,filter:e,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(t,e){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&hf.isEqual(r.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ks.close,{},t)}_onError(t){this._on(ks.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ve.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=u0(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=u0(t.columns,t.old_record)),e}}const ad=()=>{},Gl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},c1=[1e3,2e3,5e3,1e4],u1=1e4,h1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class d1{constructor(t,e){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Rd,this.transport=null,this.heartbeatIntervalMs=Gl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ad,this.ref=0,this.reconnectTimer=null,this.vsn=c0,this.logger=ad,this.conn=null,this.sendBuffer=[],this.serializer=new s1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),!(!((s=e?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${Nd.websocket}`,this.httpEndpoint=nv(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,s){this.logger(t,e,s)}connectionState(){switch(this.conn&&this.conn.readyState){case An.connecting:return xn.Connecting;case An.open:return xn.Open;case An.closing:return xn.Closing;default:return xn.Closed}}isConnected(){return this.connectionState()===xn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){const s=`realtime:${t}`,r=this.getChannels().find(a=>a.topic===s);if(r)return r;{const a=new hf(`realtime:${t}`,e,this);return this.channels.push(a),a}}push(t){const{topic:e,event:s,payload:r,ref:a}=t,o=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${e} ${s} (${a})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(t1,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Gl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:a,ref:o}=e,u=o?`(${o})`:"",d=a.status||"";this.log("receive",`${d} ${s} ${r} ${u}`.trim(),a),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(r,a,o)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===An.open||this.conn.readyState===An.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ks.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const s=t.match(/\?/)?"&":"?",r=new URLSearchParams(e);return`${t}${s}${r}`}_workerObjectUrl(t){let e;if(t)e=t;else{const s=new Blob([h1],{type:"application/javascript"});e=URL.createObjectURL(s)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e;t?e=t:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(s=>{const r={access_token:e,version:JS};e&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(ks.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(e)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new sv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Gl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var e,s,r,a,o,u,d,f,g,m,b,v;switch(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:Rd,this.heartbeatIntervalMs=(r=t?.heartbeatIntervalMs)!==null&&r!==void 0?r:Gl.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:ad,this.vsn=(d=t?.vsn)!==null&&d!==void 0?d:c0,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t?.reconnectAfterMs)!==null&&f!==void 0?f:(x=>c1[x-1]||u1),this.vsn){case ev:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((x,w)=>w(JSON.stringify(x))),this.decode=(m=t?.decode)!==null&&m!==void 0?m:((x,w)=>w(JSON.parse(x)));break;case ZS:this.encode=(b=t?.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(v=t?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class df extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ee(c){return typeof c=="object"&&c!==null&&"__isStorageError"in c}class f1 extends df{constructor(t,e,s){super(t),this.name="StorageApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class kd extends df{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}const ff=c=>c?(...t)=>c(...t):(...t)=>fetch(...t),g1=()=>Response,Dd=c=>{if(Array.isArray(c))return c.map(e=>Dd(e));if(typeof c=="function"||c!==Object(c))return c;const t={};return Object.entries(c).forEach(([e,s])=>{const r=e.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[r]=Dd(s)}),t},p1=c=>{if(typeof c!="object"||c===null)return!1;const t=Object.getPrototypeOf(c);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in c)&&!(Symbol.iterator in c)},od=c=>{var t;return c.msg||c.message||c.error_description||(typeof c.error=="string"?c.error:(t=c.error)===null||t===void 0?void 0:t.message)||JSON.stringify(c)},m1=(c,t,e)=>lt(void 0,void 0,void 0,function*(){const s=yield g1();c instanceof s&&!e?.noResolveJson?c.json().then(r=>{const a=c.status||500,o=r?.statusCode||a+"";t(new f1(od(r),a,o))}).catch(r=>{t(new kd(od(r),r))}):t(new kd(od(c),c))}),y1=(c,t,e,s)=>{const r={method:c,headers:t?.headers||{}};return c==="GET"||!s?r:(p1(s)?(r.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r.body=JSON.stringify(s)):r.body=s,t?.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),e))};function fo(c,t,e,s,r,a){return lt(this,void 0,void 0,function*(){return new Promise((o,u)=>{c(e,y1(t,s,r,a)).then(d=>{if(!d.ok)throw d;return s?.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>m1(d,u,s))})})}function eo(c,t,e,s){return lt(this,void 0,void 0,function*(){return fo(c,"GET",t,e,s)})}function Ns(c,t,e,s,r){return lt(this,void 0,void 0,function*(){return fo(c,"POST",t,s,r,e)})}function Md(c,t,e,s,r){return lt(this,void 0,void 0,function*(){return fo(c,"PUT",t,s,r,e)})}function b1(c,t,e,s){return lt(this,void 0,void 0,function*(){return fo(c,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),s)})}function gf(c,t,e,s,r){return lt(this,void 0,void 0,function*(){return fo(c,"DELETE",t,s,r,e)})}class v1{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return lt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ee(t))return{data:null,error:t};throw t}})}}var rv;class w1{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[rv]="BlobDownloadBuilder",this.promise=null}asStream(){return new v1(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return lt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ee(t))return{data:null,error:t};throw t}})}}rv=Symbol.toStringTag;const _1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},f0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class A1{constructor(t,e={},s,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=s,this.fetch=ff(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,s,r){return lt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},f0),r);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),d&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(d))):(a=s,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,d&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),r?.headers&&(u=Object.assign(Object.assign({},u),r.headers));const f=this._removeEmptyFolders(e),g=this._getFinalPath(f),m=yield(t=="PUT"?Md:Ns)(this.fetch,`${this.url}/object/${g}`,a,Object.assign({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}})}upload(t,e,s){return lt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,s)})}uploadToSignedUrl(t,e,s,r){return lt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),u=new URL(this.url+`/object/upload/sign/${o}`);u.searchParams.set("token",e);try{let d;const f=Object.assign({upsert:f0.upsert},r),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",f.cacheControl)):(d=s,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const m=yield Md(this.fetch,u.toString(),d,{headers:g});return{data:{path:a,fullPath:m.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(ee(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,e){return lt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const r=Object.assign({},this.headers);e?.upsert&&(r["x-upsert"]="true");const a=yield Ns(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(this.url+a.url),u=o.searchParams.get("token");if(!u)throw new df("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:u},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}})}update(t,e,s){return lt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,s)})}move(t,e,s){return lt(this,void 0,void 0,function*(){try{return{data:yield Ns(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}copy(t,e,s){return lt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ns(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,s){return lt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),a=yield Ns(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:e},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}createSignedUrls(t,e,s){return lt(this,void 0,void 0,function*(){try{const r=yield Ns(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}download(t,e){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(e?.transform||{}),o=a?`?${a}`:"",u=this._getFinalPath(t),d=()=>eo(this.fetch,`${this.url}/${r}/${u}${o}`,{headers:this.headers,noResolveJson:!0});return new w1(d,this.shouldThrowOnError)}info(t){return lt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const s=yield eo(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Dd(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}})}exists(t){return lt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield b1(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ee(s)&&s instanceof kd){const r=s.originalError;if([400,404].includes(r?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,e){const s=this._getFinalPath(t),r=[],a=e?.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&r.push(a);const u=typeof e?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(e?.transform||{});d!==""&&r.push(d);let f=r.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${s}${f}`)}}}remove(t){return lt(this,void 0,void 0,function*(){try{return{data:yield gf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}list(t,e,s){return lt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},_1),e),{prefix:t||""});return{data:yield Ns(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}listV2(t,e){return lt(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield Ns(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},e),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const av="2.84.0",ov={"X-Client-Info":`storage-js/${av}`};class x1{constructor(t,e={},s,r){this.shouldThrowOnError=!1;const a=new URL(t);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ov),e),this.fetch=ff(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return lt(this,void 0,void 0,function*(){try{const e=this.listBucketOptionsToQueryString(t);return{data:yield eo(this.fetch,`${this.url}/bucket${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}getBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield eo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}createBucket(t){return lt(this,arguments,void 0,function*(e,s={public:!1}){try{return{data:yield Ns(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return lt(this,void 0,void 0,function*(){try{return{data:yield Md(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}})}emptyBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield Ns(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}deleteBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield gf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}}class S1{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ov),e),this.fetch=ff(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield Ns(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}listBuckets(t){return lt(this,void 0,void 0,function*(){try{const e=new URLSearchParams;t?.limit!==void 0&&e.set("limit",t.limit.toString()),t?.offset!==void 0&&e.set("offset",t.offset.toString()),t?.sortColumn&&e.set("sortColumn",t.sortColumn),t?.sortOrder&&e.set("sortOrder",t.sortOrder),t?.search&&e.set("search",t.search);const s=e.toString(),r=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield eo(this.fetch,r,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}deleteBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield gf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}})}}const pf={"X-Client-Info":`storage-js/${av}`,"Content-Type":"application/json"};class lv extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function cs(c){return typeof c=="object"&&c!==null&&"__isStorageVectorsError"in c}class ld extends lv{constructor(t,e,s){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class E1 extends lv{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}}var g0;(function(c){c.InternalError="InternalError",c.S3VectorConflictException="S3VectorConflictException",c.S3VectorNotFoundException="S3VectorNotFoundException",c.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",c.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",c.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(g0||(g0={}));const mf=c=>c?(...t)=>c(...t):(...t)=>fetch(...t),T1=c=>{if(typeof c!="object"||c===null)return!1;const t=Object.getPrototypeOf(c);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in c)&&!(Symbol.iterator in c)},p0=c=>c.msg||c.message||c.error_description||c.error||JSON.stringify(c),C1=(c,t,e)=>lt(void 0,void 0,void 0,function*(){if(c&&typeof c=="object"&&"status"in c&&"ok"in c&&typeof c.status=="number"&&!e?.noResolveJson){const r=c.status||500,a=c;if(typeof a.json=="function")a.json().then(o=>{const u=o?.statusCode||o?.code||r+"";t(new ld(p0(o),r,u))}).catch(()=>{const o=r+"",u=a.statusText||`HTTP ${r} error`;t(new ld(u,r,o))});else{const o=r+"",u=a.statusText||`HTTP ${r} error`;t(new ld(u,r,o))}}else t(new E1(p0(c),c))}),R1=(c,t,e,s)=>{const r={method:c,headers:t?.headers||{}};return s?(T1(s)?(r.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r.body=JSON.stringify(s)):r.body=s,Object.assign(Object.assign({},r),e)):r};function N1(c,t,e,s,r,a){return lt(this,void 0,void 0,function*(){return new Promise((o,u)=>{c(e,R1(t,s,r,a)).then(d=>{if(!d.ok)throw d;if(s?.noResolveJson)return d;const f=d.headers.get("content-type");return!f||!f.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>C1(d,u,s))})})}function us(c,t,e,s,r){return lt(this,void 0,void 0,function*(){return N1(c,"POST",t,s,r,e)})}class O1{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pf),e),this.fetch=mf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return lt(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}getIndex(t,e){return lt(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cs(s))return{data:null,error:s};throw s}})}listIndexes(t){return lt(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return lt(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cs(s))return{data:null,error:s};throw s}})}}class k1{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pf),e),this.fetch=mf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return lt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield us(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}getVectors(t){return lt(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}listVectors(t){return lt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield us(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}queryVectors(t){return lt(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}deleteVectors(t){return lt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield us(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}}class D1{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},pf),e),this.fetch=mf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}getBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}listBuckets(){return lt(this,arguments,void 0,function*(t={}){try{return{data:yield us(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}deleteBucket(t){return lt(this,void 0,void 0,function*(){try{return{data:(yield us(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cs(e))return{data:null,error:e};throw e}})}}class M1 extends D1{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new j1(this.url,this.headers,t,this.fetch)}}class j1 extends O1{constructor(t,e,s,r){super(t,e,r),this.vectorBucketName=s}createIndex(t){const e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return lt(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return lt(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return lt(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return lt(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new L1(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class L1 extends k1{constructor(t,e,s,r,a){super(t,e,a),this.vectorBucketName=s,this.indexName=r}putVectors(t){const e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return lt(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return lt(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return lt(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return lt(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return lt(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class P1 extends x1{constructor(t,e={},s,r){super(t,e,s,r)}from(t){return new A1(this.url,this.headers,t,this.fetch)}get vectors(){return new M1(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new S1(this.url+"/iceberg",this.headers,this.fetch)}}const B1="2.84.0";let Ya="";typeof Deno<"u"?Ya="deno":typeof document<"u"?Ya="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ya="react-native":Ya="node";const U1={"X-Client-Info":`supabase-js-${Ya}/${B1}`},I1={headers:U1},z1={schema:"public"},F1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},H1={},$1=c=>c?(...t)=>c(...t):(...t)=>fetch(...t),q1=()=>Headers,G1=(c,t,e)=>{const s=$1(e),r=q1();return async(a,o)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:c;let f=new r(o?.headers);return f.has("apikey")||f.set("apikey",c),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),s(a,Object.assign(Object.assign({},o),{headers:f}))}};function V1(c){return c.endsWith("/")?c:c+"/"}function Y1(c,t){var e,s;const{db:r,auth:a,realtime:o,global:u}=c,{db:d,auth:f,realtime:g,global:m}=t,b={db:Object.assign(Object.assign({},d),r),auth:Object.assign(Object.assign({},f),a),realtime:Object.assign(Object.assign({},g),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),u),{headers:Object.assign(Object.assign({},(e=m?.headers)!==null&&e!==void 0?e:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return c.accessToken?b.accessToken=c.accessToken:delete b.accessToken,b}function X1(c){const t=c?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(V1(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const cv="2.84.0",Er=30*1e3,jd=3,cd=jd*Er,K1="http://localhost:9999",W1="supabase.auth.token",Q1={"X-Client-Info":`gotrue-js/${cv}`},Ld="X-Supabase-Api-Version",uv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},J1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Z1=600*1e3;class so extends Error{constructor(t,e,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=s}}function ct(c){return typeof c=="object"&&c!==null&&"__isAuthError"in c}class tE extends so{constructor(t,e,s){super(t,e,s),this.name="AuthApiError",this.status=e,this.code=s}}function eE(c){return ct(c)&&c.name==="AuthApiError"}class Sn extends so{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Qi extends so{constructor(t,e,s,r){super(t,s,r),this.name=e,this.status=s}}class as extends Qi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sE(c){return ct(c)&&c.name==="AuthSessionMissingError"}class br extends Qi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vl extends Qi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Yl extends Qi{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function iE(c){return ct(c)&&c.name==="AuthImplicitGrantRedirectError"}class m0 extends Qi{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pd extends Qi{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function ud(c){return ct(c)&&c.name==="AuthRetryableFetchError"}class y0 extends Qi{constructor(t,e,s){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=s}}class Bd extends Qi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),b0=` 	
\r=`.split(""),nE=(()=>{const c=new Array(128);for(let t=0;t<c.length;t+=1)c[t]=-1;for(let t=0;t<b0.length;t+=1)c[b0[t].charCodeAt(0)]=-2;for(let t=0;t<gc.length;t+=1)c[gc[t].charCodeAt(0)]=t;return c})();function v0(c,t,e){if(c!==null)for(t.queue=t.queue<<8|c,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(gc[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(gc[s]),t.queuedBits-=6}}function hv(c,t,e){const s=nE[c];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(c)}"`)}}function w0(c){const t=[],e=o=>{t.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=o=>{oE(o,s,e)};for(let o=0;o<c.length;o+=1)hv(c.charCodeAt(o),r,a);return t.join("")}function rE(c,t){if(c<=127){t(c);return}else if(c<=2047){t(192|c>>6),t(128|c&63);return}else if(c<=65535){t(224|c>>12),t(128|c>>6&63),t(128|c&63);return}else if(c<=1114111){t(240|c>>18),t(128|c>>12&63),t(128|c>>6&63),t(128|c&63);return}throw new Error(`Unrecognized Unicode codepoint: ${c.toString(16)}`)}function aE(c,t){for(let e=0;e<c.length;e+=1){let s=c.charCodeAt(e);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(c.charCodeAt(e+1)-56320&65535|r)+65536,e+=1}rE(s,t)}}function oE(c,t,e){if(t.utf8seq===0){if(c<=127){e(c);return}for(let s=1;s<6;s+=1)if((c>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=c&31;else if(t.utf8seq===3)t.codepoint=c&15;else if(t.utf8seq===4)t.codepoint=c&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(c<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|c&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function Mr(c){const t=[],e={queue:0,queuedBits:0},s=r=>{t.push(r)};for(let r=0;r<c.length;r+=1)hv(c.charCodeAt(r),e,s);return new Uint8Array(t)}function lE(c){const t=[];return aE(c,e=>t.push(e)),new Uint8Array(t)}function En(c){const t=[],e={queue:0,queuedBits:0},s=r=>{t.push(r)};return c.forEach(r=>v0(r,e,s)),v0(null,e,s),t.join("")}function cE(c){return Math.round(Date.now()/1e3)+c}function uE(){return Symbol("auth-callback")}const Ne=()=>typeof window<"u"&&typeof document<"u",vn={tested:!1,writable:!1},dv=()=>{if(!Ne())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(vn.tested)return vn.writable;const c=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(c,c),globalThis.localStorage.removeItem(c),vn.tested=!0,vn.writable=!0}catch{vn.tested=!0,vn.writable=!1}return vn.writable};function hE(c){const t={},e=new URL(c);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((r,a)=>{t[a]=r})}catch{}return e.searchParams.forEach((s,r)=>{t[r]=s}),t}const fv=c=>c?(...t)=>c(...t):(...t)=>fetch(...t),dE=c=>typeof c=="object"&&c!==null&&"status"in c&&"ok"in c&&"json"in c&&typeof c.json=="function",Tr=async(c,t,e)=>{await c.setItem(t,JSON.stringify(e))},wn=async(c,t)=>{const e=await c.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},$i=async(c,t)=>{await c.removeItem(t)};class Ec{constructor(){this.promise=new Ec.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ec.promiseConstructor=Promise;function hd(c){const t=c.split(".");if(t.length!==3)throw new Bd("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!J1.test(t[s]))throw new Bd("JWT not in base64url format");return{header:JSON.parse(w0(t[0])),payload:JSON.parse(w0(t[1])),signature:Mr(t[2]),raw:{header:t[0],payload:t[1]}}}async function fE(c){return await new Promise(t=>{setTimeout(()=>t(null),c)})}function gE(c,t){return new Promise((s,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await c(a);if(!t(a,null,o)){s(o);return}}catch(o){if(!t(a,o)){r(o);return}}})()})}function pE(c){return("0"+c.toString(16)).substr(-2)}function mE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=e.length;let r="";for(let a=0;a<56;a++)r+=e.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(t),Array.from(t,pE).join("")}async function yE(c){const e=new TextEncoder().encode(c),s=await crypto.subtle.digest("SHA-256",e),r=new Uint8Array(s);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function bE(c){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),c;const e=await yE(c);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vr(c,t,e=!1){const s=mE();let r=s;e&&(r+="/PASSWORD_RECOVERY"),await Tr(c,`${t}-code-verifier`,r);const a=await bE(s);return[a,s===a?"plain":"s256"]}const vE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wE(c){const t=c.headers.get(Ld);if(!t||!t.match(vE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function _E(c){if(!c)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(c<=t)throw new Error("JWT has expired")}function AE(c){switch(c){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wr(c){if(!xE.test(c))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dd(){const c={};return new Proxy(c,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const s=e.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function SE(c,t){return new Proxy(c,{get:(e,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,s,r)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,s,r)}})}function _0(c){return JSON.parse(JSON.stringify(c))}const _n=c=>c.msg||c.message||c.error_description||c.error||JSON.stringify(c),EE=[502,503,504];async function A0(c){var t;if(!dE(c))throw new Pd(_n(c),0);if(EE.includes(c.status))throw new Pd(_n(c),c.status);let e;try{e=await c.json()}catch(a){throw new Sn(_n(a),a)}let s;const r=wE(c);if(r&&r.getTime()>=uv["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?s=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(s=e.error_code),s){if(s==="weak_password")throw new y0(_n(e),c.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new as}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new y0(_n(e),c.status,e.weak_password.reasons);throw new tE(_n(e),c.status||500,s)}const TE=(c,t,e,s)=>{const r={method:c,headers:t?.headers||{}};return c==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),e))};async function bt(c,t,e,s){var r;const a=Object.assign({},s?.headers);a[Ld]||(a[Ld]=uv["2024-01-01"].name),s?.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(r=s?.query)!==null&&r!==void 0?r:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await CE(c,t,e+u,{headers:a,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function CE(c,t,e,s,r,a){const o=TE(t,s,r,a);let u;try{u=await c(e,Object.assign({},o))}catch(d){throw console.error(d),new Pd(_n(d),0)}if(u.ok||await A0(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await A0(d)}}function Rs(c){var t;let e=null;OE(c)&&(e=Object.assign({},c),c.expires_at||(e.expires_at=cE(c.expires_in)));const s=(t=c.user)!==null&&t!==void 0?t:c;return{data:{session:e,user:s},error:null}}function x0(c){const t=Rs(c);return!t.error&&c.weak_password&&typeof c.weak_password=="object"&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.message&&typeof c.weak_password.message=="string"&&c.weak_password.reasons.reduce((e,s)=>e&&typeof s=="string",!0)&&(t.data.weak_password=c.weak_password),t}function qi(c){var t;return{data:{user:(t=c.user)!==null&&t!==void 0?t:c},error:null}}function RE(c){return{data:c,error:null}}function NE(c){const{action_link:t,email_otp:e,hashed_token:s,redirect_to:r,verification_type:a}=c,o=qr(c,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:e,hashed_token:s,redirect_to:r,verification_type:a},d=Object.assign({},o);return{data:{properties:u,user:d},error:null}}function S0(c){return c}function OE(c){return c.access_token&&c.refresh_token&&c.expires_in}const fd=["global","local","others"];class kE{constructor({url:t="",headers:e={},fetch:s}){this.url=t,this.headers=e,this.fetch=fv(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=fd[0]){if(fd.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fd.join(", ")}`);try{return await bt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ct(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,e={}){try{return await bt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:qi})}catch(s){if(ct(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:e}=t,s=qr(t,["options"]),r=Object.assign(Object.assign({},s),e);return"newEmail"in s&&(r.new_email=s?.newEmail,delete r.newEmail),await bt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:NE,redirectTo:e?.redirectTo})}catch(e){if(ct(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await bt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:qi})}catch(e){if(ct(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,s,r,a,o,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await bt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=t?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:S0});if(g.error)throw g.error;const m=await g.json(),b=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=w}),f.total=parseInt(b)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(ct(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){wr(t);try{return await bt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:qi})}catch(e){if(ct(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){wr(t);try{return await bt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:qi})}catch(s){if(ct(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,e=!1){wr(t);try{return await bt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:qi})}catch(s){if(ct(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){wr(t.userId);try{const{data:e,error:s}=await bt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:e,error:s}}catch(e){if(ct(e))return{data:null,error:e};throw e}}async _deleteFactor(t){wr(t.userId),wr(t.id);try{return{data:await bt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(ct(e))return{data:null,error:e};throw e}}async _listOAuthClients(t){var e,s,r,a,o,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await bt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=t?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:S0});if(g.error)throw g.error;const m=await g.json(),b=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);f[`${S}Page`]=w}),f.total=parseInt(b)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(ct(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await bt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ct(e))return{data:null,error:e};throw e}}async _getOAuthClient(t){try{return await bt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ct(e))return{data:null,error:e};throw e}}async _updateOAuthClient(t,e){try{return await bt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await bt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(ct(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(t){try{return await bt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ct(e))return{data:null,error:e};throw e}}}function E0(c={}){return{getItem:t=>c[t]||null,setItem:(t,e)=>{c[t]=e},removeItem:t=>{delete c[t]}}}const _r={debug:!!(globalThis&&dv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class DE extends gv{}async function ME(c,t,e){_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",c,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),_r.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",c)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(c,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",c,r.name);try{return await e()}finally{_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",c,r.name)}}else{if(t===0)throw _r.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",c),new DE(`Acquiring an exclusive Navigator LockManager lock "${c}" immediately failed`);if(_r.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function jE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function pv(c){if(!/^0x[a-fA-F0-9]{40}$/.test(c))throw new Error(`@supabase/auth-js: Address "${c}" is invalid.`);return c.toLowerCase()}function LE(c){return parseInt(c,16)}function PE(c){const t=new TextEncoder().encode(c);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function BE(c){var t;const{chainId:e,domain:s,expirationTime:r,issuedAt:a=new Date,nonce:o,notBefore:u,requestId:d,resources:f,scheme:g,uri:m,version:b}=c;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((t=c.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${c.statement}`)}const v=pv(c.address),x=g?`${g}://${s}`:s,w=c.statement?`${c.statement}
`:"",S=`${x} wants you to sign in with your Ethereum account:
${v}

${w}`;let E=`URI: ${m}
Version: ${b}
Chain ID: ${e}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(r&&(E+=`
Expiration Time: ${r.toISOString()}`),u&&(E+=`
Not Before: ${u.toISOString()}`),d&&(E+=`
Request ID: ${d}`),f){let R=`
Resources:`;for(const T of f){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);R+=`
- ${T}`}E+=R}return`${S}
${E}`}class ye extends Error{constructor({message:t,code:e,cause:s,name:r}){var a;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=r??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=e}}class pc extends ye{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}function UE({error:c,options:t}){var e,s,r;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(c.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ye({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:c})}else if(c.name==="ConstraintError"){if(((e=a.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new ye({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:c});if(t.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new ye({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:c});if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new ye({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:c})}else{if(c.name==="InvalidStateError")return new ye({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:c});if(c.name==="NotAllowedError")return new ye({message:c.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:c});if(c.name==="NotSupportedError")return a.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new ye({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:c}):new ye({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:c});if(c.name==="SecurityError"){const o=window.location.hostname;if(mv(o)){if(a.rp.id!==o)return new ye({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:c})}else return new ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:c})}else if(c.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new ye({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:c})}else if(c.name==="UnknownError")return new ye({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:c})}return new ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:c})}function IE({error:c,options:t}){const{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(c.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ye({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:c})}else{if(c.name==="NotAllowedError")return new ye({message:c.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:c});if(c.name==="SecurityError"){const s=window.location.hostname;if(mv(s)){if(e.rpId!==s)return new ye({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:c})}else return new ye({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:c})}else if(c.name==="UnknownError")return new ye({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:c})}return new ye({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:c})}class zE{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const FE=new zE;function HE(c){if(!c)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(c);const{challenge:t,user:e,excludeCredentials:s}=c,r=qr(c,["challenge","user","excludeCredentials"]),a=Mr(t).buffer,o=Object.assign(Object.assign({},e),{id:Mr(e.id).buffer}),u=Object.assign(Object.assign({},r),{challenge:a,user:o});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Mr(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function $E(c){if(!c)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(c);const{challenge:t,allowCredentials:e}=c,s=qr(c,["challenge","allowCredentials"]),r=Mr(t).buffer,a=Object.assign(Object.assign({},s),{challenge:r});if(e&&e.length>0){a.allowCredentials=new Array(e.length);for(let o=0;o<e.length;o++){const u=e[o];a.allowCredentials[o]=Object.assign(Object.assign({},u),{id:Mr(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function qE(c){var t;if("toJSON"in c&&typeof c.toJSON=="function")return c.toJSON();const e=c;return{id:c.id,rawId:c.id,response:{attestationObject:En(new Uint8Array(c.response.attestationObject)),clientDataJSON:En(new Uint8Array(c.response.clientDataJSON))},type:"public-key",clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function GE(c){var t;if("toJSON"in c&&typeof c.toJSON=="function")return c.toJSON();const e=c,s=c.getClientExtensionResults(),r=c.response;return{id:c.id,rawId:c.id,response:{authenticatorData:En(new Uint8Array(r.authenticatorData)),clientDataJSON:En(new Uint8Array(r.clientDataJSON)),signature:En(new Uint8Array(r.signature)),userHandle:r.userHandle?En(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function mv(c){return c==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(c)}function T0(){var c,t;return!!(Ne()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((c=navigator?.credentials)===null||c===void 0?void 0:c.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function VE(c){try{const t=await navigator.credentials.create(c);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pc("Browser returned unexpected credential type",t)}:{data:null,error:new pc("Empty credential response",t)}}catch(t){return{data:null,error:UE({error:t,options:c})}}}async function YE(c){try{const t=await navigator.credentials.get(c);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pc("Browser returned unexpected credential type",t)}:{data:null,error:new pc("Empty credential response",t)}}catch(t){return{data:null,error:IE({error:t,options:c})}}}const XE={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},KE={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function mc(...c){const t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),e=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of c)if(r)for(const a in r){const o=r[a];if(o!==void 0)if(Array.isArray(o))s[a]=o;else if(e(o))s[a]=o;else if(t(o)){const u=s[a];t(u)?s[a]=mc(u,o):s[a]=mc(o)}else s[a]=o}return s}function WE(c,t){return mc(XE,c,t||{})}function QE(c,t){return mc(KE,c,t||{})}class JE{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:s,signal:r},a){try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!o)return{data:null,error:u};const d=r??FE.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${s}`),f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=WE(o.webauthn.credential_options.publicKey,a?.create),{data:g,error:m}=await VE({publicKey:f,signal:d});return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}case"request":{const f=QE(o.webauthn.credential_options.publicKey,a?.request),{data:g,error:m}=await YE(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:d}));return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}}}catch(o){return ct(o)?{data:null,error:o}:{data:null,error:new Sn("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:e,webauthn:s}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!e)return{data:null,error:new so("rpId is required for WebAuthn authentication")};try{if(!T0())return{data:null,error:new Sn("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:s},signal:r},{request:a});if(!o)return{data:null,error:u};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:e,rpOrigins:s,credential_response:d.credential_response}})}catch(o){return ct(o)?{data:null,error:o}:{data:null,error:new Sn("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!e)return{data:null,error:new so("rpId is required for WebAuthn registration")};try{if(!T0())return{data:null,error:new Sn("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(g=>{var m;return(m=g.data)===null||m===void 0?void 0:m.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===t&&b.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:e,rpOrigins:s},signal:r},{create:a});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:e,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(o){return ct(o)?{data:null,error:o}:{data:null,error:new Sn("Unexpected error in register",o)}}}}jE();const ZE={url:K1,storageKey:W1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Q1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function C0(c,t,e){return await e()}const Ar={};class io{get jwks(){var t,e;return(e=(t=Ar[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(t){Ar[this.storageKey]=Object.assign(Object.assign({},Ar[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return(e=(t=Ar[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ar[this.storageKey]=Object.assign(Object.assign({},Ar[this.storageKey]),{cachedAt:t})}constructor(t){var e,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},ZE),t);if(this.storageKey=a.storageKey,this.instanceID=(e=io.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,io.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Ne()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new kE({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=fv(a.fetch),this.lock=a.lock||C0,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Ne()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=ME:this.lock=C0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new JE(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:dv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=E0(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=E0(this.memoryStorage)),Ne()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${cv}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let e={},s="none";if(Ne()&&(e=hE(window.location.href),this._isImplicitGrantCallback(e)?s="implicit":await this._isPKCECallback(e)&&(s="pkce")),Ne()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:a}=await this._getSessionFromURL(e,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),iE(a)){const d=(t=a.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:u}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return ct(e)?this._returnResult({error:e}):this._returnResult({error:new Sn("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,s,r;try{const a=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(e=t?.options)===null||e===void 0?void 0:e.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=t?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Rs}),{data:o,error:u}=a;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(ct(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var e,s,r;try{let a;if("email"in t){const{email:g,password:m,options:b}=t;let v=null,x=null;this.flowType==="pkce"&&([v,x]=await vr(this.storage,this.storageKey)),a=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:g,password:m,data:(e=b?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:v,code_challenge_method:x},xform:Rs})}else if("phone"in t){const{phone:g,password:m,options:b}=t;a=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:m,data:(s=b?.data)!==null&&s!==void 0?s:{},channel:(r=b?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:Rs})}else throw new Vl("You must provide either an email or phone number and a password");const{data:o,error:u}=a;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(ct(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let e;if("email"in t){const{email:a,password:o,options:u}=t;e=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:x0})}else if("phone"in t){const{phone:a,password:o,options:u}=t;e=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:x0})}else throw new Vl("You must provide either an email or phone number and a password");const{data:s,error:r}=e;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const a=new br;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(e){if(ct(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(t){var e,s,r,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=t.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,s,r,a,o,u,d,f,g,m,b;let v,x;if("message"in t)v=t.message,x=t.signature;else{const{chain:w,wallet:S,statement:E,options:R}=t;let T;if(Ne())if(typeof S=="object")T=S;else{const X=window;if("ethereum"in X&&typeof X.ethereum=="object"&&"request"in X.ethereum&&typeof X.ethereum.request=="function")T=X.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const N=new URL((e=R?.url)!==null&&e!==void 0?e:window.location.href),D=await T.request({method:"eth_requestAccounts"}).then(X=>X).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=pv(D[0]);let L=(s=R?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!L){const X=await T.request({method:"eth_chainId"});L=LE(X)}const G={domain:N.host,address:M,statement:E,uri:N.href,version:"1",chainId:L,nonce:(r=R?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(a=R?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=R?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=R?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(g=R?.signInWithEthereum)===null||g===void 0?void 0:g.resources};v=BE(G),x=await T.request({method:"personal_sign",params:[PE(v),M]})}try{const{data:w,error:S}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:x},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Rs});if(S)throw S;if(!w||!w.session||!w.user){const E=new br;return this._returnResult({data:{user:null,session:null},error:E})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(ct(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var e,s,r,a,o,u,d,f,g,m,b,v;let x,w;if("message"in t)x=t.message,w=t.signature;else{const{chain:S,wallet:E,statement:R,options:T}=t;let N;if(Ne())if(typeof E=="object")N=E;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))N=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=E}const D=new URL((e=T?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in N&&N.signIn){const M=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),R?{statement:R}:null));let L;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")L=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)L=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)x=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),w=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${D.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(r=(s=T?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=T?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((f=T?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((m=(g=T?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||m===void 0)&&m.length?["Resources",...T.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const M=await N.signMessage(new TextEncoder().encode(x),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=M}}try{const{data:S,error:E}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:En(w)},!((b=t.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Rs});if(E)throw E;if(!S||!S.session||!S.user){const R=new br;return this._returnResult({data:{user:null,session:null},error:R})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:E})}catch(S){if(ct(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const e=await wn(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(e??"").split("/");try{const{data:a,error:o}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:Rs});if(await $i(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const u=new br;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:o})}catch(a){if(ct(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:e,provider:s,token:r,access_token:a,nonce:o}=t,u=await bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:Rs}),{data:d,error:f}=u;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const g=new br;return this._returnResult({data:{user:null,session:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(e){if(ct(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(t){var e,s,r,a,o;try{if("email"in t){const{email:u,options:d}=t;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await vr(this.storage,this.storageKey));const{error:m}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=d?.data)!==null&&e!==void 0?e:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:u,options:d}=t,{data:f,error:g}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(o=d?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new Vl("You must provide either an email or phone number.")}catch(u){if(ct(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var e,s;try{let r,a;"options"in t&&(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo,a=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:u}=await bt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:Rs});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,f=o.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(r){if(ct(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(t){var e,s,r,a,o;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await vr(this.storage,this.storageKey));const f=await bt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=t?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:RE});return!((a=f.data)===null||a===void 0)&&a.url&&Ne()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(u){if(ct(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;if(s)throw s;if(!e)throw new as;const{error:r}=await bt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(t){if(ct(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:s,type:r,options:a}=t,{error:o}=await bt(this.fetch,"POST",e,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:s,type:r,options:a}=t,{data:o,error:u}=await bt(this.fetch,"POST",e,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:u})}throw new Vl("You must provide either an email or phone number and a type")}catch(e){if(ct(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await e()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=e();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await wn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<cd:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const o=await wn(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=dd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=SE(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:r,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:qi}):await this._useSession(async e=>{var s,r,a;const{data:o,error:u}=e;if(u)throw u;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new as}:await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:qi})})}catch(e){if(ct(e))return sE(e)&&(await this._removeSession(),await $i(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new as;const o=r.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await vr(this.storage,this.storageKey));const{data:f,error:g}=await bt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:o.access_token,xform:qi});if(g)throw g;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(ct(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new as;const e=Date.now()/1e3;let s=e,r=!0,a=null;const{payload:o}=hd(t.access_token);if(o.exp&&(s=o.exp,r=s<=e),r){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;a={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-e,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(e){if(ct(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var s;if(!t){const{data:o,error:u}=e;if(u)throw u;t=(s=o.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new as;const{data:r,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(ct(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(t,e){try{if(!Ne())throw new Yl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Yl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new m0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yl("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new m0("No code detected.");const{data:R,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:o,expires_in:u,expires_at:d,token_type:f}=t;if(!a||!u||!o||!f)throw new Yl("No session defined in URL");const g=Math.round(Date.now()/1e3),m=parseInt(u);let b=g+m;d&&(b=parseInt(d));const v=b-g;v*1e3<=Er&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const x=b-m;g-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,b,g):g-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,b,g);const{data:w,error:S}=await this._getUser(a);if(S)throw S;const E={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:m,expires_at:b,refresh_token:o,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:t.type},error:null})}catch(s){if(ct(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await wn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var s;const{data:r,error:a}=e;if(a)return this._returnResult({error:a});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(eE(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await $i(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const e=uE(),s={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async e=>{var s,r;try{const{data:{session:a},error:o}=e;if(o)throw o;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,e={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await vr(this.storage,this.storageKey,!0));try{return await bt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(a){if(ct(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:e,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{const{data:s,error:r}=await this._useSession(async a=>{var o,u,d,f,g;const{data:m,error:b}=a;if(b)throw b;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await bt(this.fetch,"GET",v,{headers:this.headers,jwt:(g=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(r)throw r;return Ne()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(ct(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var s;try{const{error:r,data:{session:a}}=e;if(r)throw r;const{options:o,provider:u,token:d,access_token:f,nonce:g}=t,m=await bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:f,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Rs}),{data:b,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new br}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:v}))}catch(r){if(ct(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var s,r;const{data:a,error:o}=e;if(o)throw o;return await bt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const s=Date.now();return await gE(async r=>(r>0&&await fE(200*Math.pow(2,r-1)),this._debug(e,"refreshing attempt",r),await bt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Rs})),(r,a)=>{const o=200*Math.pow(2,r);return a&&ud(a)&&Date.now()+o-s<Er})}catch(s){if(this._debug(e,"error",s),ct(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",s),Ne()&&!e.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,e;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await wn(this.storage,this.storageKey);if(r&&this.userStorage){let o=await wn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await Tr(this.userStorage,this.storageKey+"-user",o)),r.user=(t=o?.user)!==null&&t!==void 0?t:dd()}else if(r&&!r.user&&!r.user){const o=await wn(this.storage,this.storageKey+"-user");o&&o?.user?(r.user=o.user,await $i(this.storage,this.storageKey+"-user"),await Tr(this.storage,this.storageKey,r)):r.user=dd()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<cd;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${cd}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),ud(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(r.access_token);!u&&o?.user?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var e,s;if(!t)throw new as;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ec;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new as;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={data:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(r,"error",a),ct(a)){const o={data:null,error:a};return ud(a)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(t,e,s=!0){const r=`#_notifyAllSubscribers(${t})`;this._debug(r,"begin",e,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:e});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,e)}catch(d){a.push(d)}});if(await Promise.all(o),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const e=Object.assign({},t),s=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&e.user&&await Tr(this.userStorage,this.storageKey+"-user",{user:e.user});const r=Object.assign({},e);delete r.user;const a=_0(r);await Tr(this.storage,this.storageKey,a)}else{const r=_0(e);await Tr(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await $i(this.storage,this.storageKey),await $i(this.storage,this.storageKey+"-code-verifier"),await $i(this.storage,this.storageKey+"-user"),this.userStorage&&await $i(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ne()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Er);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-t)/Er);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Er}ms, refresh threshold is ${jd} ticks`),r<=jd&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof gv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ne()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,s){const r=[`provider=${encodeURIComponent(e)}`];if(s?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await vr(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(u.toString())}if(s?.queryParams){const a=new URLSearchParams(s.queryParams);r.push(a.toString())}return s?.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${r.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var s;const{data:r,error:a}=e;return a?this._returnResult({data:null,error:a}):await bt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token})})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(t){try{return await this._useSession(async e=>{var s,r;const{data:a,error:o}=e;if(o)return this._returnResult({data:null,error:o});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:f}=await bt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(t.factorType==="totp"&&d.type==="totp"&&(!((r=d?.totp)===null||r===void 0)&&r.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:r,error:a}=e;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?qE(t.webauthn.credential_response):GE(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:r,error:a}=e;if(a)return this._returnResult({data:null,error:a});const o=await bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:HE(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:$E(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(t){const{data:e,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=e?.factors)!==null&&t!==void 0?t:[])r.all.push(a),a.status==="verified"&&r[a.factor_type].push(a);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var t,e;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=hd(s.access_token);let o=null;a.aal&&(o=a.aal);let u=o;((e=(t=s.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(u="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;return r?this._returnResult({data:null,error:r}):s?await bt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new as})})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new as});const o=await bt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Ne()&&!e?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(s){if(ct(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new as});const o=await bt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Ne()&&!e?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(s){if(ct(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;return s?this._returnResult({data:null,error:s}):e?await bt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new as})})}catch(t){if(ct(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;return r?this._returnResult({data:null,error:r}):s?await bt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new as})})}catch(e){if(ct(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(t,e={keys:[]}){let s=e.keys.find(u=>u.kid===t);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+Z1>r)return s;const{data:a,error:o}=await bt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,s=a.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,e={}){try{let s=t;if(!s){const{data:v,error:x}=await this.getSession();if(x||!v.session)return this._returnResult({data:null,error:x});s=v.session.access_token}const{header:r,payload:a,signature:o,raw:{header:u,payload:d}}=hd(s);e?.allowExpired||_E(a.exp);const f=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!f){const{error:v}=await this.getUser(s);if(v)throw v;return{data:{claims:a,header:r,signature:o},error:null}}const g=AE(r.alg),m=await crypto.subtle.importKey("jwk",f,g,!0,["verify"]);if(!await crypto.subtle.verify(g,m,o,lE(`${u}.${d}`)))throw new Bd("Invalid JWT signature");return{data:{claims:a,header:r,signature:o},error:null}}catch(s){if(ct(s))return this._returnResult({data:null,error:s});throw s}}}io.nextInstanceID={};const tT=io;class eT extends tT{constructor(t){super(t)}}class sT{constructor(t,e,s){var r,a,o;this.supabaseUrl=t,this.supabaseKey=e;const u=X1(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:z1,realtime:H1,auth:Object.assign(Object.assign({},F1),{storageKey:d}),global:I1},g=Y1(s??{},f);this.storageKey=(r=g.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(m,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=g.auth)!==null&&o!==void 0?o:{},this.headers,g.global.fetch),this.fetch=G1(e,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&this.accessToken().then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new KS(new URL("rest/v1",u).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new P1(this.storageUrl.href,this.headers,this.fetch,s?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new GS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,s)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,e;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(e=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:r,userStorage:a,storageKey:o,flowType:u,lock:d,debug:f,throwOnError:g},m,b){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new eT({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),m),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:r,userStorage:a,flowType:u,lock:d,debug:f,throwOnError:g,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new d1(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,s)=>{this._handleTokenChanged(e,"CLIENT",s?.access_token)})}_handleTokenChanged(t,e,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const iT=(c,t,e)=>new sT(c,t,e);function nT(){if(typeof window<"u"||typeof process>"u")return!1;const c=process.version;if(c==null)return!1;const t=c.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}nT()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const rT="https://aqizwggmprsqacebzpcl.supabase.co",aT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxaXp3Z2dtcHJzcWFjZWJ6cGNsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1NDI4OTMsImV4cCI6MjA3OTExODg5M30.KAEhwwgcSr4Y7xUP6CVp6WiY6ef9B2N25cXR9ciK8Z8",Gt=iT(rT,aT);function oT(){const c=ub(),[t,e]=F.useState({totalRevenue:0,creatorEarnings:0,totalWithdrawn:0,companyBalance:0,productsSold:0,totalUsers:0,activeProducts:0}),[s,r]=F.useState([]),[a,o]=F.useState(!0),[u,d]=F.useState([]);F.useEffect(()=>{f();const w=Gt.channel("purchases_changes").on("postgres_changes",{event:"*",schema:"public",table:"purchases"},()=>{f()}).subscribe(),S=Gt.channel("users_changes").on("postgres_changes",{event:"*",schema:"public",table:"users"},()=>{f()}).subscribe(),E=Gt.channel("products_changes").on("postgres_changes",{event:"*",schema:"public",table:"products"},()=>{f()}).subscribe();return()=>{Gt.removeChannel(w),Gt.removeChannel(S),Gt.removeChannel(E)}},[]);async function f(){o(!0);try{const[w,S,E,R,T,N]=await Promise.all([Gt.from("purchases").select(`
                id,
                amount,
                created_at,
                product:products(id, owner_id, title)
            `).eq("status","paid"),Gt.from("products").select("id, status, is_active").eq("is_active",!0),Gt.from("withdrawals").select("net_amount, status").eq("status","paid"),Gt.from("purchases").select(`
                id,
                amount,
                created_at,
                user:users(name, username),
                product:products(title)
            `).eq("status","paid").order("created_at",{ascending:!1}).limit(5),Gt.from("users").select("id, name, username, created_at").order("created_at",{ascending:!1}).limit(3),Gt.from("products").select("id, title, owner_id, created_at, users!products_owner_fk(username)").order("created_at",{ascending:!1}).limit(3)]),D=w.data?.length||0,M=w.data?.reduce((Q,tt)=>Q+parseFloat(tt.amount),0)||0,L=E.data?.reduce((Q,tt)=>Q+parseFloat(tt.net_amount),0)||0,G=M-L,X=S.data?.filter(Q=>Q.status==="approved").length||0;e({totalRevenue:L,creatorEarnings:M,totalWithdrawn:L,companyBalance:G,productsSold:D,totalUsers:await g(),activeProducts:X});const et=[];R.data?.forEach(Q=>{et.push({id:Q.id,type:"purchase",user:Q.user?.name||"Unknown User",username:Q.user?.username,action:`Purchased ${Q.product?.title||"a product"}`,time:m(Q.created_at),amount:`RM ${parseFloat(Q.amount).toFixed(2)}`,timestamp:new Date(Q.created_at).getTime()})}),T.data?.forEach(Q=>{et.push({id:Q.id,type:"user_joined",user:Q.name,username:Q.username,action:"Joined the platform",time:m(Q.created_at),timestamp:new Date(Q.created_at).getTime()})}),N.data?.forEach(Q=>{et.push({id:Q.id,type:"product_created",user:Q.users?.username||"Unknown",action:`Created product "${Q.title}"`,time:m(Q.created_at),timestamp:new Date(Q.created_at).getTime()})}),et.sort((Q,tt)=>tt.timestamp-Q.timestamp),r(et.slice(0,8));const Z=[],P=new Date;for(let Q=6;Q>=0;Q--){const tt=new Date(P);tt.setDate(P.getDate()-Q);const ut=tt.toISOString().split("T")[0],B=w.data?.filter($=>$.created_at.startsWith(ut)).reduce(($,st)=>$+parseFloat(st.amount),0)||0;Z.push({date:tt.toLocaleDateString("en-MY",{month:"short",day:"numeric"}),revenue:B})}d(Z)}catch(w){console.error("Error loading dashboard data:",w)}o(!1)}async function g(){const{count:w,error:S}=await Gt.from("users").select("id",{count:"exact",head:!0});return S?0:w||0}function m(w){const S=new Date,E=new Date(w),R=Math.floor((S-E)/1e3);return R<60?"Just now":R<3600?`${Math.floor(R/60)} minutes ago`:R<86400?`${Math.floor(R/3600)} hours ago`:`${Math.floor(R/86400)} days ago`}function b(w){switch(w){case"purchase":return _.jsx(OS,{className:"text-green-500",size:16});case"user_joined":return _.jsx(jS,{className:"text-blue-500",size:16});case"product_created":return _.jsx(uc,{className:"text-purple-500",size:16});default:return _.jsx(Ab,{className:"text-gray-500",size:16})}}function v(w){w.type==="user_joined"&&w.id?c("/users"):w.type==="product_created"&&w.id?c("/products"):w.type==="purchase"&&c("/payments")}const x=Math.max(...u.map(w=>w.revenue),100);return _.jsx(xc,{children:_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Welcome to Admin Dashboard"}),_.jsx("p",{className:"text-gray-500",children:"Here's what's happening with your store today."})]}),a?_.jsx("div",{className:"flex items-center justify-center py-12",children:_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#58C1D1]"})}):_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:24})}),_.jsxs("span",{className:"text-green-500 text-sm font-semibold flex items-center gap-1",children:[_.jsx(xb,{size:16}),"Live"]})]}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Revenue"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",t.totalRevenue.toFixed(2)]}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Platform total income"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-[#7DE0E6] to-[#58C1D1] flex items-center justify-center",children:_.jsx(RS,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Products Sold"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.productsSold}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Total purchases made"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Creator Earnings"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",t.creatorEarnings.toFixed(2)]}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Total earned by creators"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Company Balance"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",t.companyBalance.toFixed(2)]}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Held (before withdrawal)"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:_.jsx(hc,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Users"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.totalUsers}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Registered accounts"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-indigo-500 to-indigo-600 flex items-center justify-center",children:_.jsx(uc,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Active Products"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.activeProducts}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Approved & listed"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Withdrawn"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",t.totalWithdrawn.toFixed(2)]}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Paid out to creators"})]}),_.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-4",children:_.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:24})})}),_.jsx("h3",{className:"text-gray-500 text-sm font-medium mb-1",children:"Pending Withdrawals"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",(t.creatorEarnings-t.totalWithdrawn).toFixed(2)]}),_.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Awaiting payout"})]})]}),_.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[_.jsxs("div",{className:"flex items-center justify-between mb-6",children:[_.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Revenue Last 7 Days"}),_.jsx("span",{className:"text-sm text-gray-500",children:"Daily breakdown"})]}),_.jsx("div",{className:"space-y-3",children:u.map((w,S)=>_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-20 text-sm text-gray-600 font-medium",children:w.date}),_.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-8 relative overflow-hidden",children:_.jsx("div",{className:"bg-gradient-to-r from-[#58C1D1] to-[#4AA8B8] h-full rounded-full transition-all duration-500 flex items-center justify-end pr-3",style:{width:`${w.revenue/x*100}%`},children:w.revenue>0&&_.jsxs("span",{className:"text-white text-xs font-semibold",children:["RM ",w.revenue.toFixed(2)]})})})]},S))})]}),_.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[_.jsxs("div",{className:"flex items-center justify-between mb-6",children:[_.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Recent Activity"}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),_.jsx("span",{className:"text-sm text-gray-500",children:"Live Updates"})]})]}),_.jsx("div",{className:"space-y-3",children:s.length===0?_.jsx("p",{className:"text-gray-500 text-center py-8",children:"No recent activity"}):s.map((w,S)=>_.jsxs("div",{onClick:()=>v(w),className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition-colors cursor-pointer border border-transparent hover:border-gray-200",children:[_.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[_.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center text-white font-semibold flex-shrink-0",children:w.user.split(" ").map(E=>E[0]).join("").slice(0,2)}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[b(w.type),_.jsx("p",{className:"font-medium text-gray-800 truncate",children:w.user})]}),_.jsx("p",{className:"text-sm text-gray-500 truncate",children:w.action})]})]}),_.jsxs("div",{className:"text-right flex-shrink-0 ml-4",children:[w.amount&&_.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:w.amount}),_.jsx("p",{className:"text-xs text-gray-500",children:w.time}),_.jsx(_b,{className:"text-[#58C1D1] ml-auto mt-1",size:14})]})]},S))})]})]})]})})}const Be=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ud=[.001,0,0,.001,0,0],gd=1.35,os={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Gi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},no="pdfjs_internal_editor_",At={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Dt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},lT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Re={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ac={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Cr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Tc={ERRORS:0,WARNINGS:1,INFOS:5},ro={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Xl={moveTo:0,lineTo:1,curveTo:2,closePath:3},cT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Cc=Tc.WARNINGS;function uT(c){Number.isInteger(c)&&(Cc=c)}function hT(){return Cc}function Rc(c){Cc>=Tc.INFOS&&console.info(`Info: ${c}`)}function _t(c){Cc>=Tc.WARNINGS&&console.warn(`Warning: ${c}`)}function Vt(c){throw new Error(c)}function Mt(c,t){c||Vt(t)}function dT(c){switch(c?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function yv(c,t=null,e=null){if(!c)return null;if(e&&typeof c=="string"&&(e.addDefaultProtocol&&c.startsWith("www.")&&c.match(/\./g)?.length>=2&&(c=`http://${c}`),e.tryConvertEncoding))try{c=yT(c)}catch{}const s=t?URL.parse(c,t):URL.parse(c);return dT(s)?s:null}function bv(c,t,e=!1){const s=URL.parse(c);return s?(s.hash=t,s.href):e&&yv(c,"http://example.com")?c.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Tt(c,t,e,s=!1){return Object.defineProperty(c,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const Dn=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class R0 extends Dn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class pd extends Dn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Id extends Dn{constructor(t){super(t,"InvalidPDFException")}}class yc extends Dn{constructor(t,e,s){super(t,"ResponseException"),this.status=e,this.missing=s}}class fT extends Dn{constructor(t){super(t,"FormatError")}}class Xi extends Dn{constructor(t){super(t,"AbortException")}}function vv(c){(typeof c!="object"||c?.length===void 0)&&Vt("Invalid argument for bytesToString");const t=c.length,e=8192;if(t<e)return String.fromCharCode.apply(null,c);const s=[];for(let r=0;r<t;r+=e){const a=Math.min(r+e,t),o=c.subarray(r,a);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function go(c){typeof c!="string"&&Vt("Invalid argument for stringToBytes");const t=c.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=c.charCodeAt(s)&255;return e}function gT(c){return String.fromCharCode(c>>24&255,c>>16&255,c>>8&255,c&255)}function pT(){const c=new Uint8Array(4);return c[0]=1,new Uint32Array(c.buffer,0,1)[0]===1}function mT(){try{return new Function(""),!0}catch{return!1}}class De{static get isLittleEndian(){return Tt(this,"isLittleEndian",pT())}static get isEvalSupported(){return Tt(this,"isEvalSupported",mT())}static get isOffscreenCanvasSupported(){return Tt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Tt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Tt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Tt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const md=Array.from(Array(256).keys(),c=>c.toString(16).padStart(2,"0"));class at{static makeHexColor(t,e,s){return`#${md[t]}${md[e]}${md[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,s=0){const r=t[s],a=t[s+1];t[s]=r*e[0]+a*e[2]+e[4],t[s+1]=r*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,s=0){const r=e[0],a=e[1],o=e[2],u=e[3],d=e[4],f=e[5];for(let g=0;g<6;g+=2){const m=t[s+g],b=t[s+g+1];t[s+g]=m*r+b*o+d,t[s+g+1]=m*a+b*u+f}}static applyInverseTransform(t,e){const s=t[0],r=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(s*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-s*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,s){const r=e[0],a=e[1],o=e[2],u=e[3],d=e[4],f=e[5],g=t[0],m=t[1],b=t[2],v=t[3];let x=r*g+d,w=x,S=r*b+d,E=S,R=u*m+f,T=R,N=u*v+f,D=N;if(a!==0||o!==0){const M=a*g,L=a*b,G=o*m,X=o*v;x+=G,E+=G,S+=X,w+=X,R+=M,D+=M,N+=L,T+=L}s[0]=Math.min(s[0],x,S,w,E),s[1]=Math.min(s[1],R,N,T,D),s[2]=Math.max(s[2],x,S,w,E),s[3]=Math.max(s[3],R,N,T,D)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const s=t[0],r=t[1],a=t[2],o=t[3],u=s**2+r**2,d=s*a+r*o,f=a**2+o**2,g=(u+f)/2,m=Math.sqrt(g**2-(u*f-d**2));e[0]=Math.sqrt(g+m||1),e[1]=Math.sqrt(g-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>r)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>o?null:[s,a,r,o]}static pointBoundingBox(t,e,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],e),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],e)}static rectBoundingBox(t,e,s,r,a){a[0]=Math.min(a[0],t,s),a[1]=Math.min(a[1],e,r),a[2]=Math.max(a[2],t,s),a[3]=Math.max(a[3],e,r)}static#t(t,e,s,r,a,o,u,d,f,g){if(f<=0||f>=1)return;const m=1-f,b=f*f,v=b*f,x=m*(m*(m*t+3*f*e)+3*b*s)+v*r,w=m*(m*(m*a+3*f*o)+3*b*u)+v*d;g[0]=Math.min(g[0],x),g[1]=Math.min(g[1],w),g[2]=Math.max(g[2],x),g[3]=Math.max(g[3],w)}static#e(t,e,s,r,a,o,u,d,f,g,m,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,s,r,a,o,u,d,-m/g,b);return}const v=g**2-4*m*f;if(v<0)return;const x=Math.sqrt(v),w=2*f;this.#t(t,e,s,r,a,o,u,d,(-g+x)/w,b),this.#t(t,e,s,r,a,o,u,d,(-g-x)/w,b)}static bezierBoundingBox(t,e,s,r,a,o,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,s,a,u,e,r,o,d,3*(-t+3*(s-a)+u),6*(t-2*s+a),3*(s-t),f),this.#e(t,s,a,u,e,r,o,d,3*(-e+3*(r-o)+d),6*(e-2*r+o),3*(r-e),f)}}function yT(c){return decodeURIComponent(escape(c))}let yd=null,N0=null;function bT(c){return yd||(yd=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,N0=new Map([["","t"]])),c.replaceAll(yd,(t,e,s)=>e?e.normalize("NFKC"):N0.get(s))}function wv(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const c=new Uint8Array(32);return crypto.getRandomValues(c),vv(c)}const yf="pdfjs_internal_id_";function vT(c,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[s,r,...a]=e;if(!c(s)&&!Number.isInteger(s)||!t(r))return!1;const o=a.length;let u=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const d of a)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Ue(c,t,e){return Math.min(Math.max(c,t),e)}function _v(c){return Uint8Array.prototype.toBase64?c.toBase64():btoa(vv(c))}function wT(c){return Uint8Array.fromBase64?Uint8Array.fromBase64(c):go(atob(c))}typeof Promise.try!="function"&&(Promise.try=function(c,...t){return new Promise(e=>{e(c(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(c){return c.reduce((t,e)=>t+e,0)});class ao{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function r(a){if(!a)return;let o=null;const u=a.name;if(u==="#text")o=a.value;else if(ao.shouldBuildText(u))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&e.push({str:o}),!!a.children)for(const d of a.children)r(d)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Av{static setupStorage(t,e,s,r,a){const o=r.getValue(e,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),a==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?t.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{r.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),a==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const u of s.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:r,linkService:a}){const{attributes:o}=e,u=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[d,f]of Object.entries(o))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&a.addLinkAttributes(t,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(t,o.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,r=t.xfaHtml,a=t.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:a,linkService:s});const u=a!=="richText",d=t.div;if(d.append(o),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=m}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);o.append(m),u&&ao.shouldBuildText(r.name)&&f.push(m)}return{textDivs:f}}const g=[[r,-1,o]];for(;g.length>0;){const[m,b,v]=g.at(-1);if(b+1===m.children.length){g.pop();continue}const x=m.children[++g.at(-1)[1]];if(x===null)continue;const{name:w}=x;if(w==="#text"){const E=document.createTextNode(x.value);f.push(E),v.append(E);continue}const S=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,w):document.createElement(w);if(v.append(S),x.attributes&&this.setAttributes({html:S,element:x,storage:e,intent:a,linkService:s}),x.children?.length>0)g.push([x,-1,S]);else if(x.value){const E=document.createTextNode(x.value);u&&ao.shouldBuildText(w)&&f.push(E),S.append(E)}}for(const m of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const ui="http://www.w3.org/2000/svg";class Fr{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function po(c,t="text"){if(Xa(c,document.baseURI)){const e=await fetch(c);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const r=new XMLHttpRequest;r.open("GET",c,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class mo{constructor({viewBox:t,userUnit:e,scale:s,rotation:r,offsetX:a=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=r,this.offsetX=a,this.offsetY=o,s*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,m,b,v;switch(r%=360,r<0&&(r+=360),r){case 180:g=-1,m=0,b=0,v=1;break;case 90:g=0,m=1,b=1,v=0;break;case 270:g=0,m=-1,b=-1,v=0;break;case 0:g=1,m=0,b=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,v=-v);let x,w,S,E;g===0?(x=Math.abs(f-t[1])*s+a,w=Math.abs(d-t[0])*s+o,S=(t[3]-t[1])*s,E=(t[2]-t[0])*s):(x=Math.abs(d-t[0])*s+a,w=Math.abs(f-t[1])*s+o,S=(t[2]-t[0])*s,E=(t[3]-t[1])*s),this.transform=[g*s,m*s,b*s,v*s,x-g*s*d-b*s*f,w-m*s*d-v*s*f],this.width=S,this.height=E}get rawDims(){const t=this.viewBox;return Tt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new mo({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:a})}convertToViewportPoint(t,e){const s=[t,e];return at.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const e=[t[0],t[1]];at.applyTransform(e,this.transform);const s=[t[2],t[3]];return at.applyTransform(s,this.transform),[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){const s=[t,e];return at.applyInverseTransform(s,this.transform),s}}class bf extends Dn{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Nc(c){const t=c.length;let e=0;for(;e<t&&c[e].trim()==="";)e++;return c.substring(e,e+5).toLowerCase()==="data:"}function vf(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function _T(c){return[c]=c.split(/[#?]/,1),c.substring(c.lastIndexOf("/")+1)}function AT(c,t="document.pdf"){if(typeof c!="string")return t;if(Nc(c))return _t('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(c);if(!s)return t;const r=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},a=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(a.test(o))return r(o);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(a.test(f))return r(f);const d=Array.from(s.searchParams.keys()).reverse();for(const f of d)if(a.test(f))return r(f)}if(s.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(d)return r(d[0])}return t}class O0{started=Object.create(null);times=[];time(t){t in this.started&&_t(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||_t(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:r,end:a}of this.times)t.push(`${s.padEnd(e)} ${a-r}ms
`);return t.join("")}}function Xa(c,t){const e=t?URL.parse(c,t):URL.parse(c);return e?.protocol==="http:"||e?.protocol==="https:"}function Ss(c){c.preventDefault()}function ae(c){c.preventDefault(),c.stopPropagation()}function xT(c){console.log("Deprecated API usage: "+c)}class zd{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,f==="-"?(o+=g,u+=m):f==="+"&&(o-=g,u-=m),new Date(Date.UTC(s,r,a,o,u,d))}}function ST(c,{scale:t=1,rotation:e=0}){const{width:s,height:r}=c.attributes.style,a=[0,0,parseInt(s),parseInt(r)];return new mo({viewBox:a,userUnit:1,scale:t,rotation:e})}function yo(c){if(c.startsWith("#")){const t=parseInt(c.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(t=>parseInt(t)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(_t(`Not a valid color format: "${c}"`),[0,0,0])}function ET(c){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of c.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;c.set(e,yo(s))}t.remove()}function te(c){const{a:t,b:e,c:s,d:r,e:a,f:o}=c.getTransform();return[t,e,s,r,a,o]}function Is(c){const{a:t,b:e,c:s,d:r,e:a,f:o}=c.getTransform().invertSelf();return[t,e,s,r,a,o]}function On(c,t,e=!1,s=!0){if(t instanceof mo){const{pageWidth:r,pageHeight:a}=t.rawDims,{style:o}=c,u=De.isCSSRoundSupported,d=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${a}px`,g=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,m=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(o.width=g,o.height=m):(o.width=m,o.height=g)}s&&c.setAttribute("data-main-rotation",t.rotation)}class $s{constructor(){const{pixelRatio:t}=$s;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,s,r,a=-1){let o=1/0,u=1/0,d=1/0;s=$s.capPixels(s,a),s>0&&(o=Math.sqrt(s/(t*e))),r!==-1&&(u=r/t,d=r/e);const f=Math.min(o,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,s):s}return t}}const Fd=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class TT{static get isDarkMode(){return Tt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class CT{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),Tt(this,"commentForegroundColor",yo(s))}}function RT(c,t,e,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return c=Math.round(c*s+r),t=Math.round(t*s+r),e=Math.round(e*s+r),[c,t,e]}function k0(c,t){const e=c[0]/255,s=c[1]/255,r=c[2]/255,a=Math.max(e,s,r),o=Math.min(e,s,r),u=(a+o)/2;if(a===o)t[0]=t[1]=0;else{const d=a-o;switch(t[1]=u<.5?d/(a+o):d/(2-a-o),a){case e:t[0]=((s-r)/d+(s<r?6:0))*60;break;case s:t[0]=((r-e)/d+2)*60;break;case r:t[0]=((e-s)/d+4)*60;break}}t[2]=u}function Hd(c,t){const e=c[0],s=c[1],r=c[2],a=(1-Math.abs(2*r-1))*s,o=a*(1-Math.abs(e/60%2-1)),u=r-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+u,t[1]=o+u,t[2]=u;break;case 1:t[0]=o+u,t[1]=a+u,t[2]=u;break;case 2:t[0]=u,t[1]=a+u,t[2]=o+u;break;case 3:t[0]=u,t[1]=o+u,t[2]=a+u;break;case 4:t[0]=o+u,t[1]=u,t[2]=a+u;break;case 5:case 6:t[0]=a+u,t[1]=u,t[2]=o+u;break}}function D0(c){return c<=.03928?c/12.92:((c+.055)/1.055)**2.4}function M0(c,t,e){Hd(c,e),e.map(D0);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];Hd(t,e),e.map(D0);const r=.2126*e[0]+.7152*e[1]+.0722*e[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const j0=new Map;function NT(c,t){const e=c[0]+c[1]*256+c[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=j0.get(e);if(s)return s;const r=new Float32Array(9),a=r.subarray(0,3),o=r.subarray(3,6);k0(c,o);const u=r.subarray(6,9);k0(t,u);const d=u[2]<.5,f=d?12:4.5;if(o[2]=d?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),M0(o,u,a)<f){let g,m;d?(g=o[2],m=1):(g=0,m=o[2]);const b=.005;for(;m-g>b;){const v=o[2]=(g+m)/2;d===M0(o,u,a)<f?g=v:m=v}o[2]=d?m:g}return Hd(o,a),s=at.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),j0.set(e,s),s}function xv({html:c,dir:t,className:e},s){const r=document.createDocumentFragment();if(typeof c=="string"){const a=document.createElement("p");a.dir=t||"auto";const o=c.split(/(?:\r\n?|\n)/);for(let u=0,d=o.length;u<d;++u){const f=o[u];a.append(document.createTextNode(f)),u<d-1&&a.append(document.createElement("br"))}r.append(a)}else Av.render({xfaHtml:c,div:r,intent:"richText"});r.firstChild.classList.add("richText",e),s.append(r)}class Za{#t=null;#e=null;#i;#s=null;#a=null;#n=null;#r=null;#o=null;static#c=null;constructor(t){this.#i=t,Za.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Ss,{signal:e}),t.addEventListener("pointerdown",Za.#l,{signal:e}));const s=this.#s=document.createElement("div");s.className="buttons",t.append(s);const r=this.#i.toolbarPosition;if(r){const{style:a}=t,o=this.#i._uiManager.direction==="ltr"?1-r[0]:r[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,ae(t)}#h(t){this.#i._focusEventsAllowed=!0,ae(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ss,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#n?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",Za.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#s.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#s.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#n)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#r=this.#m;e?(this.#s.insertBefore(s,e),this.#s.insertBefore(r,e)):this.#s.append(s,r),this.#n=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#s.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#s.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#n?.removeToolbarCommentButton(),this.#n=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,s){const r=this.#s.querySelector(s);r&&t==="comment"&&this.addComment(e,r)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class OT{#t=null;#e=null;#i;constructor(t){this.#i=t}#s(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Ss,{signal:e});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#i.hasCommentManager()&&this.#n("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#n("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#a(t,e){let s=0,r=0;for(const a of t){const o=a.y+a.height;if(o<s)continue;const u=a.x+(e?a.width:0);if(o>s){r=u,s=o;continue}e?u>r&&(r=u):u<r&&(r=u)}return[e?1-r:r,s]}show(t,e,s){const[r,a]=this.#a(e,s),{style:o}=this.#e||=this.#s();t.append(this.#e),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(t,e,s,r){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",Ss,{signal:u}),a.addEventListener("click",r,{signal:u})),this.#t.append(a)}}function Sv(c,t,e){for(const s of e)t.addEventListener(s,c[s].bind(c))}class kT{#t=0;get id(){return`${no}${this.#t++}`}}class wf{#t=wv();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const a=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Tt(this,"_isSVGFittingCanvas",a)}async#s(t,e){this.#i||=new Map;let s=this.#i.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(s.url=e,r=await po(e,"blob")):e instanceof File?r=s.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const a=wf._isSVGFittingCanvas,o=new FileReader,u=new Image,d=new Promise((f,g)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},o.onload=async()=>{const m=s.svgUrl=o.result;u.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},u.onerror=o.onerror=g});o.readAsDataURL(r),await d}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){_t(r),s=null}return this.#i.set(t,s),s&&this.#i.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:r,type:a}=t;return this.#s(`${e}_${s}_${r}_${a}`,t)}async getFromUrl(t){return this.#s(t,t)}async getFromBlob(t,e){const s=await e;return this.#s(t,s)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let s=this.#i.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,s),this.#i.set(s.id,s),s}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class DT{#t=[];#e=!1;#i;#s=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:s,mustExec:r,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const d={cmd:t,undo:e,post:s,type:a};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(d);return}if(o&&this.#t[this.#s].type===a){u&&(d.undo=this.#t[this.#s].undo),this.#t[this.#s]=d;return}const f=this.#s+1;f===this.#i?this.#t.splice(0,1):(this.#s=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#s===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1,this.#s-=1}redo(){if(this.#s<this.#t.length-1){this.#s+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}cleanType(t){if(this.#s!==-1){for(let e=this.#s;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#s-e),this.#s=e;return}this.#t.length=0,this.#s=-1}}destroy(){this.#t=null}}class bo{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=De.platform;for(const[s,r,a={}]of t)for(const o of s){const u=o.startsWith("mac+");e&&u?(this.callbacks.set(o.slice(4),{callback:r,options:a}),this.allKeys.add(o.split("+").at(-1))):!e&&!u&&(this.callbacks.set(o,{callback:r,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:r,options:{bubbles:a=!1,args:o=[],checker:u=null}}=s;u&&!u(t,e)||(r.bind(t,...o,e)(),a||ae(e))}}class _f{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return ET(t),Tt(this,"_colors",t)}convert(t){const e=yo(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,r]of this._colors)if(r.every((a,o)=>a===e[o]))return _f._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?at.makeHexColor(...e):t}}class Ki{#t=new AbortController;#e=null;#i=null;#s=new Map;#a=new Map;#n=null;#r=null;#o=null;#c=new DT;#l=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#x=null;#w=null;#C=null;#A=!1;#S=null;#O=new kT;#R=!1;#N=!1;#B=!1;#D=null;#j=null;#U=null;#L=null;#q=null;#T=At.NONE;#_=new Set;#M=null;#I=null;#F=null;#Y=null;#V=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#G=null;#J=null;#Z=null;#z=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ki.prototype,e=o=>o.#G.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new bo([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#G.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#G.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,s,r,a,o,u,d,f,g,m,b,v,x,w,S){const E=this._signal=this.#t.signal;this.#G=t,this.#J=e,this.#Z=s,this.#n=r,this.#l=a,this.#I=o,this.#V=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#N=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#N=!1},{capture:!0,signal:E}),this.#lt(),this.#dt(),this.#et(),this.#r=d.annotationStorage,this.#E=d.filterFactory,this.#F=f,this.#C=g||null,this.#y=m,this.#v=b,this.#b=v,this.#q=x||null,this.viewParameters={realScale:Fr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=S!==!1,a?.setSidebarUiManager(this)}destroy(){this.#z?.resolve(),this.#z=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#s.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#_.clear(),this.#c.destroy(),this.#n?.destroy(),this.#l?.destroy(),this.#I?.destroy(),this.#S?.hide(),this.#S=null,this.#U?.destroy(),this.#U=null,this.#i=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#V=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return Tt(this,"hcmFilter",this.#F?this.#E.addHCMFilter(this.#F.foreground,this.#F.background):"none")}get direction(){return Tt(this,"direction",getComputedStyle(this.#G).direction)}get _highlightColors(){return Tt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Tt(this,"highlightColors",null);const e=new Map,s=!!this.#F;for(const[r,a]of t){const o=r.endsWith("_HCM");if(s&&o){e.set(r.replace("_HCM",""),a);continue}!s&&!o&&e.set(r,a)}return Tt(this,"highlightColors",e)}get highlightColorNames(){return Tt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#U=t}editAltText(t,e=!1){this.#n?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,s,r){this.#l?.showDialog(this,t,e,s,r)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,s=void 0){this.#l?.toggleCommentPopup(t,e,s)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:s}=Promise.withResolvers(),r=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",r),e())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#I?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#I}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#G.focus()}findParent(t,e){for(const s of this.#a.values()){const{x:r,y:a,width:o,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+o&&e>=a&&e<=a+u)return s}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Fr.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#a.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",e=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:a,focusNode:o,focusOffset:u}=s,d=s.toString(),g=this.#Q(s).closest(".textLayer"),m=this.getSelectionBoxes(g);if(!m)return;s.empty();const b=this.#tt(g),v=this.#T===At.NONE,x=()=>{const w=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:r,anchorOffset:a,focusNode:o,focusOffset:u,text:d});v&&this.showAllEditors("highlight",!0,!0),e&&w?.editComment()};if(v){this.switchToMode(At.HIGHLIGHT,x);return}x()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Q(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#S||=new OT(this),this.#S.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${no}${t}`,s=this.#r.getRawValue(e);return s&&this.#r.remove(e),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const s=this.#Z;s&&(s.setAttribute("data-l10n-id",t),e?s.setAttribute("data-l10n-args",JSON.stringify(e)):s.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#M&&(this.#S?.hide(),this.#M=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#M)return;const r=this.#Q(t).closest(".textLayer");if(!r){this.#M&&(this.#S?.hide(),this.#M=null,this.#k({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#M=e,this.#k({hasSelectedText:!0}),!(this.#T!==At.HIGHLIGHT&&this.#T!==At.NONE)&&(this.#T===At.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#T===At.HIGHLIGHT?this.#tt(r):null;if(a?.toggleDrawing(),this.#N){const o=new AbortController,u=this.combinedSignal(o),d=f=>{f.type==="pointerup"&&f.button!==0||(o.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else a?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===At.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#_)if(e.div.contains(t)){this.#j=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#j)return;const[t,e]=this.#j;this.#j=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#D)return;this.#D=new AbortController;const t=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#D?.abort(),this.#D=null}#st(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#it(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#st()}removeEditListeners(){this.#ht(),this.#it()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#_){const r=s.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(a){_t(`paste: "${a.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const a=[];for(const d of s){const f=await r.deserialize(d);if(!f)return;a.push(f)}const o=()=>{for(const d of a)this.#nt(d);this.#rt(a)},u=()=>{for(const d of a)d.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(a){_t(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==At.NONE&&!this.isEditorHandlingKeyboard&&Ki._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#k(t){Object.entries(t).some(([s,r])=>this.#X[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===At.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[Dt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#st(),this.#k({isEditing:this.#T!==At.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#it(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,s=!1,r=!1,a=!1){if(this.#T!==t&&!(this.#z&&(await this.#z.promise,!this.#z))){if(this.#z=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===At.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===At.NONE){this.setEditingState(!1),this.#gt();for(const o of this.#s.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#z.resolve();return}for(const o of this.#s.values())o.addStandaloneCommentButton();t===At.SIGNATURE&&await this.#I?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const o of this.#a.values())o.updateMode(t);if(t===At.POPUP){this.#i||=await this.#V.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const o=new Set,u=[];for(const d of this.#s.values()){const{annotationElementId:f,hasComment:g,deleted:m}=d;f&&o.add(f),g&&!m&&u.push(d.getData())}for(const d of this.#i){const{id:f,popupRef:g,contentsObj:m}=d;g&&m?.str&&!o.has(f)&&!this.#m.has(f)&&u.push(d)}this.#l?.showSidebar(u)}if(!e){s&&this.addNewEditorFromKeyboard(),this.#z.resolve();return}for(const o of this.#s.values())o.uid===e?(this.setSelected(o),a?o.editComment():r?o.enterInEditMode():o.focus()):o.unselect();this.#z.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case Dt.CREATE:this.currentLayer.addNewEditor(e);return;case Dt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const s of this.#_)s.updateParams(t,e);else for(const s of this.#u)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const a of this.#s.values())a.editorType===t&&a.show(e);(this.#Y?.get(Dt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[Dt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#B!==t){this.#B=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#s.values())e.enable()}}#gt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#a.values())t.disable();for(const t of this.#s.values())t.disable()}}*getEditors(t){for(const e of this.#s.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#s.get(t)}addEditor(t){this.#s.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#s.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#_);return t}updateUI(t){this.#pt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#_.has(t)){this.#_.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#_.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#h?.commitOrRemove();for(const e of this.#_)e!==t&&e.unselect();this.#_.clear(),this.#_.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#_.has(t)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(t){t.unselect(),this.#_.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#k({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const t of this.#s.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#_],s=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},r=()=>{for(const a of e)this.#nt(a)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#_)e.unselect();this.#_.clear();for(const e of t)e.isEmpty()||(this.#_.add(e),e.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#_)t.commit();this.#rt(this.#s.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==At.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#_)t.unselect();this.#_.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[r,a]=this.#H,o=[...this.#_],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of o)this.#s.has(d.id)&&(d.translateInPage(r,a),d.translationDone())},undo:()=>{for(const d of o)this.#s.has(d.id)&&(d.translateInPage(-r,-a),d.translationDone())},mustExec:!1})},u);for(const d of o)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#_)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:r,y:a,pageIndex:o},u]of t)u.newX=r,u.newY=a,u.newPageIndex=o,e||=r!==u.savedX||a!==u.savedY||o!==u.savedPageIndex;if(!e)return!1;const s=(r,a,o,u)=>{if(this.#s.has(r.id)){const d=this.#a.get(u);d?r._setParentAndPosition(d,a,o):(r.pageIndex=u,r.x=a,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:a,newY:o,newPageIndex:u}]of t)s(r,a,o,u)},undo:()=>{for(const[r,{savedX:a,savedY:o,savedPageIndex:u}]of t)s(r,a,o,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const s of this.#g.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==At.NONE}get imageManager(){return Tt(this,"imageManager",new wf)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:a,height:o}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,g,m,b)=>({x:(g-r)/o,y:1-(f+m-s)/a,width:b/o,height:m/a});break;case"180":u=(f,g,m,b)=>({x:1-(f+m-s)/a,y:1-(g+b-r)/o,width:m/a,height:b/o});break;case"270":u=(f,g,m,b)=>({x:1-(g+b-r)/o,y:(f-s)/a,width:b/o,height:m/a});break;default:u=(f,g,m,b)=>({x:(f-s)/a,y:(g-r)/o,width:m/a,height:b/o});break}const d=[];for(let f=0,g=e.rangeCount;f<g;f++){const m=e.getRangeAt(f);if(!m.collapsed)for(const{x:b,y:v,width:x,height:w}of m.getClientRects())x===0||w===0||d.push(u(b,v,x,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const s=this.#r.getRawValue(e);s&&(this.#T===At.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,e,s){const r=this.#L?.get(t);r&&(r.setCanvas(e,s),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class Hs{#t=null;#e=!1;#i=null;#s=null;#a=null;#n=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Hs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Hs._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#s=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Hs.#f.missing),e.setAttribute("data-l10n-id",Hs.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ss,{signal:s}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:s});const r=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#r=!0,r(a))},{signal:s}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Hs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:r,cancel:a=!1}){s&&(this.#l=s,this.#d=r),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#g())}toggle(t=!1){this.#i&&(!t&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#s=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Hs.#f[this.#m]),this.#s?.setAttribute("data-l10n-id",Hs.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const r=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#a?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Kl{#t=null;#e=null;#i=!1;#s=null;#a=null;#n=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#s=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#s.commentButtonPosition;if(e){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#s._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const r=this.#s.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#s.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#s._uiManager.updatePopupColor(this.#s)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#s.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:s}=this.#t.getBoundingClientRect(),{x:r,y:a,width:o,height:u}=this.#s.parent.boundingClientRect;return[(t-r)/o,(e+s-a)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#s._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#s._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=this.#s._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ss,{signal:s}),e&&(t.addEventListener("focusin",a=>{this.#s._focusEventsAllowed=!1,ae(a)},{capture:!0,signal:s}),t.addEventListener("focusout",a=>{this.#s._focusEventsAllowed=!0,ae(a)},{capture:!0,signal:s})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:s});const r=a=>{a.preventDefault(),t===this.#e?this.edit():this.#s.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#i=!0,r(a))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#s.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#s.toggleComment(!1,!1)},{signal:s}),t}edit(t){const e=this.commentPopupPositionInLayer;let s,r;if(e)[s,r]=e;else{[s,r]=this.#s.commentButtonPosition;const{width:g,height:m,x:b,y:v}=this.#s;s=b+s*g,r=v+r*m}const a=this.#s.parent.boundingClientRect,{x:o,y:u,width:d,height:f}=a;this.#s._uiManager.editComment(this.#s,o+s*d,u+r*f,{...t,parentDimensions:a})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#n,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#n=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#n=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#n=null,this.#o=null,this.#s=null,this.#i=!1,this.#c=!1}}class Oc{#t;#e=!1;#i=null;#s;#a;#n;#r;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:a=null,onPinchEnd:o=null,signal:u}){this.#t=t,this.#i=s,this.#s=e,this.#a=r,this.#n=a,this.#r=o,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/$s.pixelRatio}#f(t){if(this.#s?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,a=AbortSignal.any([this.#c,r.signal]),o=this.#t,u={capture:!0,signal:a,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ae(f),d(f))},u),o.addEventListener("pointerup",d,u),o.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),a=this.#t,o={signal:r,capture:!1,passive:!1};a.addEventListener("touchmove",this.#m.bind(this),o);const u=this.#g.bind(this);a.addEventListener("touchend",u,o),a.addEventListener("touchcancel",u,o),o.capture=!0,a.addEventListener("pointerdown",ae,o),a.addEventListener("pointermove",ae,o),a.addEventListener("pointercancel",ae,o),a.addEventListener("pointerup",ae,o),this.#a?.()}if(ae(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;ae(t);let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:r,screenY:a}=e,{screenX:o,screenY:u}=s,d=this.#l,{touch0X:f,touch0Y:g,touch1X:m,touch1Y:b}=d,v=m-f,x=b-g,w=o-r,S=u-a,E=Math.hypot(w,S)||1,R=Math.hypot(v,x)||1;if(!this.#e&&Math.abs(R-E)<=Oc.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=r,d.touch0Y=a,d.touch1X=o,d.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+o)/2,(a+u)/2];this.#n?.(T,R,E)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(ae(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class dt{#t=null;#e=null;#i=null;#s=null;#a=null;#n=!1;#r=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#x=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#S=dt._zIndex++;static _borderLineWidth=-1;static _colorManager=new _f;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=dt.prototype._resizeWithKeyboard,e=Ki.TRANSLATE_SMALL,s=Ki.TRANSLATE_BIG;return Tt(this,"_resizerKeyboardManager",new bo([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],dt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[a,o];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Tt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new MT({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(dt._l10n??=t,dt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),dt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);dt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Vt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,r){const[a,o]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/a,this.y=(e+r)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[s,r]=this.parentDimensions;this.setAt(t*s,e*r,this.width*s,this.height*r),this._onTranslated()}#O([t,e],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,a]}=this;if(this.x+=t/r,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[d,f]=this.getBaseTranslation();o+=d,u+=f;const{style:g}=s;g.left=`${(100*o).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=dt,r=s/t,a=s/e;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,r]}=this;let{x:a,y:o,width:u,height:d}=this;if(u*=s,d*=r,a*=s,o*=r,this._mustFixPosition)switch(t){case 0:a=Ue(a,0,s-u),o=Ue(o,0,r-d);break;case 90:a=Ue(a,0,s-d),o=Ue(o,u,r);break;case 180:a=Ue(a,u,s),o=Ue(o,d,r);break;case 270:a=Ue(a,d,s),o=Ue(o,0,r-u);break}this.x=a/=s,this.y=o/=r;const[f,g]=this.getBaseTranslation();a+=f,o+=g,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return dt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return dt.#R(t,e,360-this.parentRotation)}#N(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(){const{div:{style:t},width:e,height:s}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#B(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#D.bind(this,s),{signal:e}),r.addEventListener("contextmenu",Ss,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#c)}#D(t,e){e.preventDefault();const{isMac:s}=De.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#i?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ae,{passive:!1,signal:o}),window.addEventListener("contextmenu",Ss,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#U()};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#j(t,e,s,r){this.width=s,this.height=r,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#U(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const a=this.x,o=this.y,u=this.width,d=this.height;a===t&&o===e&&u===s&&d===r||this.addCommands({cmd:this.#j.bind(this,a,o,u,d),undo:this.#j.bind(this,t,e,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#L(t,e){const[s,r]=this.parentDimensions,a=this.x,o=this.y,u=this.width,d=this.height,f=dt.MIN_SIZE/s,g=dt.MIN_SIZE/r,m=this.#N(this.rotation),b=(B,$)=>[m[0]*B+m[2]*$,m[1]*B+m[3]*$],v=this.#N(360-this.rotation),x=(B,$)=>[v[0]*B+v[2]*$,v[1]*B+v[3]*$];let w,S,E=!1,R=!1;switch(t){case"topLeft":E=!0,w=(B,$)=>[0,0],S=(B,$)=>[B,$];break;case"topMiddle":w=(B,$)=>[B/2,0],S=(B,$)=>[B/2,$];break;case"topRight":E=!0,w=(B,$)=>[B,0],S=(B,$)=>[0,$];break;case"middleRight":R=!0,w=(B,$)=>[B,$/2],S=(B,$)=>[0,$/2];break;case"bottomRight":E=!0,w=(B,$)=>[B,$],S=(B,$)=>[0,0];break;case"bottomMiddle":w=(B,$)=>[B/2,$],S=(B,$)=>[B/2,0];break;case"bottomLeft":E=!0,w=(B,$)=>[0,$],S=(B,$)=>[B,0];break;case"middleLeft":R=!0,w=(B,$)=>[0,$/2],S=(B,$)=>[B,$/2];break}const T=w(u,d),N=S(u,d);let D=b(...N);const M=dt._round(a+D[0]),L=dt._round(o+D[1]);let G=1,X=1,et,Z;if(e.fromKeyboard)({deltaX:et,deltaY:Z}=e);else{const{screenX:B,screenY:$}=e,[st,mt]=this.#l;[et,Z]=this.screenToPageTranslation(B-st,$-mt),this.#l[0]=B,this.#l[1]=$}if([et,Z]=x(et/s,Z/r),E){const B=Math.hypot(u,d);G=X=Math.max(Math.min(Math.hypot(N[0]-T[0]-et,N[1]-T[1]-Z)/B,1/u,1/d),f/u,g/d)}else R?G=Ue(Math.abs(N[0]-T[0]-et),f,1)/u:X=Ue(Math.abs(N[1]-T[1]-Z),g,1)/d;const P=dt._round(u*G),Q=dt._round(d*X);D=b(...S(P,Q));const tt=M-D[0],ut=L-D[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=P,this.height=Q,this.x=tt,this.y=ut,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Za(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,s]of t)await this._editToolbar.addButton(e,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Hs.initialize(dt._l10n),this.#i=new Hs(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#s?.focusButton()}addCommentButton(){return this.#s||=new Kl(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#s.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#s.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:s,deleted:r}}=this.#s;return{text:e,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#s||=new Kl(this),this.#s.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:s}){if(!e||(this.#s||=new Kl(this),this.#s.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#s?.hasBeenEdited()}get hasDeletedComment(){return this.#s?.isDeleted()}get hasComment(){return!!this.#s&&!this.#s.isEmpty()&&!this.#s.isDeleted()}async editComment(t){this.#s||=new Kl(this),this.#s.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#s.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,u=o+a+1,d=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#s.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#n?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#F();const[e,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/s).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),Sv(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new Oc({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,s){let a=.7*(s/e)+1-.7;if(a===1)return;const o=this.#N(this.rotation),u=(M,L)=>[o[0]*M+o[2]*L,o[1]*M+o[3]*L],[d,f]=this.parentDimensions,g=this.x,m=this.y,b=this.width,v=this.height,x=dt.MIN_SIZE/d,w=dt.MIN_SIZE/f;a=Math.max(Math.min(a,1/b,1/v),x/b,w/v);const S=dt._round(b*a),E=dt._round(v*a);if(S===b&&E===v)return;this.#u||=[g,m,b,v];const R=u(b/2,v/2),T=dt._round(g+R[0]),N=dt._round(m+R[1]),D=u(S/2,E/2);this.x=T-D[0],this.y=N-D[1],this.width=S,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#U()}pointerdown(t){const{isMac:e}=De.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#I(t);return}this.#M(t)}#M(t){const{isMac:e}=De.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,a=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:a},u=f=>{r.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#M(f),s&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#x=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:m,pointerId:b}=f;if(b!==this.#r){ae(f);return}const[v,x]=this.screenToPageTranslation(g-this.#E,m-this.#x);this.#E=g,this.#x=m,this._uiManager.dragSelectedEditors(v,x)},o),window.addEventListener("touchmove",ae,o),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),ae(f)},o));const d=f=>{if(!this.#r||this.#r===f.pointerId){u(f);return}ae(f)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const r=this.parentScale,[a,o]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/r,g=e/r,m=this.x*a,b=this.y*o,v=this.width*a,x=this.height*o;switch(s){case 0:return[m+f+u,o-b-g-x+d,m+f+v+u,o-b-g+d];case 90:return[m+g+u,o-b+f+d,m+g+x+u,o-b+f+v+d];case 180:return[m-f-v+u,o-b+g+d,m-f+u,o-b+g+x+d];case 270:return[m-g-x+u,o-b-f-v+d,m-g+u,o-b-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,r,a,o]=t,u=a-s,d=o-r;switch(this.rotation){case 0:return[s,e-o,u,d];case 90:return[s,e-r,d,u];case 180:return[a,e-r,u,d];case 270:return[a,e-o,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&dt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#s?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:s,opacity:r,deleted:a,richText:o},uid:u,pageIndex:d,creationDate:f,modificationDate:g}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:o,contentsObj:{str:t},creationDate:f,modificationDate:s||g,popupRef:!a,color:e,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return e<o&&r>0&&t<a&&s>0}#F(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#F()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,s){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[a,o]=r.pageDimensions,[u,d,f,g]=r.getRectInCurrentCoords(t.rect,o);return r.x=u/a,r.y=d/o,r.width=f/a,r.height=g/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#P(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[s,r,a,o]=this.getPDFRect();return[dt._round(s+(a-s)*t),dt._round(r+(o-r)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#s.commentPopupPositionInLayer}set commentPopupPosition(t){this.#s.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#s.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#s.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#s.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const o=this.#Y.bind(this),u=this.#V.bind(this),d=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",o,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,g),{signal:d}),f.setAttribute("data-l10n-id",dt._l10nResizer[g])}}const s=this.#e[0];let r=0;for(const o of e){if(o===s)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==r){if(a<r)for(let u=0;u<r-a;u++)this.#c.append(this.#c.firstChild);else if(a>r)for(let u=0;u<a-r;u++)this.#c.firstChild.before(this.#c.lastChild);let o=0;for(const u of e){const f=this.#e[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",dt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){dt._resizerKeyboardManager.exec(this,t)}#V(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#X(t){this.#m=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#L(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#P(){this.#v=!1,this.#H(-1),this.#U()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:s}=t;let r=this.#w.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},dt._telemetryTimeout),this.#w.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class MT extends dt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const L0=3285377520,_s=4294901760,zs=65535;class Ev{constructor(t){this.h1=t?t&4294967295:L0,this.h2=t?t&4294967295:L0}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let w=0,S=t.length;w<S;w++){const E=t.charCodeAt(w);E<=255?e[s++]=E:(e[s++]=E>>>8,e[s++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,a=s-r*4,o=new Uint32Array(e.buffer,0,r);let u=0,d=0,f=this.h1,g=this.h2;const m=3432918353,b=461845907,v=m&zs,x=b&zs;for(let w=0;w<r;w++)w&1?(u=o[w],u=u*m&_s|u*v&zs,u=u<<15|u>>>17,u=u*b&_s|u*x&zs,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=o[w],d=d*m&_s|d*v&zs,d=d<<15|d>>>17,d=d*b&_s|d*x&zs,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,a){case 3:u^=e[r*4+2]<<16;case 2:u^=e[r*4+1]<<8;case 1:u^=e[r*4],u=u*m&_s|u*v&zs,u=u<<15|u>>>17,u=u*b&_s|u*x&zs,r&1?f^=u:g^=u}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&_s|t*36045&zs,e=e*4283543511&_s|((e<<16|t>>>16)*2950163797&_s)>>>16,t^=e>>>1,t=t*444984403&_s|t*60499&zs,e=e*3301882366&_s|((e<<16|t>>>16)*3120437893&_s)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const $d=Object.freeze({map:null,hash:"",transfer:void 0});class Af{#t=!1;#e=null;#i=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#s.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#s.get(t)}remove(t){const e=this.#s.get(t);if(e!==void 0&&(e instanceof dt&&this.#i.delete(e.annotationElementId),this.#s.delete(t),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#s.values())if(s instanceof dt)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#s.get(t);let r=!1;if(s!==void 0)for(const[a,o]of Object.entries(e))s[a]!==o&&(r=!0,s[a]=o);else r=!0,this.#s.set(t,e);r&&this.#a(),e instanceof dt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#s.has(t)}get size(){return this.#s.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Tv(this)}get serializable(){if(this.#s.size===0)return $d;const t=new Map,e=new Ev,s=[],r=Object.create(null);let a=!1;for(const[o,u]of this.#s){const d=u instanceof dt?u.serialize(!1,r):u;d&&(t.set(o,d),e.update(`${o}:${JSON.stringify(d)}`),a||=!!d.bitmap)}if(a)for(const o of t.values())o.bitmap&&s.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:$d}get editorStats(){let t=null;const e=new Map;let s=0,r=0;for(const a of this.#s.values()){if(!(a instanceof dt)){a.popup&&(a.popup.deleted?r+=1:s+=1);continue}a.isCommentDeleted?r+=1:a.hasEditedComment&&(s+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:u}=o;e.has(u)||e.set(u,Object.getPrototypeOf(a).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,g]of Object.entries(o)){if(f==="type")continue;let m=d.get(f);m||(m=new Map,d.set(f,m));const b=m.get(g)??0;m.set(g,b+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[a,o]of e)t[a]=o.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const s=this.#i?.get(t);return s?(s.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class Tv extends Af{#t;constructor(t){super();const{map:e,hash:s,transfer:r}=t.serializable,a=structuredClone(e,r?{transfer:r}:null);this.#t={map:a,hash:s,transfer:r}}get print(){Vt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Tt(this,"modifiedIds",{ids:new Set,hash:""})}}class jT{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Mt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:a,style:o}=t,u=new FontFace(r,a,o);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{_t(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Vt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw _t(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Tt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Tt(this,"isSyncFontLoadingSupported",Be||De.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Mt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const a=s.shift();setTimeout(a.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:e,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Tt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(N,D){return N.charCodeAt(D)<<24|N.charCodeAt(D+1)<<16|N.charCodeAt(D+2)<<8|N.charCodeAt(D+3)&255}function r(N,D,M,L){const G=N.substring(0,D),X=N.substring(D+M);return G+L+X}let a,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function g(N,D){if(++f>30){_t("Load test font never loaded."),D();return}if(d.font="30px "+N,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(g.bind(null,N,D))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,m.length,m);const x=16,w=1482184792;let S=s(b,x);for(a=0,o=m.length-3;a<o;a+=4)S=S-w+s(m,a)|0;a<m.length&&(S=S-w+s(m+"XXX",a)|0),b=r(b,x,4,gT(S));const E=`url(data:font/opentype;base64,${btoa(b)});`,R=`@font-face {font-family:"${m}";src:${E}}`;this.insertRule(R);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const N of[t.loadedName,m]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=N,T.append(D)}this._document.body.append(T),g(m,()=>{T.remove(),e.complete()})}}class LT{#t;constructor(t,e=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${_v(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let r;try{r=t.get(s)}catch(o){_t(`getPathGenerator - ignoring character: "${o}".`)}const a=new Path2D(r||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=a}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function PT(c){if(c instanceof URL)return c.href;if(typeof c=="string"){if(Be)return c;const t=URL.parse(c,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function BT(c){if(Be&&typeof Buffer<"u"&&c instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength)return c;if(typeof c=="string")return go(c);if(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="object"&&!isNaN(c?.length))return new Uint8Array(c);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Wl(c){if(typeof c!="string")return null;if(c.endsWith("/"))return c;throw new Error(`Invalid factory url: "${c}" must include trailing slash.`)}const qd=c=>typeof c=="object"&&Number.isInteger(c?.num)&&c.num>=0&&Number.isInteger(c?.gen)&&c.gen>=0,UT=c=>typeof c=="object"&&typeof c?.name=="string",IT=vT.bind(null,qd,UT);class zT{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,e,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:a}=s;if(a.aborted){_t("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);r=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Ql={DATA:1,ERROR:2},pe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function P0(){}function Xe(c){if(c instanceof Xi||c instanceof Id||c instanceof R0||c instanceof yc||c instanceof pd)return c;switch(c instanceof Error||typeof c=="object"&&c!==null||Vt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),c.name){case"AbortException":return new Xi(c.message);case"InvalidPDFException":return new Id(c.message);case"PasswordException":return new R0(c.message,c.code);case"ResponseException":return new yc(c.message,c.status,c.missing);case"UnknownErrorException":return new pd(c.message,c.details)}return new pd(c.message,c.toString())}class Ka{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#s(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Ql.DATA)r.resolve(t.data);else if(t.callback===Ql.ERROR)r.reject(Xe(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(o){a.postMessage({sourceName:s,targetName:r,callback:Ql.DATA,callbackId:t.callbackId,data:o})},function(o){a.postMessage({sourceName:s,targetName:r,callback:Ql.ERROR,callbackId:t.callbackId,reason:Xe(o)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const r=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[r]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},s)}catch(o){a.reject(o)}return a.promise}sendWithStream(t,e,s,r){const a=this.streamId++,o=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:u,action:t,streamId:a,data:e,desiredSize:f.desiredSize},r),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[a].pullCall=g,d.postMessage({sourceName:o,targetName:u,stream:pe.PULL,streamId:a,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Mt(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[a].cancelCall=g,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:o,targetName:u,stream:pe.CANCEL,streamId:a,reason:Xe(f)}),g.promise}},s)}#i(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,a=this.comObj,o=this,u=this.actionHandler[t.action],d={enqueue(f,g=1,m){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:s,targetName:r,stream:pe.ENQUEUE,streamId:e,chunk:f},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:s,targetName:r,stream:pe.CLOSE,streamId:e}),delete o.streamSinks[e])},error(f){Mt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:s,targetName:r,stream:pe.ERROR,streamId:e,reason:Xe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){a.postMessage({sourceName:s,targetName:r,stream:pe.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:s,targetName:r,stream:pe.START_COMPLETE,streamId:e,reason:Xe(f)})})}#s(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,a=this.comObj,o=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case pe.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Xe(t.reason));break;case pe.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Xe(t.reason));break;case pe.PULL:if(!u){a.postMessage({sourceName:s,targetName:r,stream:pe.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||P0).then(function(){a.postMessage({sourceName:s,targetName:r,stream:pe.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:s,targetName:r,stream:pe.PULL_COMPLETE,streamId:e,reason:Xe(f)})});break;case pe.ENQUEUE:if(Mt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case pe.CLOSE:if(Mt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,e);break;case pe.ERROR:Mt(o,"error should have stream controller"),o.controller.error(Xe(t.reason)),this.#a(o,e);break;case pe.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Xe(t.reason)),this.#a(o,e);break;case pe.CANCEL:if(!u)break;const d=Xe(t.reason);Promise.try(u.onCancel||P0,d).then(function(){a.postMessage({sourceName:s,targetName:r,stream:pe.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:s,targetName:r,stream:pe.CANCEL_COMPLETE,streamId:e,reason:Xe(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Cv{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Vt("Abstract method `_createCanvas` called.")}}class FT extends Cv{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class Rv{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class B0 extends Rv{async _fetch(t){const e=await po(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):go(e)}}class Nv{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,r,a){return"none"}destroy(t=!1){}}class HT extends Nv{#t;#e;#i;#s;#a;#n;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#s=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#n||=new Map}get#l(){if(!this.#i){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#a.createElementNS(ui,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#i=this.#a.createElementNS(ui,"defs"),t.append(s),s.append(this.#i),this.#a.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let m=0;m<256;m++)f[m]=d[m]/255;const g=f.join(",");return[g,g,g]}const[e,s,r]=t,a=new Array(256),o=new Array(256),u=new Array(256);for(let d=0;d<256;d++)a[d]=e[d]/255,o[d]=s[d]/255,u[d]=r[d]/255;return[a.join(","),o.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Nc(e)?_t('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=bv(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[s,r,a]=this.#d(t),o=t.length===1?s:`${s}${r}${a}`;if(e=this.#o.get(o),e)return this.#o.set(t,e),e;const u=`g_${this.#s}_transfer_map_${this.#r++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(o,d);const f=this.#g(u);return this.#p(s,r,a,f),d}addHCMFilter(t,e){const s=`${t}-${e}`,r="base";let a=this.#c.get(r);if(a?.key===s||(a?(a.filter?.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},this.#c.set(r,a)),!t||!e))return a.url;const o=this.#v(t);t=at.makeHexColor(...o);const u=this.#v(e);if(e=at.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const d=new Array(256);for(let v=0;v<=255;v++){const x=v/255;d[v]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=d.join(","),g=`g_${this.#s}_hcm_filter`,m=a.filter=this.#g(g);this.#p(f,f,f,m),this.#m(m);const b=(v,x)=>{const w=o[v]/255,S=u[v]/255,E=new Array(x+1);for(let R=0;R<=x;R++)E[R]=w+R/x*(S-w);return E.join(",")};return this.#p(b(0,5),b(1,5),b(2,5),m),a.url=this.#h(g),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[s]=this.#d([t]),r=`alpha_${s}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const a=`g_${this.#s}_alpha_map_${this.#r++}`,o=this.#h(a);this.#o.set(t,o),this.#o.set(r,o);const u=this.#g(a);return this.#y(s,u),o}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const a=`g_${this.#s}_luminosity_map_${this.#r++}`,o=this.#h(a);this.#o.set(t,o),this.#o.set(r,o);const u=this.#g(a);return this.#f(u),t&&this.#y(s,u),o}addHighlightHCMFilter(t,e,s,r,a){const o=`${e}-${s}-${r}-${a}`;let u=this.#c.get(t);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#c.set(t,u)),!e||!s))return u.url;const[d,f]=[e,s].map(this.#v.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,v]=[r,a].map(this.#v.bind(this));m<g&&([g,m,b,v]=[m,g,v,b]),this.#l.style.color="";const x=(E,R,T)=>{const N=new Array(256),D=(m-g)/T,M=E/255,L=(R-E)/(255*T);let G=0;for(let X=0;X<=T;X++){const et=Math.round(g+X*D),Z=M+X*L;for(let P=G;P<=et;P++)N[P]=Z;G=et+1}for(let X=G;X<256;X++)N[X]=N[G-1];return N.join(",")},w=`g_${this.#s}_hcm_${t}_filter`,S=u.filter=this.#g(w);return this.#m(S),this.#p(x(b[0],v[0],5),x(b[1],v[1],5),x(b[2],v[2],5),S),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#n?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#n?.clear(),this.#n=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(ui,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(ui,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(ui,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,s){const r=this.#a.createElementNS(ui,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#p(t,e,s,r){const a=this.#a.createElementNS(ui,"feComponentTransfer");r.append(a),this.#u(a,"feFuncR",t),this.#u(a,"feFuncG",e),this.#u(a,"feFuncB",s)}#y(t,e){const s=this.#a.createElementNS(ui,"feComponentTransfer");e.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,yo(getComputedStyle(this.#l).getPropertyValue("color"))}}class Ov{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class U0 extends Ov{async _fetch(t){const e=await po(t,"arraybuffer");return new Uint8Array(e)}}class kv{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class I0 extends kv{async _fetch(t){const e=await po(t,"arraybuffer");return new Uint8Array(e)}}Be&&_t("Please use the `legacy` build in Node.js environments.");async function xf(c){const e=await process.getBuiltinModule("fs").promises.readFile(c);return new Uint8Array(e)}class $T extends Nv{}class qT extends Cv{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class GT extends Rv{async _fetch(t){return xf(t)}}class VT extends Ov{async _fetch(t){return xf(t)}}class YT extends kv{async _fetch(t){return xf(t)}}const xr="__forcedDependency",{floor:z0,ceil:F0}=Math;function Jl(c,t,e,s,r,a){c[t*4+0]=Math.min(c[t*4+0],e),c[t*4+1]=Math.min(c[t*4+1],s),c[t*4+2]=Math.max(c[t*4+2],r),c[t*4+3]=Math.max(c[t*4+3],a)}const Gd=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class XT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Gd}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Zl=(c,t)=>{if(!c)return;let e=c.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},c.set(t,e)),e};class KT{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[xr]:[]};#i=new Map;#s=[];#a=[];#n=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,e,s=!1){this.#f=t.width,this.#m=t.height,this.#y(e),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),e&&e.length>0?(this.#u.set(e),this.#u.fill(Gd,e.length)):this.#u.fill(Gd)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[xr]:{__proto__:this.#e[xr]}},this.#r={__proto__:this.#r},this.#s.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const s=this.#s.pop();return s!==void 0&&(Zl(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#s.push(t),this}getOpenMarker(){return this.#s.length===0?null:this.#s.at(-1)}recordCloseMarker(t){const e=this.#s.pop();return e!==void 0&&(Zl(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(Zl(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#n.push(at.multiplyByDOMMatrix(this.#n.at(-1),t.getTransform())),this}popBaseTransform(){return this.#n.length>1&&this.#n.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,s){this.#t[t]=this.#i.get(e)??s}recordFutureForcedDependency(t,e){return this.recordIncrementalData(xr,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(xr,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,s,r,a,o){const u=at.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];at.axialAlignedBoundingBox([s,a,r,o],u,d);const f=at.intersect(this.#r,d);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,s,r,a,o){const u=this.#r;if(u[0]===1/0)return this;const d=at.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform());if(u[0]===-1/0)return at.axialAlignedBoundingBox([s,a,r,o],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return at.axialAlignedBoundingBox([s,a,r,o],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,s,r=1,a=0,o=0,u){const d=s.bbox;let f,g;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(s),f!==!1&&(g=[0,0,0,0],at.axialAlignedBoundingBox(d,s.fontMatrix,g),(r!==1||a!==0||o!==0)&&at.scaleMinMax([r,0,0,-r,a,o],g),f)))return this.recordBBox(t,e,g[0],g[2],g[1],g[3]);if(!u)return this.recordFullPageBBox(t);const m=u();return d&&g&&f===void 0&&(f=g[0]<=a-m.actualBoundingBoxLeft&&g[2]>=a+m.actualBoundingBoxRight&&g[1]<=o-m.actualBoundingBoxAscent&&g[3]>=o+m.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,e,g[0],g[2],g[1],g[3]):this.recordBBox(t,e,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,o-m.actualBoundingBoxAscent,o+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const s=this.#l,r=this.#t,a=this.#e;for(const o of e)o in this.#t?s.add(r[o]):o in a&&a[o].forEach(s.add,s);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[xr]),this.#p){const s=Zl(this.#p,t),{dependencies:r}=s;this.#l.forEach(r.add,r),this.#s.forEach(r.add,r),this.#a.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=z0(this.#o[0]*256/this.#f),r=z0(this.#o[1]*256/this.#m),a=F0(this.#o[2]*256/this.#f),o=F0(this.#o[3]*256/this.#m);Jl(this.#g,t,s,r,a,o);for(const u of this.#l)u!==t&&Jl(this.#g,u,s,r,a,o);for(const u of this.#s)u!==t&&Jl(this.#g,u,s,r,a,o);for(const u of this.#a)u!==t&&Jl(this.#g,u,s,r,a,o);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const s=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new XT(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class bc{#t;#e;#i;#s=0;#a=0;constructor(t,e,s){if(t instanceof bc&&t.#i===!!s)return t;this.#t=t,this.#e=e,this.#i=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#s++,this}getOpenMarker(){return this.#s>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#s--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,s){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,s,r,a,o){return this.#i||this.#t.recordClipBox(this.#e,e,s,r,a,o),this}recordBBox(t,e,s,r,a,o){return this.#i||this.#t.recordBBox(this.#e,e,s,r,a,o),this}recordCharacterBBox(t,e,s,r,a,o,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,s,r,a,o,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const As={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ke={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Vd(c,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,s),c.clip(r)}class Sf{isModifyingCurrentTransform(){return!1}getPattern(){Vt("Abstract method `getPattern` called.")}}class WT extends Sf{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,r){let a;if(r===ke.STROKE||r===ke.FILL){const o=e.current.getClippedPathBoundingBox(r,te(t))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,d=Math.ceil(o[3]-o[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-o[0],-o[1]),s=at.transform(s,[1,0,0,1,o[0],o[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),Vd(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),a=t.createPattern(f.canvas,"no-repeat");const m=new DOMMatrix(s);a.setTransform(m)}else Vd(t,this._bbox),a=this._createGradient(t);return a}}function bd(c,t,e,s,r,a,o,u){const d=t.coords,f=t.colors,g=c.data,m=c.width*4;let b;d[e+1]>d[s+1]&&(b=e,e=s,s=b,b=a,a=o,o=b),d[s+1]>d[r+1]&&(b=s,s=r,r=b,b=o,o=u,u=b),d[e+1]>d[s+1]&&(b=e,e=s,s=b,b=a,a=o,o=b);const v=(d[e]+t.offsetX)*t.scaleX,x=(d[e+1]+t.offsetY)*t.scaleY,w=(d[s]+t.offsetX)*t.scaleX,S=(d[s+1]+t.offsetY)*t.scaleY,E=(d[r]+t.offsetX)*t.scaleX,R=(d[r+1]+t.offsetY)*t.scaleY;if(x>=R)return;const T=f[a],N=f[a+1],D=f[a+2],M=f[o],L=f[o+1],G=f[o+2],X=f[u],et=f[u+1],Z=f[u+2],P=Math.round(x),Q=Math.round(R);let tt,ut,B,$,st,mt,St,k;for(let V=P;V<=Q;V++){if(V<S){const gt=V<x?0:(x-V)/(x-S);tt=v-(v-w)*gt,ut=T-(T-M)*gt,B=N-(N-L)*gt,$=D-(D-G)*gt}else{let gt;V>R?gt=1:S===R?gt=0:gt=(S-V)/(S-R),tt=w-(w-E)*gt,ut=M-(M-X)*gt,B=L-(L-et)*gt,$=G-(G-Z)*gt}let J;V<x?J=0:V>R?J=1:J=(x-V)/(x-R),st=v-(v-E)*J,mt=T-(T-X)*J,St=N-(N-et)*J,k=D-(D-Z)*J;const it=Math.round(Math.min(tt,st)),ft=Math.round(Math.max(tt,st));let vt=m*V+it*4;for(let gt=it;gt<=ft;gt++)J=(tt-gt)/(tt-st),J<0?J=0:J>1&&(J=1),g[vt++]=ut-(ut-mt)*J|0,g[vt++]=B-(B-St)*J|0,g[vt++]=$-($-k)*J|0,g[vt++]=255}}function QT(c,t,e){const s=t.coords,r=t.colors;let a,o;switch(t.type){case"lattice":const u=t.verticesPerRow,d=Math.floor(s.length/u)-1,f=u-1;for(a=0;a<d;a++){let g=a*u;for(let m=0;m<f;m++,g++)bd(c,e,s[g],s[g+1],s[g+u],r[g],r[g+1],r[g+u]),bd(c,e,s[g+u+1],s[g+1],s[g+u],r[g+u+1],r[g+1],r[g+u])}break;case"triangles":for(a=0,o=s.length;a<o;a+=3)bd(c,e,s[a],s[a+1],s[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class JT extends Sf{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,s){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-d,m=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),v=f/m,x=g/b,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/v,scaleY:1/x},S=m+4,E=b+4,R=s.getCanvas("mesh",S,E),T=R.context,N=T.createImageData(m,b);if(e){const M=N.data;for(let L=0,G=M.length;L<G;L+=4)M[L]=e[0],M[L+1]=e[1],M[L+2]=e[2],M[L+3]=255}for(const M of this._figures)QT(N,M,w);return T.putImageData(N,2,2),{canvas:R.canvas,offsetX:u-2*v,offsetY:d-2*x,scaleX:v,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,e,s,r){Vd(t,this._bbox);const a=new Float32Array(2);if(r===ke.SHADING)at.singularValueDecompose2dScale(te(t),a);else if(this.matrix){at.singularValueDecompose2dScale(this.matrix,a);const[u,d]=a;at.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=d}else at.singularValueDecompose2dScale(e.baseTransform,a);const o=this._createMeshCanvas(a,r===ke.SHADING?null:this._background,e.cachedCanvases);return r!==ke.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class ZT extends Sf{getPattern(){return"hotpink"}}function tC(c){switch(c[0]){case"RadialAxial":return new WT(c);case"Mesh":return new JT(c);case"Dummy":return new ZT}throw new Error(`Unknown IR type: ${c[0]}`)}const H0={COLORED:1,UNCOLORED:2};class Ef{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,e){const{bbox:s,operatorList:r,paintType:a,tilingType:o,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),Rc("TilingType: "+o);const m=s[0],b=s[1],v=s[2],x=s[3],w=v-m,S=x-b,E=new Float32Array(2);at.singularValueDecompose2dScale(this.matrix,E);const[R,T]=E;at.singularValueDecompose2dScale(this.baseTransform,E);const N=R*E[0],D=T*E[1];let M=w,L=S,G=!1,X=!1;const et=Math.ceil(f*N),Z=Math.ceil(g*D),P=Math.ceil(w*N),Q=Math.ceil(S*D);et>=P?M=f:G=!0,Z>=Q?L=g:X=!0;const tt=this.getSizeAndScale(M,this.ctx.canvas.width,N),ut=this.getSizeAndScale(L,this.ctx.canvas.height,D),B=t.cachedCanvases.getCanvas("pattern",tt.size,ut.size),$=B.context,st=d.createCanvasGraphics($,e);if(st.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(st,a,u),$.translate(-tt.scale*m,-ut.scale*b),st.transform(0,tt.scale,0,0,ut.scale,0,0),$.save(),st.dependencyTracker?.save(),this.clipBbox(st,m,b,v,x),st.baseTransform=te(st.ctx),st.executeOperatorList(r),st.endDrawing(),st.dependencyTracker?.restore(),$.restore(),G||X){const mt=B.canvas;G&&(M=f),X&&(L=g);const St=this.getSizeAndScale(M,this.ctx.canvas.width,N),k=this.getSizeAndScale(L,this.ctx.canvas.height,D),V=St.size,J=k.size,it=t.cachedCanvases.getCanvas("pattern-workaround",V,J),ft=it.context,vt=G?Math.floor(w/f):0,gt=X?Math.floor(S/g):0;for(let oe=0;oe<=vt;oe++)for(let $t=0;$t<=gt;$t++)ft.drawImage(mt,V*oe,J*$t,V,J,0,0,V,J);return{canvas:it.canvas,scaleX:St.scale,scaleY:k.scale,offsetX:m,offsetY:b}}return{canvas:B.canvas,scaleX:tt.scale,scaleY:ut.scale,offsetX:m,offsetY:b}}getSizeAndScale(t,e,s){const r=Math.max(Ef.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*s);return a>=r?a=r:s=a/t,{scale:s,size:a}}clipBbox(t,e,s,r,a){const o=r-e,u=a-s;t.ctx.rect(e,s,o,u),at.axialAlignedBoundingBox([e,s,r,a],te(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const r=t.ctx,a=t.current;switch(e){case H0.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;r.fillStyle=a.fillColor=o,r.strokeStyle=a.strokeColor=u;break;case H0.UNCOLORED:r.fillStyle=r.strokeStyle=s,a.fillColor=a.strokeColor=s;break;default:throw new fT(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,s,r,a){let o=s;r!==ke.SHADING&&(o=at.transform(o,e.baseTransform),this.matrix&&(o=at.transform(o,this.matrix)));const u=this.createPatternCanvas(e,a);let d=new DOMMatrix(o);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function eC({src:c,srcPos:t=0,dest:e,width:s,height:r,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const u=De.isLittleEndian?4278190080:255,[d,f]=o?[a,u]:[u,a],g=s>>3,m=s&7,b=c.length;e=new Uint32Array(e.buffer);let v=0;for(let x=0;x<r;x++){for(const S=t+g;t<S;t++){const E=t<b?c[t]:255;e[v++]=E&128?f:d,e[v++]=E&64?f:d,e[v++]=E&32?f:d,e[v++]=E&16?f:d,e[v++]=E&8?f:d,e[v++]=E&4?f:d,e[v++]=E&2?f:d,e[v++]=E&1?f:d}if(m===0)continue;const w=t<b?c[t++]:255;for(let S=0;S<m;S++)e[v++]=w&1<<7-S?f:d}return{srcPos:t,destPos:v}}const $0=16,q0=100,sC=15,G0=10,Ke=16,vd=new DOMMatrix,ls=new Float32Array(2),kr=new Float32Array([1/0,1/0,-1/0,-1/0]);function iC(c,t){if(c._removeMirroring)throw new Error("Context is already forwarding operations.");c.__originalSave=c.save,c.__originalRestore=c.restore,c.__originalRotate=c.rotate,c.__originalScale=c.scale,c.__originalTranslate=c.translate,c.__originalTransform=c.transform,c.__originalSetTransform=c.setTransform,c.__originalResetTransform=c.resetTransform,c.__originalClip=c.clip,c.__originalMoveTo=c.moveTo,c.__originalLineTo=c.lineTo,c.__originalBezierCurveTo=c.bezierCurveTo,c.__originalRect=c.rect,c.__originalClosePath=c.closePath,c.__originalBeginPath=c.beginPath,c._removeMirroring=()=>{c.save=c.__originalSave,c.restore=c.__originalRestore,c.rotate=c.__originalRotate,c.scale=c.__originalScale,c.translate=c.__originalTranslate,c.transform=c.__originalTransform,c.setTransform=c.__originalSetTransform,c.resetTransform=c.__originalResetTransform,c.clip=c.__originalClip,c.moveTo=c.__originalMoveTo,c.lineTo=c.__originalLineTo,c.bezierCurveTo=c.__originalBezierCurveTo,c.rect=c.__originalRect,c.closePath=c.__originalClosePath,c.beginPath=c.__originalBeginPath,delete c._removeMirroring},c.save=function(){t.save(),this.__originalSave()},c.restore=function(){t.restore(),this.__originalRestore()},c.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},c.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},c.transform=function(e,s,r,a,o,u){t.transform(e,s,r,a,o,u),this.__originalTransform(e,s,r,a,o,u)},c.setTransform=function(e,s,r,a,o,u){t.setTransform(e,s,r,a,o,u),this.__originalSetTransform(e,s,r,a,o,u)},c.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},c.rotate=function(e){t.rotate(e),this.__originalRotate(e)},c.clip=function(e){t.clip(e),this.__originalClip(e)},c.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},c.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},c.bezierCurveTo=function(e,s,r,a,o,u){t.bezierCurveTo(e,s,r,a,o,u),this.__originalBezierCurveTo(e,s,r,a,o,u)},c.rect=function(e,s,r,a){t.rect(e,s,r,a),this.__originalRect(e,s,r,a)},c.closePath=function(){t.closePath(),this.__originalClosePath()},c.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class nC{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,s)):(r=this.canvasFactory.create(e,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function tc(c,t,e,s,r,a,o,u,d,f){const[g,m,b,v,x,w]=te(c);if(m===0&&b===0){const R=o*g+x,T=Math.round(R),N=u*v+w,D=Math.round(N),M=(o+d)*g+x,L=Math.abs(Math.round(M)-T)||1,G=(u+f)*v+w,X=Math.abs(Math.round(G)-D)||1;return c.setTransform(Math.sign(g),0,0,Math.sign(v),T,D),c.drawImage(t,e,s,r,a,0,0,L,X),c.setTransform(g,m,b,v,x,w),[L,X]}if(g===0&&v===0){const R=u*b+x,T=Math.round(R),N=o*m+w,D=Math.round(N),M=(u+f)*b+x,L=Math.abs(Math.round(M)-T)||1,G=(o+d)*m+w,X=Math.abs(Math.round(G)-D)||1;return c.setTransform(0,Math.sign(m),Math.sign(b),0,T,D),c.drawImage(t,e,s,r,a,0,0,X,L),c.setTransform(g,m,b,v,x,w),[X,L]}c.drawImage(t,e,s,r,a,o,u,d,f);const S=Math.hypot(g,m),E=Math.hypot(b,v);return[S*d,E*f]}class V0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Ud;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Re.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,s){s?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=kr.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=ke.FILL,e=null){const s=this.minMax.slice();if(t===ke.STROKE){e||Vt("Stroke bounding box must include transform."),at.singularValueDecompose2dScale(e,ls);const r=ls[0]*this.lineWidth/2,a=ls[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const t=at.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(kr,0)}getClippedPathBoundingBox(t=ke.FILL,e=null){return at.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Y0(c,t){if(t instanceof ImageData){c.putImageData(t,0,0);return}const e=t.height,s=t.width,r=e%Ke,a=(e-r)/Ke,o=r===0?a:a+1,u=c.createImageData(s,Ke);let d=0,f;const g=t.data,m=u.data;let b,v,x,w;if(t.kind===ac.GRAYSCALE_1BPP){const S=g.byteLength,E=new Uint32Array(m.buffer,0,m.byteLength>>2),R=E.length,T=s+7>>3,N=4294967295,D=De.isLittleEndian?4278190080:255;for(b=0;b<o;b++){for(x=b<a?Ke:r,f=0,v=0;v<x;v++){const M=S-d;let L=0;const G=M>T?s:M*8-7,X=G&-8;let et=0,Z=0;for(;L<X;L+=8)Z=g[d++],E[f++]=Z&128?N:D,E[f++]=Z&64?N:D,E[f++]=Z&32?N:D,E[f++]=Z&16?N:D,E[f++]=Z&8?N:D,E[f++]=Z&4?N:D,E[f++]=Z&2?N:D,E[f++]=Z&1?N:D;for(;L<G;L++)et===0&&(Z=g[d++],et=128),E[f++]=Z&et?N:D,et>>=1}for(;f<R;)E[f++]=0;c.putImageData(u,0,b*Ke)}}else if(t.kind===ac.RGBA_32BPP){for(v=0,w=s*Ke*4,b=0;b<a;b++)m.set(g.subarray(d,d+w)),d+=w,c.putImageData(u,0,v),v+=Ke;b<o&&(w=s*r*4,m.set(g.subarray(d,d+w)),c.putImageData(u,0,v))}else if(t.kind===ac.RGB_24BPP)for(x=Ke,w=s*x,b=0;b<o;b++){for(b>=a&&(x=r,w=s*x),f=0,v=w;v--;)m[f++]=g[d++],m[f++]=g[d++],m[f++]=g[d++],m[f++]=255;c.putImageData(u,0,b*Ke)}else throw new Error(`bad image kind: ${t.kind}`)}function X0(c,t){if(t.bitmap){c.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,r=e%Ke,a=(e-r)/Ke,o=r===0?a:a+1,u=c.createImageData(s,Ke);let d=0;const f=t.data,g=u.data;for(let m=0;m<o;m++){const b=m<a?Ke:r;({srcPos:d}=eC({src:f,srcPos:d,dest:g,width:s,height:b,nonBlackColor:0})),c.putImageData(u,0,m*Ke)}}function Ha(c,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)c[s]!==void 0&&(t[s]=c[s]);c.setLineDash!==void 0&&(t.setLineDash(c.getLineDash()),t.lineDashOffset=c.lineDashOffset)}function ec(c){c.strokeStyle=c.fillStyle="#000000",c.fillRule="nonzero",c.globalAlpha=1,c.lineWidth=1,c.lineCap="butt",c.lineJoin="miter",c.miterLimit=10,c.globalCompositeOperation="source-over",c.font="10px sans-serif",c.setLineDash!==void 0&&(c.setLineDash([]),c.lineDashOffset=0);const{filter:t}=c;t!=="none"&&t!==""&&(c.filter="none")}function K0(c,t){if(t)return!0;at.singularValueDecompose2dScale(c,ls);const e=Math.fround($s.pixelRatio*Fr.PDF_TO_CSS_UNITS);return ls[0]<=e&&ls[1]<=e}const rC=["butt","round","square"],aC=["miter","round","bevel"],oC={},W0={};class jr{constructor(t,e,s,r,a,{optionalContentConfig:o,markedContentStack:u=null},d,f,g){this.ctx=t,this.current=new V0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new nC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,e,s=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):s}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:r=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=u,s){const d=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...te(this.compositeCtx))}this.ctx.save(),ec(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=te(this.ctx)}executeOperatorList(t,e,s,r,a){const o=t.argsArray,u=t.fnArray;let d=e||0;const f=o.length;if(f===d)return d;const g=f-d>G0&&typeof s=="function",m=g?Date.now()+sC:0;let b=0;const v=this.commonObjs,x=this.objs;let w,S;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,s),d;if(!a||a(d))if(w=u[d],S=o[d]??null,w!==ro.dependency)S===null?this[w](d):this[w](d,...S);else for(const E of S){this.dependencyTracker?.recordNamedData(E,d);const R=E.startsWith("g_")?v:x;if(!R.has(E))return R.get(E,s),d}if(d++,d===f)return d;if(g&&++b>G0){if(Date.now()>m)return s(),d;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),u=s,d=r,f="prescale1",g,m;for(;a>2&&u>1||o>2&&d>1;){let b=u,v=d;a>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/b),o>2&&d>1&&(v=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/v),g=this.cachedCanvases.getCanvas(f,b,v),m=g.context,m.clearRect(0,0,b,v),m.drawImage(t,0,0,u,d,0,0,b,v),t=g.canvas,u=b,d=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const s=this.ctx,{width:r,height:a}=e,o=this.current.fillColor,u=this.current.patternFill,d=te(s);let f,g,m,b;if((e.bitmap||e.data)&&e.count>1){const et=e.bitmap||e.data.buffer;g=JSON.stringify(u?d:[d.slice(0,4),o]),f=this._cachedBitmapsMap.get(et),f||(f=new Map,this._cachedBitmapsMap.set(et,f));const Z=f.get(g);if(Z&&!u){const P=Math.round(Math.min(d[0],d[2])+d[4]),Q=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,As.transformAndFill),{canvas:Z,offsetX:P,offsetY:Q}}m=Z}m||(b=this.cachedCanvases.getCanvas("maskCanvas",r,a),X0(b.context,e));let v=at.transform(d,[1/r,0,0,-1/a,0,0]);v=at.transform(v,[1,0,0,1,0,-a]);const x=kr.slice();at.axialAlignedBoundingBox([0,0,r,a],v,x);const[w,S,E,R]=x,T=Math.round(E-w)||1,N=Math.round(R-S)||1,D=this.cachedCanvases.getCanvas("fillCanvas",T,N),M=D.context,L=w,G=S;M.translate(-L,-G),M.transform(...v),m||(m=this._scaleImage(b.canvas,Is(M)),m=m.img,f&&u&&f.set(g,m)),M.imageSmoothingEnabled=K0(te(M),e.interpolate),tc(M,m,0,0,m.width,m.height,0,0,r,a),M.globalCompositeOperation="source-in";const X=at.transform(Is(M),[1,0,0,1,-L,-G]);return M.fillStyle=u?o.getPattern(s,this,X,ke.FILL,t):o,M.fillRect(0,0,r,a),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,D.canvas)),this.dependencyTracker?.recordDependencies(t,As.transformAndFill),{canvas:D.canvas,offsetX:Math.round(L),offsetY:Math.round(G)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=rC[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=aC[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=s)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[s,r]of e)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(r,e,s);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),Ha(this.suspendedCtx,o),iC(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ha(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,r){const a=r[0],o=r[1],u=r[2]-a,d=r[3]-o;u===0||d===0||(this.genericComposeSMask(e.context,s,u,d,e.subtype,e.backdrop,e.transferMap,a,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,r,a,o,u,d,f,g,m){let b=t.canvas,v=d-g,x=f-m;if(o)if(v<0||x<0||v+s>b.width||x+r>b.height){const S=this.cachedCanvases.getCanvas("maskExtension",s,r),E=S.context;E.drawImage(b,-v,-x),E.globalCompositeOperation="destination-atop",E.fillStyle=o,E.fillRect(0,0,s,r),E.globalCompositeOperation="source-over",b=S.canvas,v=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(v,x,s,r),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(v,x,s,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,f,s,r),e.clip(w),e.globalCompositeOperation="destination-in",e.drawImage(b,v,x,s,r,d,f,s,r),e.restore()}save(t){this.inSMaskMode&&Ha(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ha(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,s,r,a,o,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,s,r,a,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s,r){let[a]=s;if(!r){a||=s[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const o=e===ro.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const o=s[0]=new Path2D;for(let u=0,d=a.length;u<d;)switch(a[u++]){case Xl.moveTo:o.moveTo(a[u++],a[u++]);break;case Xl.lineTo:o.lineTo(a[u++],a[u++]);break;case Xl.curveTo:o.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]);break;case Xl.closePath:o.closePath();break;default:_t(`Unrecognized drawing path operator: ${a[u-1]}`);break}a=o}at.axialAlignedBoundingBox(r,te(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,s=!0){const r=this.ctx,a=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=a.getPattern(r,this,Is(r),ke.STROKE,t),o){const u=new Path2D;u.addPath(e,r.getTransform().invertSelf().multiplySelf(o)),e=u}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,As.stroke),s&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(ke.STROKE,te(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,s=!0){const r=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const f=a.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=a.getPattern(r,this,Is(r),ke.FILL,t),f){const g=new Path2D;g.addPath(e,r.getTransform().invertSelf().multiplySelf(f)),e=g}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),this.dependencyTracker?.recordDependencies(t,As.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,As.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=oC}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=W0}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;e!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(e!==void 0){const r=new Path2D,a=s.getTransform().invertSelf();for(const{transform:o,x:u,y:d,fontSize:f,path:g}of e)g&&r.addPath(g,new DOMMatrix(o).preMultiplySelf(a).translate(u,d).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const r=this.commonObjs.get(e),a=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=r.fontMatrix||Ud,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&_t("Invalid font matrix for font "+e),s<0?(s=-s,a.fontDirection=-1):a.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const o=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${o}", ${r.fallbackName}`;let d="normal";r.black?d="900":r.bold&&(d="bold");const f=r.italic?"italic":"normal";let g=s;s<$0?g=$0:s>q0&&(g=q0),this.current.fontSizeScale=s/g,this.ctx.font=`${f} ${d} ${g}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,e,s){this.setLeading(t,-s),this.moveText(t,e,s)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=e,s.textMatrixScale=Math.hypot(e[0],e[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),r}paintChar(t,e,s,r,a,o){const u=this.ctx,d=this.current,f=d.font,g=d.textRenderingMode,m=d.fontSize/d.fontSizeScale,b=g&Re.FILL_STROKE_MASK,v=!!(g&Re.ADD_TO_PATH_FLAG),x=d.patternFill&&!f.missingFile,w=d.patternStroke&&!f.missingFile;let S;if((f.disableFontFace||v||x||w)&&!f.missingFile&&(S=f.getPathGenerator(this.commonObjs,e)),S&&(f.disableFontFace||x||w)){u.save(),u.translate(s,r),u.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,u,f);let E;if(b===Re.FILL||b===Re.FILL_STROKE)if(a){E=u.getTransform(),u.setTransform(...a);const R=this.#i(S,E,a);u.fill(R)}else u.fill(S);if(b===Re.STROKE||b===Re.FILL_STROKE)if(o){E||=u.getTransform(),u.setTransform(...o);const{a:R,b:T,c:N,d:D}=E,M=at.inverseTransform(o),L=at.transform([R,T,N,D,0,0],M);at.singularValueDecompose2dScale(L,ls),u.lineWidth*=Math.max(ls[0],ls[1])/m,u.stroke(this.#i(S,E,o))}else u.lineWidth/=m,u.stroke(S);u.restore()}else(b===Re.FILL||b===Re.FILL_STROKE)&&(u.fillText(e,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,m,s,r,()=>u.measureText(e))),(b===Re.STROKE||b===Re.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,m,s,r,()=>u.measureText(e)).recordDependencies(t,As.stroke),u.strokeText(e,s,r));v&&((this.pendingTextPaths||=[]).push({transform:te(u),x:s,y:r,fontSize:m,path:S}),this.dependencyTracker?.recordCharacterBBox(t,u,f,m,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){s=!0;break}return Tt(this,"isFontSubpixelAAEnabled",s)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,As.showText).resetBBox(t),this.current.textRenderingMode&Re.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const a=s.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,u=s.fontSizeScale,d=s.charSpacing,f=s.wordSpacing,g=s.fontDirection,m=s.textHScale*g,b=e.length,v=r.vertical,x=v?1:-1,w=r.defaultVMetrics,S=a*s.fontMatrix[0],E=s.textRenderingMode===Re.FILL&&!r.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),g>0?o.scale(m,-1):o.scale(m,1);let R,T;if(s.patternFill){o.save();const G=s.fillColor.getPattern(o,this,Is(o),ke.FILL,t);R=te(o),o.restore(),o.fillStyle=G}if(s.patternStroke){o.save();const G=s.strokeColor.getPattern(o,this,Is(o),ke.STROKE,t);T=te(o),o.restore(),o.strokeStyle=G}let N=s.lineWidth;const D=s.textMatrixScale;if(D===0||N===0){const G=s.textRenderingMode&Re.FILL_STROKE_MASK;(G===Re.STROKE||G===Re.FILL_STROKE)&&(N=this.getSinglePixelWidth())}else N/=D;if(u!==1&&(o.scale(u,u),N/=u),o.lineWidth=N,r.isInvalidPDFjsFont){const G=[];let X=0;for(const Z of e)G.push(Z.unicode),X+=Z.width;const et=G.join("");if(o.fillText(et,0,0),this.dependencyTracker!==null){const Z=o.measureText(et);this.dependencyTracker.recordBBox(t,this.ctx,-Z.actualBoundingBoxLeft,Z.actualBoundingBoxRight,-Z.actualBoundingBoxAscent,Z.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=X*S*m,o.restore(),this.compose();return}let M=0,L;for(L=0;L<b;++L){const G=e[L];if(typeof G=="number"){M+=x*G*a/1e3;continue}let X=!1;const et=(G.isSpace?f:0)+d,Z=G.fontChar,P=G.accent;let Q,tt,ut=G.width;if(v){const st=G.vmetric||w,mt=-(G.vmetric?st[1]:ut*.5)*S,St=st[2]*S;ut=st?-st[0]:ut,Q=mt/u,tt=(M+St)/u}else Q=M/u,tt=0;let B;if(r.remeasure&&ut>0){B=o.measureText(Z);const st=B.width*1e3/a*u;if(ut<st&&this.isFontSubpixelAAEnabled){const mt=ut/st;X=!0,o.save(),o.scale(mt,1),Q/=mt}else ut!==st&&(Q+=(ut-st)/2e3*a/u)}if(this.contentVisible&&(G.isInFont||r.missingFile)){if(E&&!P)o.fillText(Z,Q,tt),this.dependencyTracker?.recordCharacterBBox(t,o,B?{bbox:null}:r,a/u,Q,tt,()=>B??o.measureText(Z));else if(this.paintChar(t,Z,Q,tt,R,T),P){const st=Q+a*P.offset.x/u,mt=tt-a*P.offset.y/u;this.paintChar(t,P.fontChar,st,mt,R,T)}}const $=v?ut*S-et*g:ut*S+et*g;M+=$,X&&o.restore()}v?s.y-=M:s.x+=M*m,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const s=this.ctx,r=this.current,a=r.font,o=r.fontSize,u=r.fontDirection,d=a.vertical?1:-1,f=r.charSpacing,g=r.wordSpacing,m=r.textHScale*u,b=r.fontMatrix||Ud,v=e.length,x=r.textRenderingMode===Re.INVISIBLE;let w,S,E,R;if(x||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(m,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new bc(T,t):null,w=0;w<v;++w){if(S=e[w],typeof S=="number"){R=d*S*o/1e3,this.ctx.translate(R,0),r.x+=R*m;continue}const N=(S.isSpace?g:0)+f,D=a.charProcOperatorList[S.operatorListId];D?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...b),this.executeOperatorList(D),this.restore()):_t(`Type3 character "${S.operatorListId}" is not available.`);const M=[S.width,0];at.applyTransform(M,b),E=M[0]*o+N,s.translate(E,0),r.x+=E*m}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,e,s){}setCharWidthAndBounds(t,e,s,r,a,o,u){const d=new Path2D;d.rect(r,a,o-r,u-a),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,r,o,a,u).recordClipBox(t,this.ctx,r,o,a,u),this.endPath(t)}getColorN_Pattern(t,e){let s;if(e[0]==="TilingPattern"){const r=this.baseTransform||te(this.ctx),a={createCanvasGraphics:(o,u)=>new jr(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new bc(this.dependencyTracker,u,!0):null)};s=new Ef(e,this.ctx,a,r)}else s=this._getPattern(t,e[1],e[2]);return s}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,s=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=tC(this.getObject(t,e)),this.cachedPatterns.set(e,r)),s&&(r.matrix=s),r}shadingFill(t,e){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,e);s.fillStyle=r.getPattern(s,this,Is(s),ke.SHADING,t);const a=Is(s);if(a){const{width:o,height:u}=s.canvas,d=kr.slice();at.axialAlignedBoundingBox([0,0,o,u],a,d);const[f,g,m,b]=d;this.ctx.fillRect(f,g,m-f,b-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,As.transform).recordDependencies(t,As.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Vt("Should not call beginInlineImage")}beginImageData(){Vt("Should not call beginImageData")}paintFormXObjectBegin(t,e,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=te(this.ctx),s)){at.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,o,u]=s,d=new Path2D;d.rect(r,a,o-r,u-a),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,r,o,a,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;e.isolated||Rc("TODO: Support non-isolated groups."),e.knockout&&_t("Knockout groups not supported.");const r=te(s);if(e.matrix&&s.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=kr.slice();at.axialAlignedBoundingBox(e.bbox,te(s),a);const o=[0,0,s.canvas.width,s.canvas.height];a=at.intersect(a,o)||[0,0,0,0];const u=Math.floor(a[0]),d=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-u,1),g=Math.max(Math.ceil(a[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,g]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(m,f,g),v=b.context;v.translate(-u,-d),v.transform(...r);let x=new Path2D;const[w,S,E,R]=e.bbox;if(x.rect(w,S,E-w,R-S),e.matrix){const T=new Path2D;T.addPath(x,new DOMMatrix(e.matrix)),x=T}v.clip(x),e.smask&&this.smaskStack.push({canvas:b.canvas,context:v,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,d),s.save()),Ha(s,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=te(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const o=kr.slice();at.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,s,r,a,o){if(this.#t(),ec(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],d=s[3]-s[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=d,at.singularValueDecompose2dScale(te(this.ctx),ls);const{viewportScale:f}=this,g=Math.ceil(u*this.outputScaleX*f),m=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:b,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(ls[0],0,0,-ls[1],0,d*ls[1]),ec(this.ctx)}else{ec(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,d),this.ctx.clip(f)}}this.current=new V0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const s=e.count;e=this.getObject(t,e.data,e),e.count=s;const r=this.ctx,a=this._createMaskCanvas(t,e),o=a.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s,r=0,a=0,o,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=te(d);d.transform(s,r,a,o,0,0);const g=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,b=u.length;m<b;m+=2){const v=at.transform(f,[s,r,a,o,u[m],u[m+1]]);d.drawImage(g.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(t,this.ctx,v[4],v[4]+g.canvas.width,v[5],v[5]+g.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,As.transformAndFill);for(const o of e){const{data:u,width:d,height:f,transform:g}=o,m=this.cachedCanvases.getCanvas("maskCanvas",d,f),b=m.context;b.save();const v=this.getObject(t,u,o);X0(b,v),b.globalCompositeOperation="source-in",b.fillStyle=a?r.getPattern(b,this,Is(s),ke.FILL,t):r,b.fillRect(0,0,d,f),b.restore(),s.save(),s.transform(...g),s.scale(1,-1),tc(s,m.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const s=this.getObject(t,e);if(!s){_t("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,e,s,r,a){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){_t("Dependent image isn't ready yet");return}const u=o.width,d=o.height,f=[];for(let g=0,m=a.length;g<m;g+=2)f.push({transform:[s,0,0,r,a[g],a[g+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,o,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:r}=t,a=this.cachedCanvases.getCanvas("inlineImage",s,r),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const s=e.width,r=e.height,a=this.ctx;this.save(t);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/s,-1/r);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const g=this.cachedCanvases.getCanvas("inlineImage",s,r).context;Y0(g,e),u=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(u,Is(a));a.imageSmoothingEnabled=K0(te(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,s,-r,0).recordDependencies(t,As.imageXObject).recordOperation(t),tc(a,d.img,0,0,d.paintWidth,d.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,s){if(!this.contentVisible)return;const r=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const o=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",o,u).context;Y0(f,e),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const o of s)r.save(),r.transform(...o.transform),r.scale(1,-1),tc(r,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,As.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,s){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,s){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const a=this.ctx;this.pendingClip?(r||(this.pendingClip===W0?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=te(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:r,d:a}=this.ctx.getTransform();let o,u;if(s===0&&r===0){const d=Math.abs(e),f=Math.abs(a);if(d===f)if(t===0)o=u=1/d;else{const g=d*t;o=u=g<1?1/g:1}else if(t===0)o=1/d,u=1/f;else{const g=d*t,m=f*t;o=g<1?1/g:1,u=m<1?1/m:1}}else{const d=Math.abs(e*a-s*r),f=Math.hypot(e,s),g=Math.hypot(r,a);if(t===0)o=g/d,u=f/d;else{const m=t*d;o=g>m?g/m:1,u=f>m?f/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:s,current:{lineWidth:r}}=this,[a,o]=this.getScaleForStroking();if(a===o){s.lineWidth=(r||1)*a,s.stroke(t);return}const u=s.getLineDash();e&&s.save(),s.scale(a,o),vd.a=1/a,vd.d=1/o;const d=new Path2D;if(d.addPath(t,vd),u.length>0){const f=Math.max(a,o);s.setLineDash(u.map(g=>g/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(d),e&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const c in ro)jr.prototype[c]!==void 0&&(jr.prototype[ro[c]]=jr.prototype[c]);class Lr{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,s={};let r=0;for(const f of Lr.strings){const g=e.encode(t[f]);s[f]=g,r+=4+g.length}const a=new ArrayBuffer(r),o=new Uint8Array(a),u=new DataView(a);let d=0;for(const f of Lr.strings){const g=s[f],m=g.length;u.setUint32(d,m),o.set(g,d+4),d+=4+m}return Mt(d===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#s(t){Mt(t<Lr.strings.length,"Invalid string index");let e=0;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,s))}get fontFamily(){return this.#s(0)}get fontWeight(){return this.#s(1)}get italicAngle(){return this.#s(2)}}class Pr{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,s={};let r=0;for(const b of Pr.strings){const v=e.encode(t[b]);s[b]=v,r+=4+v.length}r+=4;let a,o,u=1+r;t.style&&(a=e.encode(t.style.style),o=e.encode(t.style.weight),u+=4+a.length+4+o.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let m=0;g.setUint8(m++,t.guessFallback?1:0),g.setUint32(m,0),m+=4,r=0;for(const b of Pr.strings){const v=s[b],x=v.length;r+=4+x,g.setUint32(m,x),f.set(v,m+4),m+=4+x}return g.setUint32(m-r-4,r),t.style&&(g.setUint32(m,a.length),f.set(a,m+4),m+=4+a.length,g.setUint32(m,o.length),f.set(o,m+4),m+=4+o.length),Mt(m<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(m)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#s(t){Mt(t<Pr.strings.length,"Invalid string index");let e=5;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const s=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,s))}get css(){return this.#s(0)}get loadedName(){return this.#s(1)}get baseFontName(){return this.#s(2)}get src(){return this.#s(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),s=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const r=this.#e.getUint32(t),a=this.#i.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:a}}}class Ht{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#s=this.#i+1+48;static#a=this.#s+1+6;#n;#r;#o;constructor({data:t,extra:e}){this.#n=t,this.#r=new TextDecoder,this.#o=new DataView(this.#n),e&&Object.assign(this,e)}#c(t){Mt(t<Ht.bools.length,"Invalid boolean index");const e=Math.floor(t/4),s=t*2%8,r=this.#o.getUint8(e)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Mt(t<Ht.numbers.length,"Invalid number index"),this.#o.getFloat64(Ht.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Ht.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Ht.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Ht.#s;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){Mt(t<Ht.strings.length,"Invalid string index");let e=Ht.#a+4;for(let a=0;a<t;a++)e+=this.#o.getUint32(e)+4;const s=this.#o.getUint32(e),r=new Uint8Array(s);return r.set(new Uint8Array(this.#n,e+4,s)),this.#r.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ht.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const a=this.#o.getUint32(t);if(a!==0)return new Uint8Array(this.#n,t+4,a)}clearData(){let t=Ht.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);t+=4+r;const a=this.#o.getUint32(t);new Uint8Array(this.#n,t+4,a).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Ht.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);if(r===0)return null;const a=new Uint8Array(r);return a.set(new Uint8Array(this.#n,t+4,r)),new Lr(a.buffer)}get systemFontInfo(){let t=Ht.#a;const e=this.#o.getUint32(t);t+=4+e;const s=this.#o.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#n,t+4,s)),new Pr(r.buffer)}static write(t){const e=t.systemFontInfo?Pr.write(t.systemFontInfo):null,s=t.cssFontInfo?Lr.write(t.cssFontInfo):null,r=new TextEncoder,a={};let o=0;for(const w of Ht.strings)a[w]=r.encode(t[w]),o+=4+a[w].length;const u=Ht.#a+4+o+4+(e?e.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let m=0;const b=Ht.bools.length;let v=0,x=0;for(let w=0;w<b;w++){const S=t[Ht.bools[w]];v|=(S===void 0?0:S?2:1)<<x,x+=2,(x===8||w===b-1)&&(g.setUint8(m++,v),v=0,x=0)}Mt(m===Ht.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of Ht.numbers)g.setFloat64(m,t[w]),m+=8;if(Mt(m===Ht.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(m++,4);for(const w of t.bbox)g.setInt16(m,w,!0),m+=2}else g.setUint8(m++,0),m+=8;if(Mt(m===Ht.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(m++,6);for(const w of t.fontMatrix)g.setFloat64(m,w,!0),m+=8}else g.setUint8(m++,0),m+=48;if(Mt(m===Ht.#s,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(m++,1);for(const w of t.defaultVMetrics)g.setInt16(m,w,!0),m+=2}else g.setUint8(m++,0),m+=6;Mt(m===Ht.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(Ht.#a,0),m+=4;for(const w of Ht.strings){const S=a[w],E=S.length;g.setUint32(m,E),f.set(S,m+4),m+=4+E}if(g.setUint32(Ht.#a,m-Ht.#a-4),!e)g.setUint32(m,0),m+=4;else{const w=e.byteLength;g.setUint32(m,w),Mt(m+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),m+4),m+=4+w}if(!s)g.setUint32(m,0),m+=4;else{const w=s.byteLength;g.setUint32(m,w),Mt(m+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),m+4),m+=4+w}return t.data===void 0?(g.setUint32(m,0),m+=4):(g.setUint32(m,t.data.length),f.set(t.data,m+4),m+=4+t.data.length),Mt(m<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(m)}}class Br{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class lC{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Rr=Symbol("INTERNAL");class cC{#t=!1;#e=!1;#i=!1;#s=!0;constructor(t,{name:e,intent:s,usage:r,rbGroups:a}){this.#t=!!(t&os.DISPLAY),this.#e=!!(t&os.PRINT),this.name=e,this.intent=s,this.usage=r,this.rbGroups=a}get visible(){if(this.#i)return this.#s;if(!this.#s)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==Rr&&Vt("Internal method `_setVisible` called."),this.#i=s,this.#s=e}}class uC{#t=null;#e=new Map;#i=null;#s=null;constructor(t,e=os.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#s=t.order;for(const s of t.groups)this.#e.set(s.id,new cC(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Rr,!1);for(const s of t.on)this.#e.get(s)._setVisible(Rr,!0);for(const s of t.off)this.#e.get(s)._setVisible(Rr,!1);this.#i=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let r=1;r<e;r++){const a=t[r];let o;if(Array.isArray(a))o=this.#a(a);else if(this.#e.has(a))o=this.#e.get(a).visible;else return _t(`Optional content group not found: ${a}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Rc("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(_t(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return _t(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return _t(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return _t(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return _t(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return _t(`Unknown optional content policy ${t.policy}.`),!0}return _t(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const r=this.#e.get(t);if(!r){_t(`Optional content group not found: ${t}`);return}if(s&&e&&r.rbGroups.length)for(const a of r.rbGroups)for(const o of a)o!==t&&this.#e.get(o)?._setVisible(Rr,!1,!0);r._setVisible(Rr,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const a=this.#e.get(r);if(a)switch(s){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Ev;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class hC{constructor(t,{disableRange:e=!1,disableStream:s=!1}){Mt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:a,progressiveDone:o,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,a?.length>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(s),!0)});Mt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Mt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new dC(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new fC(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class dC{constructor(t,e,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=vf(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class fC{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function gC(c){let t=!0,e=s("filename\\*","i").exec(c);if(e){e=e[1];let g=u(e);return g=unescape(g),g=d(g),g=f(g),a(g)}if(e=o(c),e){const g=f(e);return a(g)}if(e=s("filename","i").exec(c),e){e=e[1];let g=u(e);return g=f(g),a(g)}function s(g,m){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function r(g,m){if(g){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const b=new TextDecoder(g,{fatal:!0}),v=go(m);m=b.decode(v),t=!1}catch{}}return m}function a(g){return t&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),t&&(g=r("iso-8859-1",g))),g}function o(g){const m=[];let b;const v=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=v.exec(g))!==null;){let[,w,S,E]=b;if(w=parseInt(w,10),w in m){if(w===0)break;continue}m[w]=[S,E]}const x=[];for(let w=0;w<m.length&&w in m;++w){let[S,E]=m[w];E=u(E),S&&(E=unescape(E),w===0&&(E=d(E))),x.push(E)}return x.join("")}function u(g){if(g.startsWith('"')){const m=g.slice(1).split('\\"');for(let b=0;b<m.length;++b){const v=m[b].indexOf('"');v!==-1&&(m[b]=m[b].slice(0,v),m.length=b+1),m[b]=m[b].replaceAll(/\\(.)/g,"$1")}g=m.join('"')}return g}function d(g){const m=g.indexOf("'");if(m===-1)return g;const b=g.slice(0,m),x=g.slice(m+1).replace(/^[^']*'/,"");return r(b,x)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,b,v,x){if(v==="q"||v==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,S){return String.fromCharCode(parseInt(S,16))}),r(b,x);try{x=atob(x)}catch{}return r(b,x)})}return""}function Dv(c,t){const e=new Headers;if(!c||!t||typeof t!="object")return e;for(const s in t){const r=t[s];r!==void 0&&e.append(s,r)}return e}function kc(c){return URL.parse(c)?.origin??null}function Mv({responseHeaders:c,isHttp:t,rangeChunkSize:e,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(c.get("Content-Length"),10);return!Number.isInteger(a)||(r.suggestedLength=a,a<=2*e)||s||!t||c.get("Accept-Ranges")!=="bytes"||(c.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function jv(c){const t=c.get("Content-Disposition");if(t){let e=gC(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(vf(e))return e}return null}function vo(c,t){return new yc(`Unexpected server response (${c}) while retrieving PDF "${t}".`,c,c===404||c===0&&t.startsWith("file:"))}function Lv(c){return c===200||c===206}function Pv(c,t,e){return{method:"GET",headers:c,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Bv(c){return c instanceof Uint8Array?c.buffer:c instanceof ArrayBuffer?c:(_t(`getArrayBuffer - unexpected data format: ${c}`),new Uint8Array(c).buffer)}class pC{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Dv(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new mC(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new yC(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class mC{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),r=e.url;fetch(r,Pv(s,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=kc(a.url),!Lv(a.status))throw vo(a.status,r);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:u,suggestedLength:d}=Mv({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=jv(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Xi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Bv(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class yC{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${s-1}`);const o=r.url;fetch(o,Pv(a,this._withCredentials,this._abortController)).then(u=>{const d=kc(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!Lv(u.status))throw vo(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Bv(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const wd=200,_d=206;function bC(c){const t=c.response;return typeof t!="string"?t:go(t).buffer}class vC{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Dv(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,o]of this.headers)e.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=_d):r.expectedStatus=wd,e.responseType="arraybuffer",Mt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const a=r.status||wd;if(!(a===wd&&s.expectedStatus===_d)&&a!==s.expectedStatus){s.onError(r.status);return}const u=bC(r);if(a===_d){const d=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(_t('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class wC{constructor(t){this._source=t,this._manager=new vC(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Mt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _C(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new AC(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class _C{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=kc(e.responseURL);const s=e.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...f]=u.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=Mv({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=jv(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=vo(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class AC{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=kc(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=vo(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const xC=/^[a-z][a-z0-9\-+.]+:/i;function SC(c){if(xC.test(c))return new URL(c);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(c))}class EC{constructor(t){this.source=t,this.url=SC(t.url),Mt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new TC(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new CC(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class TC{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=vo(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Xi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class CC{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const $a=Symbol("INITIAL_DATA");class Uv{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:$a}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const s=this.#t[t];if(!s||s.data===$a)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==$a}delete(t){const e=this.#t[t];return!e||e.data===$a?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==$a&&(yield[t,e])}}}const RC=1e5,Q0=30;class Pe{#t=Promise.withResolvers();#e=null;#i=!1;#s=!!globalThis.FontInspector?.enabled;#a=null;#n=null;#r=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#x=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=s.scale*$s.pixelRatio,this.#d=s.rotation,this.#n={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:a,pageX:o,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-o,u+a],this.#o=r,this.#r=a,Pe.#N(),On(e,s),this.#t.promise.finally(()=>{Pe.#w.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=De.platform;return Tt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),Pe.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*$s.pixelRatio,r=t.rotation;if(r!==this.#d&&(e?.(),this.#d=r,On(this.#l,{rotation:r})),s!==this.#h){e?.(),this.#h=s;const a={div:null,properties:null,ctx:Pe.#O(this.#a)};for(const o of this.#u)a.properties=this.#p.get(o),a.div=o,this.#S(a)}}cancel(){const t=new Xi("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#i)return;this.#n.ctx??=Pe.#O(this.#a);const e=this.#u,s=this.#m;for(const r of t){if(e.length>RC){_t("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),a.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const r=at.transform(this.#y,t.transform);let a=Math.atan2(r[1],r[0]);const o=this.#f[t.fontName];o.vertical&&(a+=Math.PI/2);let u=this.#s&&o.fontSubstitution||o.fontFamily;u=Pe.fontFamilyMap.get(u)||u;const d=Math.hypot(r[2],r[3]),f=d*Pe.#B(u,o,this.#a);let g,m;a===0?(g=r[4],m=r[5]-f):(g=r[4]+f*Math.sin(a),m=r[5]-f*Math.cos(a));const b="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#l?(v.left=`${(100*g/this.#o).toFixed(2)}%`,v.top=`${(100*m/this.#r).toFixed(2)}%`):(v.left=`${b}${g.toFixed(2)}px)`,v.top=`${b}${m.toFixed(2)}px)`),v.fontSize=`${b}${(Pe.#x*d).toFixed(2)}px)`,v.fontFamily=u,s.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#s&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),a!==0&&(s.angle=a*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);w!==S&&Math.max(w,S)/Math.min(w,S)>1.5&&(x=!0)}if(x&&(s.canvasWidth=o.vertical?t.height:t.width),this.#p.set(e,s),this.#n.div=e,this.#n.properties=s,this.#S(this.#n),s.hasText&&this.#e.append(e),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#S(t){const{div:e,properties:s,ctx:r}=t,{style:a}=e;let o="";if(Pe.#x>1&&(o=`scale(${1/Pe.#x})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=a,{canvasWidth:d,fontSize:f}=s;Pe.#R(r,f*this.#h,u);const{width:g}=r.measureText(e.textContent);g>0&&(o=`scaleX(${d*this.#h/g}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#O(t=null){let e=this.#b.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,s){const r=this.#E.get(t);e===r.size&&s===r.family||(t.font=`${e}px ${s}`,r.size=e,r.family=s)}static#N(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#B(t,e,s){const r=this.#v.get(t);if(r)return r;const a=this.#O(s);a.canvas.width=a.canvas.height=Q0,this.#R(a,Q0,t);const o=a.measureText(""),u=o.fontBoundingBoxAscent,d=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return u?f=u/(u+d):(De.platform.isFirefox&&_t("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const NC=100;function OC(c={}){typeof c=="string"||c instanceof URL?c={url:c}:(c instanceof ArrayBuffer||ArrayBuffer.isView(c))&&(c={data:c});const t=new Tf,{docId:e}=t,s=c.url?PT(c.url):null,r=c.data?BT(c.data):null,a=c.httpHeaders||null,o=c.withCredentials===!0,u=c.password??null,d=c.range instanceof Iv?c.range:null,f=Number.isInteger(c.rangeChunkSize)&&c.rangeChunkSize>0?c.rangeChunkSize:2**16;let g=c.worker instanceof oo?c.worker:null;const m=c.verbosity,b=typeof c.docBaseUrl=="string"&&!Nc(c.docBaseUrl)?c.docBaseUrl:null,v=Wl(c.cMapUrl),x=c.cMapPacked!==!1,w=c.CMapReaderFactory||(Be?GT:B0),S=Wl(c.iccUrl),E=Wl(c.standardFontDataUrl),R=c.StandardFontDataFactory||(Be?VT:U0),T=Wl(c.wasmUrl),N=c.WasmFactory||(Be?YT:I0),D=c.stopAtErrors!==!0,M=Number.isInteger(c.maxImageSize)&&c.maxImageSize>-1?c.maxImageSize:-1,L=c.isEvalSupported!==!1,G=typeof c.isOffscreenCanvasSupported=="boolean"?c.isOffscreenCanvasSupported:!Be,X=typeof c.isImageDecoderSupported=="boolean"?c.isImageDecoderSupported:!Be&&(De.platform.isFirefox||!globalThis.chrome),et=Number.isInteger(c.canvasMaxAreaInBytes)?c.canvasMaxAreaInBytes:-1,Z=typeof c.disableFontFace=="boolean"?c.disableFontFace:Be,P=c.fontExtraProperties===!0,Q=c.enableXfa===!0,tt=c.ownerDocument||globalThis.document,ut=c.disableRange===!0,B=c.disableStream===!0,$=c.disableAutoFetch===!0,st=c.pdfBug===!0,mt=c.CanvasFactory||(Be?qT:FT),St=c.FilterFactory||(Be?$T:HT),k=c.enableHWA===!0,V=c.useWasm!==!1,J=d?d.length:c.length??NaN,it=typeof c.useSystemFonts=="boolean"?c.useSystemFonts:!Be&&!Z,ft=typeof c.useWorkerFetch=="boolean"?c.useWorkerFetch:!!(w===B0&&R===U0&&N===I0&&v&&E&&T&&Xa(v,document.baseURI)&&Xa(E,document.baseURI)&&Xa(T,document.baseURI)),vt=null;uT(m);const gt={canvasFactory:new mt({ownerDocument:tt,enableHWA:k}),filterFactory:new St({docId:e,ownerDocument:tt}),cMapReaderFactory:ft?null:new w({baseUrl:v,isCompressed:x}),standardFontDataFactory:ft?null:new R({baseUrl:E}),wasmFactory:ft?null:new N({baseUrl:T})};g||(g=oo.create({verbosity:m,port:Br.workerPort}),t._worker=g);const oe={docId:e,apiVersion:"5.4.296",data:r,password:u,disableAutoFetch:$,rangeChunkSize:f,length:J,docBaseUrl:b,enableXfa:Q,evaluatorOptions:{maxImageSize:M,disableFontFace:Z,ignoreErrors:D,isEvalSupported:L,isOffscreenCanvasSupported:G,isImageDecoderSupported:X,canvasMaxAreaInBytes:et,fontExtraProperties:P,useSystemFonts:it,useWasm:V,useWorkerFetch:ft,cMapUrl:v,iccUrl:S,standardFontDataUrl:E,wasmUrl:T}},$t={ownerDocument:tt,pdfBug:st,styleElement:vt,loadingParams:{disableAutoFetch:$,enableXfa:Q}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Ji=g.messageHandler.sendWithPromise("GetDocRequest",oe,r?[r.buffer]:null);let yi;if(d)yi=new hC(d,{disableRange:ut,disableStream:B});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Zi=Xa(s)?pC:Be?EC:wC;yi=new Zi({url:s,length:J,httpHeaders:a,withCredentials:o,rangeChunkSize:f,disableRange:ut,disableStream:B})}return Ji.then(Zi=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Vr=new Ka(e,Zi,g.port),Gs=new MC(Vr,t,yi,$t,gt,k);t._transport=Gs,Vr.send("Ready",null)})}).catch(t._capability.reject),t}class Tf{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Tf.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Iv{#t=Promise.withResolvers();#e=[];#i=[];#s=[];#a=[];constructor(t,e,s=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#s.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const s of this.#a)s(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const s of this.#s)s(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Vt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class kC{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class DC{#t=!1;constructor(t,e,s,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=r?new O0:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new Uv,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:a=!1}={}){return new mo({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Tt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:s,intent:r="display",annotationMode:a=Gi.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:m=null,isEditing:b=!1,recordOperations:v=!1,operationsFilter:x=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(r,a,m,b),{renderingIntent:S,cacheKey:E}=w;this.#t=!1,d||=this._transport.getOptionalContentConfig(S);let R=this._intentStates.get(E);R||(R=Object.create(null),this._intentStates.set(E,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const T=!!(S&os.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const N=!!(this._pdfBug&&globalThis.StepperManager?.enabled),D=!this.recordedBBoxes&&(v||N),M=X=>{if(R.renderTasks.delete(L),D){const et=L.gfx?.dependencyTracker.take();et&&(L.stepper&&L.stepper.setOperatorBBoxes(et,L.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=et))}T&&(this.#t=!0),this.#e(),X?(L.capability.reject(X),this._abortOperatorList({intentState:R,reason:X instanceof Error?X:new Error(X)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new Dr({callback:M,params:{canvas:e,canvasContext:t,dependencyTracker:D?new KT(e,R.operatorList.length,N):null,viewport:s,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:x});(R.renderTasks||=new Set).add(L);const G=L.task;return Promise.all([R.displayReadyCapability.promise,d]).then(([X,et])=>{if(this.destroyed){M();return}if(this._stats?.time("Rendering"),!(et.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:X,optionalContentConfig:et}),L.operatorListChanged()}).catch(M),G}getOperatorList({intent:t="display",annotationMode:e=Gi.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const o=this._transport.getRenderingIntent(t,e,s,r,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>ao.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,r){function a(){o.read().then(function({value:d,done:f}){if(f){s(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),a()},r)}const o=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new O0),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,r=t.length;s<r;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:r}){const{map:a,transfer:o}=s,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:r},o).getReader(),f=this._intentStates.get(e);f.streamReader=d;const g=()=>{d.read().then(({value:m,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,f),g())},m=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(m);else if(f.opListReadCapability)f.opListReadCapability.reject(m);else throw m}})};g()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof bf){let r=NC;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new Xi(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,a]of this._intentStates)if(a===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var Vi,Os,fi,Cn,wc,Rn,Nn,Ie,oc,zv,Fv,Wa,Ur,lc;const Zt=class Zt{constructor({name:t=null,port:e=null,verbosity:s=hT()}={}){Bs(this,Ie);Bs(this,Vi,Promise.withResolvers());Bs(this,Os,null);Bs(this,fi,null);Bs(this,Cn,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,e){if(Jt(Zt,Nn).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Jt(Zt,Nn).set(e,this),Us(this,Ie,zv).call(this,e)}else Us(this,Ie,Fv).call(this)}get promise(){return Jt(this,Vi).promise}get port(){return Jt(this,fi)}get messageHandler(){return Jt(this,Os)}destroy(){this.destroyed=!0,Jt(this,Cn)?.terminate(),Ye(this,Cn,null),Jt(Zt,Nn).delete(Jt(this,fi)),Ye(this,fi,null),Jt(this,Os)?.destroy(),Ye(this,Os,null)}static create(t){const e=Jt(this,Nn).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Zt(t)}static get workerSrc(){if(Br.workerSrc)return Br.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Tt(this,"_setupFakeWorkerGlobal",(async()=>Jt(this,Ur,lc)?Jt(this,Ur,lc):(await import(this.workerSrc)).WorkerMessageHandler)())}};Vi=new WeakMap,Os=new WeakMap,fi=new WeakMap,Cn=new WeakMap,wc=new WeakMap,Rn=new WeakMap,Nn=new WeakMap,Ie=new WeakSet,oc=function(){Jt(this,Vi).resolve(),Jt(this,Os).send("configure",{verbosity:this.verbosity})},zv=function(t){Ye(this,fi,t),Ye(this,Os,new Ka("main","worker",t)),Jt(this,Os).on("ready",()=>{}),Us(this,Ie,oc).call(this)},Fv=function(){if(Jt(Zt,Rn)||Jt(Zt,Ur,lc)){Us(this,Ie,Wa).call(this);return}let{workerSrc:t}=Zt;try{Zt._isSameOrigin(window.location,t)||(t=Zt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Ka("main","worker",e),r=()=>{a.abort(),s.destroy(),e.terminate(),this.destroyed?Jt(this,Vi).reject(new Error("Worker was destroyed")):Us(this,Ie,Wa).call(this)},a=new AbortController;e.addEventListener("error",()=>{Jt(this,Cn)||r()},{signal:a.signal}),s.on("test",u=>{if(a.abort(),this.destroyed||!u){r();return}Ye(this,Os,s),Ye(this,fi,e),Ye(this,Cn,e),Us(this,Ie,oc).call(this)}),s.on("ready",u=>{if(a.abort(),this.destroyed){r();return}try{o()}catch{Us(this,Ie,Wa).call(this)}});const o=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};o();return}catch{Rc("The worker has been disabled.")}Us(this,Ie,Wa).call(this)},Wa=function(){Jt(Zt,Rn)||(_t("Setting up fake worker."),Ye(Zt,Rn,!0)),Zt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Jt(this,Vi).reject(new Error("Worker was destroyed"));return}const e=new zT;Ye(this,fi,e);const s=`fake${jy(Zt,wc)._++}`,r=new Ka(s+"_worker",s,e);t.setup(r,e),Ye(this,Os,new Ka(s,s+"_worker",e)),Us(this,Ie,oc).call(this)}).catch(t=>{Jt(this,Vi).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ur=new WeakSet,lc=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Bs(Zt,Ur),Bs(Zt,wc,0),Bs(Zt,Rn,!1),Bs(Zt,Nn,new WeakMap),Be&&(Ye(Zt,Rn,!0),Br.workerSrc||="./pdf.worker.mjs"),Zt._isSameOrigin=(t,e)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(e,s);return s.origin===r.origin},Zt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Zt.fromPort=t=>{if(xT("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Zt.create(t)};let oo=Zt;class MC{#t=new Map;#e=new Map;#i=new Map;#s=new Map;#a=null;constructor(t,e,s,r,a,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Uv,this.fontLoader=new jT({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#n(t,e=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return Tt(this,"annotationStorage",new Af)}getRenderingIntent(t,e=Gi.ENABLE,s=null,r=!1,a=!1){let o=os.DISPLAY,u=$d;switch(t){case"any":o=os.ANY;break;case"display":break;case"print":o=os.PRINT;break;default:_t(`getRenderingIntent - invalid intent: ${t}`)}const d=o&os.PRINT&&s instanceof Tv?s:this.annotationStorage;switch(e){case Gi.DISABLE:o+=os.ANNOTATIONS_DISABLE;break;case Gi.ENABLE:break;case Gi.ENABLE_FORMS:o+=os.ANNOTATIONS_FORMS;break;case Gi.ENABLE_STORAGE:o+=os.ANNOTATIONS_STORAGE,u=d.serializable;break;default:_t(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(o+=os.IS_EDITING),a&&(o+=os.OPLIST);const{ids:f,hash:g}=d.modifiedIds,m=[o,u.hash,g];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#i.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Pe.cleanup(),this._networkStream?.cancelAllRequests(new Xi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,r)=>{Mt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},r.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){r.close();return}Mt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{this._fullReader.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:a,contentLength:o}=this._fullReader;return(!r||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:a,contentLength:o}}),t.on("GetRangeReader",(s,r)=>{Mt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(s.begin,s.end);if(!a){r.close();return}r.onPull=()=>{a.read().then(function({value:o,done:u}){if(u){r.close();return}Mt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{a.cancel(o),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new kC(s,this))}),t.on("DocException",s=>{e._capability.reject(Xe(s))}),t.on("PasswordRequest",s=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Xe(s);const r=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};e.onPassword(r,s.code)}catch(r){this.#a.reject(r)}return this.#a.promise}),t.on("DataLoaded",s=>{e.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,a])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in a){const g=a.error;_t(`Error during font loading: ${g}`),this.commonObjs.resolve(s,g);break}const o=new Ht(a),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,d=new LT(o,u,a.extra,a.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=a;Mt(f,"The imageRef must be defined.");for(const g of this.#e.values())for(const[,m]of g.objs)if(m?.ref===f)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,a);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,a,o])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",s=>{this.destroyed||e.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&_t("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#i.get(e);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#s.set(a.refStr,t);const o=new DC(e,a,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#i.set(e,r),r}getPageIndex(t){return qd(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#n("GetOptionalContentConfig").then(e=>new uC(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new lC(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Pe.cleanup()}}cachedPageNumber(t){if(!qd(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#s.get(e)??null}}class jC{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Dr{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:r,annotationCanvasMap:a,operatorList:o,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:m=!1,pageColors:b=null,enableHWA:v=!1,operationsFilter:x=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=m,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new jC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=v,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Dr.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Dr.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:a,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new jr(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Dr.#e.delete(this._canvas),t||=new bf(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Dr.#e.delete(this._canvas),this.callback())))}}const LC="5.4.296",PC="f56dc8601";class xs{#t=null;#e=null;#i;#s=null;#a=!1;#n=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Tt(this,"_keyboardManager",new bo([[["Escape","mac+Escape"],xs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],xs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],xs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],xs.prototype._moveToPrevious],[["Home","mac+Home"],xs.prototype._moveToBeginning],[["End","mac+End"],xs.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#n=!1,this.#r=t):this.#n=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",xs.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#i,t.append(s),t}renderMainDropdown(){const t=this.#s=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Ss,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[s,r]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",r),a.title=s,a.setAttribute("data-l10n-id",xs.#d[s]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=r,a.ariaSelected=r===this.#i,a.addEventListener("click",this.#f.bind(this,r),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Dt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#s.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#s?.firstChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#s.firstChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#s.lastChild?.focus()}#m(t){xs._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#s){this.#s.classList.remove("hidden");return}const e=this.#s=this.#h();this.#t.append(e)}#u(t){this.#s?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#s)return;const e=this.#l.highlightColors.values();for(const s of this.#s.children)s.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#s?.remove(),this.#s=null}}class lo{#t=null;#e=null;#i=null;static#s=null;constructor(t){this.#e=t,this.#i=t._uiManager,lo.#s||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",lo.#s[t]),r.addEventListener("input",()=>{this.#i.updateParams(e,r.value)},{signal:this.#i._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function J0(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}function qa(c){return Math.max(0,Math.min(255,255*c))}class Z0{static CMYK_G([t,e,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=qa(t),[t,t,t]}static G_HTML([t]){const e=J0(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(qa)}static RGB_HTML(t){return`#${t.map(J0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,s,r]){return[qa(1-Math.min(1,t+r)),qa(1-Math.min(1,s+r)),qa(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const r=1-t,a=1-e,o=1-s,u=Math.min(r,a,o);return["CMYK",r,a,o,u]}}class BC{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Vt("Abstract method `_createSVG` called.")}}class vc extends BC{_createSVG(t){return document.createElementNS(ui,t)}}const UC=9,kn=new WeakSet,IC=new Date().getTimezoneOffset()*60*1e3;class tb{static create(t){switch(t.data.annotationType){case me.LINK:return new Cf(t);case me.TEXT:return new FC(t);case me.WIDGET:switch(t.data.fieldType){case"Tx":return new HC(t);case"Btn":return t.data.radioButton?new Hv(t):t.data.checkBox?new qC(t):new GC(t);case"Ch":return new VC(t);case"Sig":return new $C(t)}return new Mn(t);case me.POPUP:return new Yd(t);case me.FREETEXT:return new $v(t);case me.LINE:return new XC(t);case me.SQUARE:return new KC(t);case me.CIRCLE:return new WC(t);case me.POLYLINE:return new qv(t);case me.CARET:return new JC(t);case me.INK:return new Rf(t);case me.POLYGON:return new QC(t);case me.HIGHLIGHT:return new Gv(t);case me.UNDERLINE:return new ZC(t);case me.SQUIGGLY:return new tR(t);case me.STRIKEOUT:return new eR(t);case me.STAMP:return new Vv(t);case me.FILEATTACHMENT:return new sR(t);default:return new ie(t)}}}class ie{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ie._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:s,rect:r}=this.data;let a=-1/0,o=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>o?(o=e[u+1],a=e[u+2]):e[u+1]===o&&(a=Math.max(a,e[u+2]));return[a,o]}if(s?.length>=1){for(const u of s)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>o?(o=u[d+1],a=u[d]):u[d+1]===o&&(a=Math.max(a,u[d]));if(a!==1/0)return[a,o]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/s,t[1]=100*(t[1]-o)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${no}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:s})||this.annotationStorage.setValue(`${no}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:s}=t;e&&this.#s(e);let r=this.#i?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#i.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:u,pageY:d}}}}=this;s?.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(o-t[3]+d)/o}%`,r===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:s,viewport:r}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Mn)&&!(this instanceof Cf)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Yd){const{rotation:w}=e;return!e.hasOwnCanvas&&w!==0&&this.setRotation(w,a),a}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const w=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(w>0||S>0){const R=`calc(${w}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;o.borderRadius=R}else if(this instanceof Hv){const R=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;o.borderRadius=R}switch(e.borderStyle.style){case Cr.SOLID:o.borderStyle="solid";break;case Cr.DASHED:o.borderStyle="dashed";break;case Cr.BEVELED:_t("Unimplemented border style: beveled");break;case Cr.INSET:_t("Unimplemented border style: inset");break;case Cr.UNDERLINE:o.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,o.borderColor=at.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):o.borderWidth=0}const f=at.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:g,pageHeight:m,pageX:b,pageY:v}=r.rawDims;o.left=`${100*(f[0]-b)/g}%`,o.top=`${100*(f[1]-v)/m}%`;const{rotation:x}=e;return e.hasOwnCanvas||x===0?(o.width=`${100*u/g}%`,o.height=`${100*d/m}%`):this.setRotation(x,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:a,height:o}=this;t%180!==0&&([a,o]=[o,a]),e.style.width=`${100*a/s}%`,e.style.height=`${100*o/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,r)=>{const a=r.detail[e],o=a[0],u=a.slice(1);r.target.style[s]=Z0[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:Z0[`${o}_rgb`](u)})};return Tt(this,"_commonActions",{display:e=>{const{display:s}=e.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||s[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[r,a]of Object.entries(e)){const o=s[r];if(o){const u={detail:{[r]:a},target:t};o(u),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,r,a]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,S,E,R]=t.subarray(2,6);if(r===w&&a===S&&e===E&&s===R)return}const{style:o}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:S}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const d=r-e,f=a-s,{svgFactory:g}=this,m=g.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const b=g.createElement("defs");m.append(b);const v=g.createElement("clipPath"),x=`clippath_${this.data.id}`;v.setAttribute("id",x),v.setAttribute("clipPathUnits","objectBoundingBox"),b.append(v);for(let w=2,S=t.length;w<S;w+=8){const E=t[w],R=t[w+1],T=t[w+2],N=t[w+3],D=g.createElement("rect"),M=(T-e)/d,L=(a-R)/f,G=(E-T)/d,X=(R-N)/f;D.setAttribute("x",M),D.setAttribute("y",L),D.setAttribute("width",G),D.setAttribute("height",X),v.append(D),u?.push(`<rect vector-effect="non-scaling-stroke" x="${M}" y="${L}" width="${G}" height="${X}"/>`)}this.#e&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(m),this.container.style.clipPath=`url(#${x})`}_createPopup(t=null){const{data:e}=this;let s,r;t?(s={str:t.text},r=t.date):(s=e.contentsObj,r=e.modificationDate);const a=this.#i=new Yd({data:{color:e.color,titleObj:e.titleObj,modificationDate:r,contentsObj:s,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Vt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:a,id:o,exportValues:u}of r){if(a===-1||o===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${o}"]`);if(f&&!kn.has(f)){_t(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:d,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:a}=r,o=r.getAttribute("data-element-id");o!==e&&kn.has(r)&&s.push({id:o,exportValue:a,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class zC extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class Cf extends ie{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#i(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,s=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),s&&(t.title=s),this.#t()}#e(t,e,s="",r=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#i(t,e,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const a=s.get(r);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){_t('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:a,include:o}=e,u=[];if(r.length!==0||a.length!==0){const g=new Set(a);for(const m of r){const b=this._fieldObjects[m]||[];for(const{id:v}of b)g.add(v)}for(const m of Object.values(this._fieldObjects))for(const b of m)g.has(b.id)===o&&u.push(b)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const d=this.annotationStorage,f=[];for(const g of u){const{id:m}=g;switch(f.push(m),g.type){case"text":{const v=g.defaultValue||"";d.setValue(m,{value:v});break}case"checkbox":case"radiobutton":{const v=g.defaultValue===g.exportValues;d.setValue(m,{value:v});break}case"combobox":case"listbox":{const v=g.defaultValue||"";d.setValue(m,{value:v});break}default:continue}const b=document.querySelector(`[data-element-id="${m}"]`);if(b){if(!kn.has(b)){_t(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class FC extends ie{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Mn extends ie{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return De.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,r,a){s.includes("mouse")?t.addEventListener(s,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(s,o=>{if(s==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(o)}})})}_setEventListeners(t,e,s,r){for(const[a,o]of s)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,o,r),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":at.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||UC,a=t.style;let o;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(f/(gd*r))||1,m=f/g;o=Math.min(r,d(m/gd))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(r,d(f/gd))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=at.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class HC extends Mn{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,r){const a=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=s),a.setValue(o.id,{[r]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let a=r.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),kn.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:m}=this.data,b=!!g&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),o&&(s.maxLength=o),s.addEventListener("input",x=>{t.setValue(e,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",x=>{const w=this.data.defaultFieldValue??"";s.value=d.userValue=w,d.formattedValue=null});let v=x=>{const{formattedValue:w}=d;w!=null&&(x.target.value=w),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",w=>{if(d.focused)return;const{target:S}=w;if(b&&(S.type=g,m&&(S.step=m)),d.userValue){const E=d.userValue;if(b)if(g==="time"){const R=new Date(E),T=[R.getHours(),R.getMinutes(),R.getSeconds()];S.value=T.map(N=>N.toString().padStart(2,"0")).join(":")}else S.value=new Date(E-IC).toISOString().split(g==="date"?"T":".",1)[0];else S.value=E}d.lastCommittedValue=S.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const S={value(E){d.userValue=E.detail.value??"",b||t.setValue(e,{value:d.userValue.toString()}),E.target.value=d.userValue},formattedValue(E){const{formattedValue:R}=E.detail;d.formattedValue=R,R!=null&&E.target!==document.activeElement&&(E.target.value=R);const T={formattedValue:R};b&&(T.value=R),t.setValue(e,T)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:R}=E.detail,{target:T}=E;if(R===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",R);let N=d.userValue;!N||N.length<=R||(N=N.slice(0,R),T.value=d.userValue=N,t.setValue(e,{value:N}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(S,w)}),s.addEventListener("keydown",w=>{d.commitKey=1;let S=-1;if(w.key==="Escape"?S=0:w.key==="Enter"&&!this.data.multiLine?S=2:w.key==="Tab"&&(d.commitKey=3),S===-1)return;const{value:E}=w.target;d.lastCommittedValue!==E&&(d.lastCommittedValue=E,d.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:S,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const x=v;v=null,s.addEventListener("blur",w=>{if(!d.focused||!w.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:S}=w;let{value:E}=S;if(b){if(E&&g==="time"){const R=E.split(":").map(T=>parseInt(T,10));E=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),S.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();S.type="text"}d.userValue=E,d.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:d.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),x(w)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",w=>{d.lastCommittedValue=null;const{data:S,target:E}=w,{value:R,selectionStart:T,selectionEnd:N}=E;let D=T,M=N;switch(w.inputType){case"deleteWordBackward":{const L=R.substring(0,T).match(/\w*[^\w]*$/);L&&(D-=L[0].length);break}case"deleteWordForward":{const L=R.substring(T).match(/^[^\w]*\w*/);L&&(M+=L[0].length);break}case"deleteContentBackward":T===N&&(D-=1);break;case"deleteContentForward":T===N&&(M+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,change:S||"",willCommit:!1,selStart:D,selEnd:M}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/o;s.classList.add("comb"),s.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $C extends Mn{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class qC extends Mn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return kn.add(a),a.setAttribute("data-element-id",s),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const f of this._getElementsByName(u,s)){const g=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(s,{value:d})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue||"Off";o.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(s,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Hv extends Mn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(s,{value:r})),r)for(const o of this._getElementsByName(e.fieldName,s))t.setValue(o.id,{value:!1});const a=document.createElement("input");if(kn.add(a),a.setAttribute("data-element-id",s),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:d})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue;o.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const g=o===f.detail.value;for(const m of this._getElementsByName(f.target.name)){const b=g&&m.id===s;m.domElement&&(m.domElement.checked=b),t.setValue(m.id,{value:b})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class GC extends Cf{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class VC extends Mn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");kn.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",g=>{const m=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===m});for(const g of this.data.options){const m=document.createElement("option");m.textContent=g.displayValue,m.value=g.exportValue,s.value.includes(g.exportValue)&&(m.setAttribute("selected",!0),a=!1),r.append(m)}let o=null;if(a){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),r.prepend(g),o=()=>{g.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const u=g=>{const m=g?"value":"textContent",{options:b,multiple:v}=r;return v?Array.prototype.filter.call(b,x=>x.selected).map(x=>x[m]):b.selectedIndex===-1?null:b[b.selectedIndex][m]};let d=u(!1);const f=g=>{const m=g.target.options;return Array.prototype.map.call(m,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",g=>{const m={value(b){o?.();const v=b.detail.value,x=new Set(Array.isArray(v)?v:[v]);for(const w of r.options)w.selected=x.has(w.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(b){r.multiple=!0},remove(b){const v=r.options,x=b.detail.remove;v[x].selected=!1,r.remove(x),v.length>0&&Array.prototype.findIndex.call(v,S=>S.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},clear(b){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(b){const{index:v,displayValue:x,exportValue:w}=b.detail.insert,S=r.children[v],E=document.createElement("option");E.textContent=x,E.value=w,S?S.before(E):r.append(E),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},items(b){const{items:v}=b.detail;for(;r.length!==0;)r.remove(0);for(const x of v){const{displayValue:w,exportValue:S}=x,E=document.createElement("option");E.textContent=w,E.value=S,r.append(E)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),d=u(!1)},indices(b){const v=new Set(b.detail.indices);for(const x of b.target.options)x.selected=v.has(x.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(m,g)}),r.addEventListener("input",g=>{const m=u(!0),b=u(!1);t.setValue(e,{value:m}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:b,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):r.addEventListener("input",function(g){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Yd extends ie{constructor(t){const{data:e,elements:s,parent:r}=t,a=!!r._commentManager;if(super(t,{isRenderable:!a&&ie._hasPopupData(e)}),this.elements=s,a&&ie._hasPopupData(e)){const o=this.popup=this.#t();for(const u of s)u.popup=o}else this.popup=null}#t(){return new YC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${yf}${r}`).join(",")),this.container}}class YC{#t=null;#e=this.#q.bind(this);#i=this.#I.bind(this);#s=this.#M.bind(this);#a=this.#_.bind(this);#n=null;#r=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#x=null;#w=null;#C=!1;#A=null;#S=null;constructor({container:t,color:e,elements:s,titleObj:r,modificationDate:a,contentsObj:o,richText:u,parent:d,rect:f,parentRect:g,open:m,commentManager:b=null}){this.#r=t,this.#x=r,this.#o=o,this.#E=u,this.#d=d,this.#n=e,this.#b=f,this.#h=g,this.#l=s,this.#t=b,this.#A=s[0],this.#c=zd.toDateObject(a),this.trigger=s.flatMap(v=>v.getElementsToTriggerPopup()),b?this.renderCommentButton():(this.#O(),this.#r.hidden=!0,m&&this.#_())}#O(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#s,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p||(this.#y||this.#R(),!this.#y))return;const{signal:t}=this.#g=new AbortController,e=!!this.#A.extraPopupElement,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#A.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",s,{signal:t}),o.addEventListener("pointerenter",r,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const u=this.#A.container;o.style.zIndex=u.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#B(),this.#N(),o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",s,{signal:t}),o.addEventListener("pointerenter",r,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),u.after(o)}}#N(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.renderCommentButton();const[t,e]=this.#y,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${e}% - var(--comment-button-dim))`}#B(){this.#A.extraPopupElement||(this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:s,creationDate:r,modificationDate:a}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:s,creationDate:r,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#A.commentText,this.#S}set comment(t){t!==this.comment&&(this.#A.commentText=this.#S=t)}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:s}=this.#p.getBoundingClientRect(),{x:r,y:a,width:o,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/o,(e+s-a)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:a,y:o,width:u,height:d}=r;this.#t.showDialog(null,this,a+e*u,o+s*d,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#n){const s=t.style.outlineColor=at.makeHexColor(...this.#n);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(t.append(e),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),e.append(s)}xv({html:this.#D||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#D(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#j(){return this.#D?.attributes?.style?.fontSize||0}get#U(){return this.#D?.attributes?.style?.color||null}#L(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#U,fontSize:this.#j?`calc(${this.#j}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:r});return s}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:t,popup:e,deleted:s}){if(this.#t){s?(this.remove(),this.#S=null):e&&(e.deleted?this.remove():(this.#B(),this.#S=e.text)),t&&(this.#y=null,this.#R(),this.#N());return}if(s||e?.deleted){this.remove();return}this.#O(),this.#w||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#L(e.text),this.#c=zd.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#E}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:r,pageY:a}}}=this.#d;let o=!!this.#h,u=o?this.#h:this.#b;for(const x of this.#l)if(!u||at.intersect(x.data.rect,u)!==null){u=x.data.rect,o=!0;break}const d=at.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=o?u[2]-u[0]+5:0,m=d[0]+g,b=d[1];this.#u=[100*(m-r)/e,100*(b-a)/s];const{style:v}=this.#r;v.left=`${this.#u[0]}%`,v.top=`${this.#u[1]}%`}#_(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#M(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#I(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#M(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#T(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#I(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#O(),this.#C&&(this.#m||this.#M(),this.#C=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class $v extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=At.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class XC extends ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:s}=this,r=this.svgFactory.create(e,s,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class KC extends ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:s}=this,r=this.svgFactory.create(e,s,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",e-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class WC extends ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:s}=this,r=this.svgFactory.create(e,s,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",s/2),o.setAttribute("rx",e/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class qv extends ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!e)return this.container;const u=this.svgFactory.create(a,o,!0);let d=[];for(let g=0,m=e.length;g<m;g+=2){const b=e[g]-t[0],v=t[3]-e[g+1];d.push(`${b},${v}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class QC extends qv{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class JC extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Rf extends ie{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?At.HIGHLIGHT:At.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",r.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",o);for(let m=0,b=s.length;m<b;m++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",s[m].join(",")),g.append(v)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:r}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),s)for(let o=0,u=this.#e.length;o<u;o++)this.#e[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:u,height:d}=this.#i(this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gv extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=At.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class ZC extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class tR extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class eR extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Vv extends ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=At.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class sR extends ie{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=De.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Nf{#t=null;#e=null;#i=null;#s=new Map;#a=null;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:r,page:a,viewport:o,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:g}){this.div=t,this.#t=e,this.#e=s,this.#a=u||null,this.#n=f||null,this.#i=g||new Af,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=d||null}hasEditableAnnotations(){return this.#s.size>0}async#r(t,e,s){const r=t.firstChild||t,a=r.id=`${yf}${e}`,o=await this.#a?.getAriaAttributes(a);if(o)for(const[u,d]of o)r.setAttribute(u,d);s?s.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,r,!1))}async render(t){const{annotations:e}=t,s=this.div;On(s,this.viewport);const r=new Map,a={data:null,layer:s,linkService:this.#n,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new vc,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const u=o.annotationType===me.POPUP;if(u){const g=r.get(o.id);if(!g)continue;a.elements=g}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;a.data=o;const d=tb.create(a);if(!d.isRenderable)continue;if(!u&&o.popupRef){const g=r.get(o.popupRef);g?g.push(d):r.set(o.popupRef,[d])}const f=d.render();o.hidden&&(f.style.visibility="hidden"),await this.#r(f,o.id,a.elements),d.extraPopupElement?.popup?.renderCommentButton(),d._isEditable&&(this.#s.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#n,svgFactory:new vc,parent:this};for(const s of t){s.borderStyle||=Nf._defaultBorderStyle,e.data=s;const r=tb.create(e);if(!r.isRenderable)continue;const a=r.render();await this.#r(a,s.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,On(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=this.#s.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(t){return this.#s.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:s,rotation:r}=t,a=new zC({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#n,annotationStorage:this.#i}),o=a.render();return e.append(o),this.#t?.moveElementInDOM(e,o,o,!1),a.createOrUpdatePopup(),a}static get _defaultBorderStyle(){return Tt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Cr.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const sc=/\r\n?|\n/g;class Ae extends dt{#t="";#e=`${this.id}-editor`;#i=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Ae.prototype,e=a=>a.isEmpty(),s=Ki.TRANSLATE_SMALL,r=Ki.TRANSLATE_BIG;return Tt(this,"_keyboardManager",new bo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=At.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Ae._defaultColor||dt._defaultLineColor,this.#s=t.fontSize||Ae._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){dt.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Dt.FREETEXT_SIZE:Ae._defaultFontSize=e;break;case Dt.FREETEXT_COLOR:Ae._defaultColor=e;break}}updateParams(t,e){switch(t){case Dt.FREETEXT_SIZE:this.#a(e);break;case Dt.FREETEXT_COLOR:this.#n(e);break}}static get defaultPropertiesToUpdate(){return[[Dt.FREETEXT_SIZE,Ae._defaultFontSize],[Dt.FREETEXT_COLOR,Ae._defaultColor||dt._defaultLineColor]]}get propertiesToUpdate(){return[[Dt.FREETEXT_SIZE,this.#s],[Dt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new lo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Dt.FREETEXT_COLOR}#a(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#o()},s=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Dt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#n(t){const e=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Dt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ae._internalPadding*t,-(Ae._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(Ae.#c(s)),e=s);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,u=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ae._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,g]=this.pageDimensions,[m,b]=this.pageTranslation;let v,x;switch(this.rotation){case 0:v=t+(o[0]-m)/f,x=e+this.height-(o[1]-b)/g;break;case 90:v=t+(o[0]-m)/f,x=e-(o[1]-b)/g,[u,d]=[d,-u];break;case 180:v=t-this.width+(o[0]-m)/f,x=e-(o[1]-b)/g,[u,d]=[-u,-d];break;case 270:v=t+(o[0]-m-this.height*g)/f,x=e+(o[1]-b-this.width*f)/g,[u,d]=[-d,u];break}this.setAt(v*r,x*a,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(sc,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=Ae.#h(e.getData("text")||"").replaceAll(sc,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:u,startOffset:d}=o,f=[],g=[];if(u.nodeType===Node.TEXT_NODE){const v=u.parentElement;if(g.push(u.nodeValue.slice(d).replaceAll(sc,"")),v!==this.editorDiv){let x=f;for(const w of this.editorDiv.childNodes){if(w===v){x=g;continue}x.push(Ae.#c(w))}}f.push(u.nodeValue.slice(0,d).replaceAll(sc,""))}else if(u===this.editorDiv){let v=f,x=0;for(const w of this.editorDiv.childNodes)x++===d&&(v=g),v.push(Ae.#c(w))}this.#t=`${f.join(`
`)}${r}${g.join(`
`)}`,this.#l();const m=new Range;let b=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(b<=x){m.setStart(v,b),m.setEnd(v,b);break}b-=x}a.removeAllRanges(),a.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ae._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,s){let r=null;if(t instanceof $v){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:d,rotation:f,id:g,popupRef:m,richText:b,contentsObj:v,creationDate:x,modificationDate:w},textContent:S,textPosition:E,parent:{page:{pageNumber:R}}}=t;if(!S||S.length===0)return null;r=t={annotationType:At.FREETEXT,color:Array.from(u),fontSize:o,value:S.join(`
`),position:E,pageIndex:R-1,rect:d.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:m,comment:v?.str||null,richText:b,creationDate:x,modificationDate:w}}const a=await super.deserialize(t,e,s);return a.#s=t.fontSize,a.color=at.makeHexColor(...t.color),a.#t=Ae.#h(t.value),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=dt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:e,fontSize:this.#s,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:e,fontSize:s,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((o,u)=>o!==r[u])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:s}=e;s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,e.replaceChildren();for(const r of this.#t.split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),e.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class nt{static PRECISION=1e-4;toSVGPath(){Vt("Abstract method `toSVGPath` must be implemented.")}get box(){Vt("Abstract getter `box` must be implemented.")}serialize(t,e){Vt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,r,a,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=e+t[u]*r,o[u+1]=s+t[u+1]*a;return o}static _rescaleAndSwap(t,e,s,r,a,o){o||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)o[u]=e+t[u+1]*r,o[u+1]=s+t[u]*a;return o}static _translate(t,e,s,r){r||=new Float32Array(t.length);for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a],r[a+1]=s+t[a+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,r,a){switch(a){case 90:return[1-e/s,t/r];case 180:return[1-t/s,1-e/r];case 270:return[e/s,1-t/r];default:return[t/s,e/r]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,r,a,o){return[(t+5*s)/6,(e+5*r)/6,(5*s+a)/6,(5*r+o)/6,(s+a)/2,(r+o)/2]}}class Tn{#t;#e=[];#i;#s;#a=[];#n=new Float32Array(18);#r;#o;#c;#l;#d;#h;#f=[];static#m=8;static#g=2;static#u=Tn.#m+Tn.#g;constructor({x:t,y:e},s,r,a,o,u=0){this.#t=s,this.#h=a*r,this.#s=o,this.#n.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=Tn.#m*r,this.#c=Tn.#u*r,this.#d=r,this.#f.push(t,e)}isEmpty(){return isNaN(this.#n[8])}#p(){const t=this.#n.subarray(4,6),e=this.#n.subarray(16,18),[s,r,a,o]=this.#t;return[(this.#r+(t[0]-e[0])/2-s)/a,(this.#o+(t[1]-e[1])/2-r)/o,(this.#r+(e[0]-t[0])/2-s)/a,(this.#o+(e[1]-t[1])/2-r)/o]}add({x:t,y:e}){this.#r=t,this.#o=e;const[s,r,a,o]=this.#t;let[u,d,f,g]=this.#n.subarray(8,12);const m=t-f,b=e-g,v=Math.hypot(m,b);if(v<this.#c)return!1;const x=v-this.#l,w=x/v,S=w*m,E=w*b;let R=u,T=d;u=f,d=g,f+=S,g+=E,this.#f?.push(t,e);const N=-E/x,D=S/x,M=N*this.#h,L=D*this.#h;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([f+M,g+L],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([f-M,g-L],16),isNaN(this.#n[6])?(this.#a.length===0&&(this.#n.set([u+M,d+L],2),this.#a.push(NaN,NaN,NaN,NaN,(u+M-s)/a,(d+L-r)/o),this.#n.set([u-M,d-L],14),this.#e.push(NaN,NaN,NaN,NaN,(u-M-s)/a,(d-L-r)/o)),this.#n.set([R,T,u,d,f,g],6),!this.isEmpty()):(this.#n.set([R,T,u,d,f,g],6),Math.abs(Math.atan2(T-d,R-u)-Math.atan2(E,S))<Math.PI/2?([u,d,f,g]=this.#n.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/a,((d+g)/2-r)/o),[u,d,R,T]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((R+u)/2-s)/a,((T+d)/2-r)/o),!0):([R,T,u,d,f,g]=this.#n.subarray(0,6),this.#a.push(((R+5*u)/6-s)/a,((T+5*d)/6-r)/o,((5*u+f)/6-s)/a,((5*d+g)/6-r)/o,((u+f)/2-s)/a,((d+g)/2-r)/o),[f,g,u,d,R,T]=this.#n.subarray(12,18),this.#e.push(((R+5*u)/6-s)/a,((T+5*d)/6-r)/o,((5*u+f)/6-s)/a,((5*d+g)/6-r)/o,((u+f)/2-s)/a,((d+g)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(s);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,e,s,r]=this.#t,[a,o,u,d]=this.#p();return`M${(this.#n[2]-t)/s} ${(this.#n[3]-e)/r} L${(this.#n[4]-t)/s} ${(this.#n[5]-e)/r} L${a} ${o} L${u} ${d} L${(this.#n[16]-t)/s} ${(this.#n[17]-e)/r} L${(this.#n[14]-t)/s} ${(this.#n[15]-e)/r} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,s,r,a]=this.#t,o=this.#n.subarray(4,6),u=this.#n.subarray(16,18),[d,f,g,m]=this.#p();t.push(`L${(o[0]-e)/r} ${(o[1]-s)/a} L${d} ${f} L${g} ${m} L${(u[0]-e)/r} ${(u[1]-s)/a}`)}newFreeDrawOutline(t,e,s,r,a,o){return new Yv(t,e,s,r,a,o)}getOutlines(){const t=this.#a,e=this.#e,s=this.#n,[r,a,o,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let m=0,b=d.length-2;m<b;m+=2)d[m]=(this.#f[m]-r)/o,d[m+1]=(this.#f[m+1]-a)/u;if(d[d.length-2]=(this.#r-r)/o,d[d.length-1]=(this.#o-a)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let m=0;m<g;m+=2){if(isNaN(t[m])){f[m]=f[m+1]=NaN;continue}f[m]=t[m],f[m+1]=t[m+1]}g=this.#w(f,g);for(let m=e.length-6;m>=6;m-=6)for(let b=0;b<6;b+=2){if(isNaN(e[m+b])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[m+b],f[g+1]=e[m+b+1],g+=2}return this.#x(f,g),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#s)}#E(t){const e=this.#n,[s,r,a,o]=this.#t,[u,d,f,g]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-s)/a,(e[3]-r)/o,NaN,NaN,NaN,NaN,(e[4]-s)/a,(e[5]-r)/o,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-s)/a,(e[17]-r)/o,NaN,NaN,NaN,NaN,(e[14]-s)/a,(e[15]-r)/o],0),this.newFreeDrawOutline(m,t,this.#t,this.#d,this.#i,this.#s)}#x(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#w(t,e){const s=this.#n.subarray(4,6),r=this.#n.subarray(16,18),[a,o,u,d]=this.#t,[f,g,m,b]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-a)/u,(s[1]-o)/d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,(r[0]-a)/u,(r[1]-o)/d],e),e+=24}}class Yv extends nt{#t;#e=new Float32Array(4);#i;#s;#a;#n;#r;constructor(t,e,s,r,a,o){super(),this.#r=t,this.#a=e,this.#t=s,this.#n=r,this.#i=a,this.#s=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[u,d,f,g]=this.#e;for(let m=0,b=t.length;m<b;m+=2)t[m]=(t[m]-u)/f,t[m+1]=(t[m+1]-d)/g;for(let m=0,b=e.length;m<b;m+=2)e[m]=(e[m]-u)/f,e[m+1]=(e[m+1]-d)/g}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,s=this.#r.length;e<s;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,r],a){const o=s-t,u=r-e;let d,f;switch(a){case 0:d=nt._rescale(this.#r,t,r,o,-u),f=nt._rescale(this.#a,t,r,o,-u);break;case 90:d=nt._rescaleAndSwap(this.#r,t,e,o,u),f=nt._rescaleAndSwap(this.#a,t,e,o,u);break;case 180:d=nt._rescale(this.#r,s,e,-o,u),f=nt._rescale(this.#a,s,e,-o,u);break;case 270:d=nt._rescaleAndSwap(this.#r,s,r,-o,-u),f=nt._rescaleAndSwap(this.#a,s,r,-o,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#r;let s=e[4],r=e[5];const a=[s,r,s,r];let o=s,u=r,d=s,f=r;const g=t?Math.max:Math.min,m=new Float32Array(4);for(let v=6,x=e.length;v<x;v+=6){const w=e[v+4],S=e[v+5];isNaN(e[v])?(at.pointBoundingBox(w,S,a),u>S?(o=w,u=S):u===S&&(o=g(o,w)),f<S?(d=w,f=S):f===S&&(d=g(d,w))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,at.bezierBoundingBox(s,r,...e.slice(v,v+6),m),at.rectBoundingBox(m[0],m[1],m[2],m[3],a),u>m[1]?(o=m[0],u=m[1]):u===m[1]&&(o=g(o,m[0])),f<m[3]?(d=m[2],f=m[3]):f===m[3]&&(d=g(d,m[2]))),s=w,r=S}const b=this.#e;b[0]=a[0]-this.#i,b[1]=a[1]-this.#i,b[2]=a[2]-a[0]+2*this.#i,b[3]=a[3]-a[1]+2*this.#i,this.firstPoint=[o,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,s,r,a,o=0){return new Tn(t,e,s,r,a,o)}getNewOutline(t,e){const[s,r,a,o]=this.#e,[u,d,f,g]=this.#t,m=a*f,b=o*g,v=s*f+u,x=r*g+d,w=this.newOutliner({x:this.#a[0]*m+v,y:this.#a[1]*b+x},this.#t,this.#n,t,this.#s,e??this.#i);for(let S=2;S<this.#a.length;S+=2)w.add({x:this.#a[S]*m+v,y:this.#a[S+1]*b+x});return w.getOutlines()}}class Xd{#t;#e;#i;#s=[];#a=[];constructor(t,e=0,s=0,r=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:w,y:S,width:E,height:R}of t){const T=Math.floor((w-e)/o)*o,N=Math.ceil((w+E+e)/o)*o,D=Math.floor((S-e)/o)*o,M=Math.ceil((S+R+e)/o)*o,L=[T,D,M,!0],G=[N,D,M,!1];this.#s.push(L,G),at.rectBoundingBox(T,D,N,M,a)}const u=a[2]-a[0]+2*s,d=a[3]-a[1]+2*s,f=a[0]-s,g=a[1]-s;let m=r?-1/0:1/0,b=1/0;const v=this.#s.at(r?-1:-2),x=[v[0],v[2]];for(const w of this.#s){const[S,E,R,T]=w;!T&&r?E<b?(b=E,m=S):E===b&&(m=Math.max(m,S)):T&&!r&&(E<b?(b=E,m=S):E===b&&(m=Math.min(m,S))),w[0]=(S-f)/u,w[1]=(E-g)/d,w[2]=(R-g)/d}this.#t=new Float32Array([f,g,u,d]),this.#e=[m,b],this.#i=x}getOutlines(){this.#s.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#s)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#n(t)}#n(t){const e=[],s=new Set;for(const o of t){const[u,d,f]=o;e.push([u,d,o],[u,f,o])}e.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=e.length;o<u;o+=2){const d=e[o][2],f=e[o+1][2];d.push(f),f.push(d),s.add(d),s.add(f)}const r=[];let a;for(;s.size>0;){const o=s.values().next().value;let[u,d,f,g,m]=o;s.delete(o);let b=u,v=d;for(a=[u,f],r.push(a);;){let x;if(s.has(g))x=g;else if(s.has(m))x=m;else break;s.delete(x),[u,d,f,g,m]=x,b!==u&&(a.push(b,v,u,v===d?d:f),b=u),v=v===d?f:d}a.push(b,v)}return new iR(r,this.#t,this.#e,this.#i)}#r(t){const e=this.#a;let s=0,r=e.length-1;for(;s<=r;){const a=s+r>>1,o=e[a][0];if(o===t)return a;o<t?s=a+1:r=a-1}return r+1}#o([,t,e]){const s=this.#r(t);this.#a.splice(s,0,[t,e])}#c([,t,e]){const s=this.#r(t);for(let r=s;r<this.#a.length;r++){const[a,o]=this.#a[r];if(a!==t)break;if(a===t&&o===e){this.#a.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[a,o]=this.#a[r];if(a!==t)break;if(a===t&&o===e){this.#a.splice(r,1);return}}}#l(t){const[e,s,r]=t,a=[[e,s,r]],o=this.#r(r);for(let u=0;u<o;u++){const[d,f]=this.#a[u];for(let g=0,m=a.length;g<m;g++){const[,b,v]=a[g];if(!(f<=b||v<=d)){if(b>=d){if(v>f)a[g][1]=f;else{if(m===1)return[];a.splice(g,1),g--,m--}continue}a[g][2]=d,v>f&&a.push([e,f,v])}}}return a}}class iR extends nt{#t;#e;constructor(t,e,s,r){super(),this.#e=t,this.#t=e,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const e of this.#e){let[s,r]=e;t.push(`M${s} ${r}`);for(let a=2;a<e.length;a+=2){const o=e[a],u=e[a+1];o===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,e,s,r],a){const o=[],u=s-t,d=r-e;for(const f of this.#e){const g=new Array(f.length);for(let m=0;m<f.length;m+=2)g[m]=t+f[m]*u,g[m+1]=r-f[m+1]*d;o.push(g)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Kd extends Tn{newFreeDrawOutline(t,e,s,r,a,o){return new nR(t,e,s,r,a,o)}}class nR extends Yv{newOutliner(t,e,s,r,a,o=0){return new Kd(t,e,s,r,a,o)}}class ue extends dt{#t=null;#e=0;#i;#s=null;#a=null;#n=null;#r=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=At.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ue.prototype;return Tt(this,"_keyboardManager",new bo([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ue._defaultColor,this.#p=t.thickness||ue._defaultThickness,this.opacity=t.opacity||ue._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Xd(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Xd(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#n=e.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#n;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#l=t;const r=1.5;if(this.#n=t.getNewOutline(this.#p/2+r,.0025),e>=0)this.#d=e,this.#s=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ue.#S(this.#l.box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ue.#S(this.#n.box,m),path:{d:this.#n.toSVGPath()}})}const[a,o,u,d]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=u,this.height=d;break;case 90:{const[m,b]=this.parentDimensions;this.x=o,this.y=1-a,this.width=u*b/m,this.height=d*m/b;break}case 180:this.x=1-a,this.y=1-o,this.width=u,this.height=d;break;case 270:{const[m,b]=this.parentDimensions;this.x=1-o,this.y=a,this.width=u*b/m,this.height=d*m/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-a)/u,(f[1]-o)/d];const{lastPoint:g}=this.#n;this.#m=[(g[0]-a)/u,(g[1]-o)/d]}static initialize(t,e){dt.initialize(t,e),ue._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Dt.HIGHLIGHT_COLOR:ue._defaultColor=e;break;case Dt.HIGHLIGHT_THICKNESS:ue._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Dt.HIGHLIGHT_COLOR:this.#E(e);break;case Dt.HIGHLIGHT_THICKNESS:this.#x(e);break}}static get defaultPropertiesToUpdate(){return[[Dt.HIGHLIGHT_COLOR,ue._defaultColor],[Dt.HIGHLIGHT_THICKNESS,ue._defaultThickness]]}get propertiesToUpdate(){return[[Dt.HIGHLIGHT_COLOR,this.color||ue._defaultColor],[Dt.HIGHLIGHT_THICKNESS,this.#p||ue._defaultThickness],[Dt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:e.bind(this,t,ue._defaultOpacity),undo:e.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Dt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#x(t){const e=this.#p,s=r=>{this.#p=r,this.#w(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Dt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new xs({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#A(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#s}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#s))}static#S([t,e,s,r],a){switch(a){case 90:return[1-e-r,t,r,s];case 180:return[1-t-s,1-e-r,s,r];case 270:return[e,1-t-s,r,s]}return[t,e,s,r]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ue.#S(this.#l.box,t)):s=ue.#S([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#g,{bbox:ue.#S(this.#n.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#O.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#s,this.setDims(this.width,this.height),Sv(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#O(t){ue._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#N(){return this.#h?this.rotation:0}#B(){if(this.#h)return null;const[t,e]=this.pageDimensions,[s,r]=this.pageTranslation,a=this.#i,o=new Float32Array(a.length*8);let u=0;for(const{x:d,y:f,width:g,height:m}of a){const b=d*t+s,v=(1-f)*e+r;o[u]=o[u+4]=b,o[u+1]=o[u+3]=v,o[u+2]=o[u+6]=b+g*t,o[u+5]=o[u+7]=v-m*e,u+=8}return o}#D(t){return this.#l.serialize(t,this.#N())}static startHighlighting(t,e,{target:s,x:r,y:a}){const{x:o,y:u,width:d,height:f}=s.getBoundingClientRect(),g=new AbortController,m=t.combinedSignal(g),b=v=>{g.abort(),this.#U(t,v)};window.addEventListener("blur",b,{signal:m}),window.addEventListener("pointerup",b,{signal:m}),window.addEventListener("pointerdown",ae,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Ss,{signal:m}),s.addEventListener("pointermove",this.#j.bind(this,t),{signal:m}),this._freeHighlight=new Kd({x:r,y:a},[o,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#j(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#U(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let r=null;if(t instanceof Gv){const{data:{quadPoints:x,rect:w,rotation:S,id:E,color:R,opacity:T,popupRef:N,richText:D,contentsObj:M,creationDate:L,modificationDate:G},parent:{page:{pageNumber:X}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(R),opacity:T,quadPoints:x,boxes:null,pageIndex:X-1,rect:w.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,popupRef:N,richText:D,comment:M?.str||null,creationDate:L,modificationDate:G}}else if(t instanceof Rf){const{data:{inkLists:x,rect:w,rotation:S,id:E,color:R,borderStyle:{rawWidth:T},popupRef:N,richText:D,contentsObj:M,creationDate:L,modificationDate:G},parent:{page:{pageNumber:X}}}=t;r=t={annotationType:At.HIGHLIGHT,color:Array.from(R),thickness:T,inkLists:x,boxes:null,pageIndex:X-1,rect:w.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,popupRef:N,richText:D,comment:M?.str||null,creationDate:L,modificationDate:G}}const{color:a,quadPoints:o,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,s);f.color=at.makeHexColor(...a),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[g,m]=f.pageDimensions,[b,v]=f.pageTranslation;if(o){const x=f.#i=[];for(let w=0;w<o.length;w+=8)x.push({x:(o[w]-b)/g,y:1-(o[w+1]-v)/m,width:(o[w+2]-o[w])/g,height:(o[w+1]-o[w+5])/m});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const x=u[0],w={x:x[0]-b,y:m-(x[1]-v)},S=new Kd(w,[0,0,g,m],1,f.#p/2,!0,.001);for(let T=0,N=x.length;T<N;T+=2)w.x=x[T]-b,w.y=m-(x[T+1]-v),S.add(w);const{id:E,clipPathId:R}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);f.#b({highlightOutlines:S.getOutlines(),highlightId:E,clipPathId:R}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=dt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#B(),outlines:this.#D(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#L(s)?null:(s.id=this.annotationElementId,s)}#L(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==e[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Xv{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Vt("Not implemented")}}class yt extends dt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#s=null;static#a=null;static#n=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#u(t.box)}#d(t,e){const{id:s}=e.drawLayer.draw(yt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(e))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Vt("Not implemented")}static get typesMap(){Vt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(yt.#i.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,e[r]]);return t}_updateProperty(t,e,s){const r=this._drawingOptions,a=r[e],o=u=>{r.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#u(d),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,yt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#g()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,yt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#g()),{bbox:this.#p()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,yt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#g(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,s,r]){const{parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[e,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-e,s,r];case 270:return[1-e,t,s*(o/a),r*(a/o)];default:return[t,e,s,r]}}#g(){const{x:t,y:e,width:s,height:r,parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[1-e,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-e,s,r];case 270:return[e,1-t,s*(a/o),r*(o/a)];default:return[t,e,s,r]}}#u(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#p(){const{x:t,y:e,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[u,d]}=this;switch((a*4+o)/90){case 1:return[1-e-r,t,r,s];case 2:return[1-t-s,1-e-r,s,r];case 3:return[e,1-t-s,r,s];case 4:return[t,e-s*(u/d),r*(d/u),s*(u/d)];case 5:return[1-e,t,s*(u/d),r*(d/u)];case 6:return[1-t-r*(d/u),1-e,r*(d/u),s*(u/d)];case 7:return[e-s*(u/d),1-t-r*(d/u),s*(u/d),r*(d/u)];case 8:return[t-s,e-r,s,r];case 9:return[1-e,t-s,r,s];case 10:return[1-t,1-e,s,r];case 11:return[e-r,1-t,r,s];case 12:return[t-r*(d/u),e,r*(d/u),s*(u/d)];case 13:return[1-e-s*(u/d),t-r*(d/u),s*(u/d),r*(d/u)];case 14:return[1-t,1-e-s*(u/d),r*(d/u),s*(u/d)];case 15:return[e,1-t,s*(u/d),r*(d/u)];default:return[t,e,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,yt._mergeSVGProperties({bbox:this.#p()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),s}static createDrawerInstance(t,e,s,r,a){Vt("Not implemented")}static startDrawing(t,e,s,r){const{target:a,offsetX:o,offsetY:u,pointerId:d,pointerType:f}=r;if(yt.#r&&yt.#r!==f)return;const{viewport:{rotation:g}}=t,{width:m,height:b}=a.getBoundingClientRect(),v=yt.#s=new AbortController,x=t.combinedSignal(v);if(yt.#n||=d,yt.#r??=f,window.addEventListener("pointerup",w=>{yt.#n===w.pointerId?this._endDraw(w):yt.#o?.delete(w.pointerId)},{signal:x}),window.addEventListener("pointercancel",w=>{yt.#n===w.pointerId?this._currentParent.endDrawingSession():yt.#o?.delete(w.pointerId)},{signal:x}),window.addEventListener("pointerdown",w=>{yt.#r===w.pointerType&&((yt.#o||=new Set).add(w.pointerId),yt.#i.isCancellable()&&(yt.#i.removeLastElement(),yt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Ss,{signal:x}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),a.addEventListener("touchmove",w=>{w.timeStamp===yt.#c&&ae(w)},{signal:x}),t.toggleDrawing(),e._editorUndoBar?.hide(),yt.#i){t.drawLayer.updateProperties(this._currentDrawId,yt.#i.startNew(o,u,m,b,g));return}e.updateUIForDefaultProperties(this),yt.#i=this.createDrawerInstance(o,u,m,b,g),yt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(yt.#a.toSVGProperties(),yt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(yt.#c=-1,!yt.#i)return;const{offsetX:e,offsetY:s,pointerId:r}=t;if(yt.#n===r){if(yt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,yt.#i.add(e,s)),yt.#c=t.timeStamp,ae(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,yt.#i=null,yt.#a=null,yt.#r=null,yt.#c=NaN),yt.#s&&(yt.#s.abort(),yt.#s=null,yt.#n=NaN,yt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,yt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=yt.#i,r=this._currentDrawId,a=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Dt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Dt.DRAW_STEP),!yt.#i.isEmpty()){const{pageDimensions:[s,r],scale:a}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:yt.#i.getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:yt.#a,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,r,a,o){Vt("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:u}}=e.viewport,d=this.deserializeDraw(o,u,r,a,this._INNER_MARGIN,t),f=await super.deserialize(t,e,s);return f.createDrawingOptions(t),f.#l({drawOutlines:d}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,s]=this.pageTranslation,[r,a]=this.pageDimensions;return this.#t.serialize([e,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class rR{#t=new Float64Array(6);#e;#i;#s;#a;#n;#r="";#o=0;#c=new wo;#l;#d;constructor(t,e,s,r,a,o){this.#l=s,this.#d=r,this.#s=a,this.#a=o,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e],this.#i=[{line:u,points:this.#n}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#h(t,e){return nt._normalizePoint(t,e,this.#l,this.#d,this.#s)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#n.length<=10}add(t,e){[t,e]=this.#h(t,e);const[s,r,a,o]=this.#t.subarray(2,6),u=t-a,d=e-o;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#n.push(t,e),isNaN(s)?(this.#t.set([a,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,a,o,t,e],0),this.#e.push(...nt.createBezierPoints(s,r,a,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,r,a){this.#l=s,this.#d=r,this.#s=a,[t,e]=this.#h(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:o,points:this.#n}),this.#t.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#n=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#r="";for(let t=0,e=this.#i.length;t<e;t++){const{line:s,points:r}=this.#i[t];this.#e=s,this.#n=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=nt.svgRound(this.#e[4]),e=nt.svgRound(this.#e[5]);if(this.#n.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#n.length<=6){const r=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#n.length===4){const r=nt.svgRound(this.#e[10]),a=nt.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${r} ${a}`,this.#o=12,this.#r}const s=[];this.#o===0&&(s.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,a=this.#e.length;r<a;r+=6){const[o,u,d,f,g,m]=this.#e.slice(r,r+6).map(nt.svgRound);s.push(`C${o} ${u} ${d} ${f} ${g} ${m}`)}return this.#r+=s.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,s,r){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,t,e,s,this.#s,this.#a,r),this.#t=null,this.#e=null,this.#i=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class wo extends nt{#t;#e=0;#i;#s;#a;#n;#r;#o;#c;build(t,e,s,r,a,o,u){this.#a=e,this.#n=s,this.#r=r,this.#o=a,this.#c=o,this.#i=u??0,this.#s=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#s.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#s){if(t.push(`M${nt.svgRound(e[4])} ${nt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${nt.svgRound(e[10])} ${nt.svgRound(e[11])}`);continue}for(let s=6,r=e.length;s<r;s+=6){const[a,o,u,d,f,g]=e.subarray(s,s+6).map(nt.svgRound);t.push(`C${a} ${o} ${u} ${d} ${f} ${g}`)}}return t.join("")}serialize([t,e,s,r],a){const o=[],u=[],[d,f,g,m]=this.#d();let b,v,x,w,S,E,R,T,N;switch(this.#o){case 0:N=nt._rescale,b=t,v=e+r,x=s,w=-r,S=t+d*s,E=e+(1-f-m)*r,R=t+(d+g)*s,T=e+(1-f)*r;break;case 90:N=nt._rescaleAndSwap,b=t,v=e,x=s,w=r,S=t+f*s,E=e+d*r,R=t+(f+m)*s,T=e+(d+g)*r;break;case 180:N=nt._rescale,b=t+s,v=e,x=-s,w=r,S=t+(1-d-g)*s,E=e+f*r,R=t+(1-d)*s,T=e+(f+m)*r;break;case 270:N=nt._rescaleAndSwap,b=t+s,v=e+r,x=-s,w=-r,S=t+(1-f-m)*s,E=e+(1-d-g)*r,R=t+(1-f)*s,T=e+(1-d)*r;break}for(const{line:D,points:M}of this.#s)o.push(N(D,b,v,x,w,a?new Array(D.length):null)),u.push(N(M,b,v,x,w,a?new Array(M.length):null));return{lines:o,points:u,rect:[S,E,R,T]}}static deserialize(t,e,s,r,a,{paths:{lines:o,points:u},rotation:d,thickness:f}){const g=[];let m,b,v,x,w;switch(d){case 0:w=nt._rescale,m=-t/s,b=e/r+1,v=1/s,x=-1/r;break;case 90:w=nt._rescaleAndSwap,m=-e/r,b=-t/s,v=1/r,x=1/s;break;case 180:w=nt._rescale,m=t/s+1,b=-e/r,v=-1/s,x=1/r;break;case 270:w=nt._rescaleAndSwap,m=e/r+1,b=t/s+1,v=-1/r,x=-1/s;break}if(!o){o=[];for(const E of u){const R=E.length;if(R===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(R===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(R-2));o.push(T);let[N,D,M,L]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,N,D],0);for(let G=4;G<R;G+=2){const X=E[G],et=E[G+1];T.set(nt.createBezierPoints(N,D,M,L,X,et),(G-2)*3),[N,D,M,L]=[M,L,X,et]}}}for(let E=0,R=o.length;E<R;E++)g.push({line:w(o[E].map(T=>T??NaN),m,b,v,x),points:w(u[E].map(T=>T??NaN),m,b,v,x)});const S=new this.prototype.constructor;return S.build(g,s,r,1,d,f,a),S}#l(t=this.#c){const e=this.#i+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#n]:[e/this.#n,e/this.#a]}#d(){const[t,e,s,r]=this.#t,[a,o]=this.#l(0);return[t+a,e+o,s-2*a,r-2*o]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#s){if(r.length<=12){for(let u=4,d=r.length;u<d;u+=6)at.pointBoundingBox(r[u],r[u+1],t);continue}let a=r[4],o=r[5];for(let u=6,d=r.length;u<d;u+=6){const[f,g,m,b,v,x]=r.subarray(u,u+6);at.bezierBoundingBox(a,o,f,g,m,b,v,x,t),a=v,o=x}}const[e,s]=this.#l();t[0]=Ue(t[0]-e,0,1),t[1]=Ue(t[1]-s,0,1),t[2]=Ue(t[2]+e,0,1),t[3]=Ue(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#l();this.#c=t;const[r,a]=this.#l(),[o,u]=[r-e,a-s],d=this.#t;return d[0]-=o,d[1]-=u,d[2]+=2*o,d[3]+=2*u,d}updateParentDimensions([t,e],s){const[r,a]=this.#l();this.#a=t,this.#n=e,this.#r=s;const[o,u]=this.#l(),d=o-r,f=u-a,g=this.#t;return g[0]-=d,g[1]-=f,g[2]+=2*d,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(nt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,r=0,a=0,o=0,u=0,d=0;switch(this.#e){case 90:r=e/t,a=-t/e,u=t;break;case 180:s=-1,o=-1,u=t,d=e;break;case 270:r=-e/t,a=t/e,d=e;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${nt.svgRound(u)} ${nt.svgRound(d)})`}getPathResizingSVGProperties([t,e,s,r]){const[a,o]=this.#l(),[u,d,f,g]=this.#t;if(Math.abs(f-a)<=nt.PRECISION||Math.abs(g-o)<=nt.PRECISION){const w=t+s/2-(u+f/2),S=e+r/2-(d+g/2);return{path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${w} ${S})`}}}const m=(s-2*a)/(f-2*a),b=(r-2*o)/(g-2*o),v=f/s,x=g/r;return{path:{"transform-origin":`${nt.svgRound(u)} ${nt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${v} ${x}) translate(${nt.svgRound(a)} ${nt.svgRound(o)}) scale(${m} ${b}) translate(${nt.svgRound(-a)} ${nt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,s,r]){const[a,o]=this.#l(),u=this.#t,[d,f,g,m]=u;if(u[0]=t,u[1]=e,u[2]=s,u[3]=r,Math.abs(g-a)<=nt.PRECISION||Math.abs(m-o)<=nt.PRECISION){const S=t+s/2-(d+g/2),E=e+r/2-(f+m/2);for(const{line:R,points:T}of this.#s)nt._translate(R,S,E,R),nt._translate(T,S,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*a)/(g-2*a),v=(r-2*o)/(m-2*o),x=-b*(d+a)+t+a,w=-v*(f+o)+e+o;if(b!==1||v!==1||x!==0||w!==0)for(const{line:S,points:E}of this.#s)nt._rescale(S,x,w,b,v,S),nt._rescale(E,x,w,b,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[r,a]=s,o=this.#t,u=t-o[0],d=e-o[1];if(this.#a===r&&this.#n===a)for(const{line:f,points:g}of this.#s)nt._translate(f,u,d,f),nt._translate(g,u,d,g);else{const f=this.#a/r,g=this.#n/a;this.#a=r,this.#n=a;for(const{line:m,points:b}of this.#s)nt._rescale(m,u,d,f,g,m),nt._rescale(b,u,d,f,g,b);o[2]*=f,o[3]*=g}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t[0])} ${nt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Dc extends Xv{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:dt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Dc(this._viewParameters);return t.updateAll(this),t}}class Of extends yt{static _type="ink";static _editorType=At.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){dt.initialize(t,e),this._defaultDrawingOptions=new Dc(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Tt(this,"typesMap",new Map([[Dt.INK_THICKNESS,"stroke-width"],[Dt.INK_COLOR,"stroke"],[Dt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,r,a){return new rR(t,e,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,r,a,o){return wo.deserialize(t,e,s,r,a,o)}static async deserialize(t,e,s){let r=null;if(t instanceof Rf){const{data:{inkLists:o,rect:u,rotation:d,id:f,color:g,opacity:m,borderStyle:{rawWidth:b},popupRef:v,richText:x,contentsObj:w,creationDate:S,modificationDate:E},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:At.INK,color:Array.from(g),thickness:b,opacity:m,paths:{points:o},boxes:null,pageIndex:R-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:v,richText:x,comment:w?.str||null,creationDate:S,modificationDate:E}}const a=await super.deserialize(t,e,s);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||=new lo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Dt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=Of.getDefaultDrawingOptions({stroke:at.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,u=Object.assign(super.serialize(t),{color:dt._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:e,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,u)=>o!==e[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Wd extends wo{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ic=8,Ga=3;class Nr{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,s,r){return s-=t,r-=e,s===0?r>0?0:4:s===1?r+6:2-r}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#s(t,e,s,r,a,o,u){const d=this.#e(s,r,a,o);for(let f=0;f<8;f++){const g=(-f+d-u+16)%8,m=this.#i[2*g],b=this.#i[2*g+1];if(t[(s+m)*e+(r+b)]!==0)return g}return-1}static#a(t,e,s,r,a,o,u){const d=this.#e(s,r,a,o);for(let f=0;f<8;f++){const g=(f+d+u+16)%8,m=this.#i[2*g],b=this.#i[2*g+1];if(t[(s+m)*e+(r+b)]!==0)return g}return-1}static#n(t,e,s,r){const a=t.length,o=new Int32Array(a);for(let g=0;g<a;g++)o[g]=t[g]<=r?1:0;for(let g=1;g<s-1;g++)o[g*e]=o[g*e+e-1]=0;for(let g=0;g<e;g++)o[g]=o[e*s-1-g]=0;let u=1,d;const f=[];for(let g=1;g<s-1;g++){d=1;for(let m=1;m<e-1;m++){const b=g*e+m,v=o[b];if(v===0)continue;let x=g,w=m;if(v===1&&o[b-1]===0)u+=1,w-=1;else if(v>=1&&o[b+1]===0)u+=1,w+=1,v>1&&(d=v);else{v!==1&&(d=Math.abs(v));continue}const S=[m,g],E=w===m+1,R={isHole:E,points:S,id:u,parent:0};f.push(R);let T;for(const Z of f)if(Z.id===d){T=Z;break}T?T.isHole?R.parent=E?T.parent:d:R.parent=E?d:T.parent:R.parent=E?d:0;const N=this.#s(o,e,g,m,x,w,0);if(N===-1){o[b]=-u,o[b]!==1&&(d=Math.abs(o[b]));continue}let D=this.#i[2*N],M=this.#i[2*N+1];const L=g+D,G=m+M;x=L,w=G;let X=g,et=m;for(;;){const Z=this.#a(o,e,X,et,x,w,1);D=this.#i[2*Z],M=this.#i[2*Z+1];const P=X+D,Q=et+M;S.push(Q,P);const tt=X*e+et;if(o[tt+1]===0?o[tt]=-u:o[tt]===1&&(o[tt]=u),P===g&&Q===m&&X===L&&et===G){o[b]!==1&&(d=Math.abs(o[b]));break}else x=X,w=et,X=P,et=Q}}}return f}static#r(t,e,s,r){if(s-e<=4){for(let L=e;L<s-2;L+=2)r.push(t[L],t[L+1]);return}const a=t[e],o=t[e+1],u=t[s-4]-a,d=t[s-3]-o,f=Math.hypot(u,d),g=u/f,m=d/f,b=g*o-m*a,v=d/u,x=1/f,w=Math.atan(v),S=Math.cos(w),E=Math.sin(w),R=x*(Math.abs(S)+Math.abs(E)),T=x*(1-R+R**2),N=Math.max(Math.atan(Math.abs(E+S)*T),Math.atan(Math.abs(E-S)*T));let D=0,M=e;for(let L=e+2;L<s-2;L+=2){const G=Math.abs(b-g*t[L+1]+m*t[L]);G>D&&(M=L,D=G)}D>(f*N)**2?(this.#r(t,e,M+2,r),this.#r(t,M,s,r)):r.push(a,o)}static#o(t){const e=[],s=t.length;return this.#r(t,0,s,e),e.push(t[s-2],t[s-1]),e.length<=4?null:e}static#c(t,e,s,r,a,o){const u=new Float32Array(o**2),d=-2*r**2,f=o>>1;for(let w=0;w<o;w++){const S=(w-f)**2;for(let E=0;E<o;E++)u[w*o+E]=Math.exp((S+(E-f)**2)/d)}const g=new Float32Array(256),m=-2*a**2;for(let w=0;w<256;w++)g[w]=Math.exp(w**2/m);const b=t.length,v=new Uint8Array(b),x=new Uint32Array(256);for(let w=0;w<s;w++)for(let S=0;S<e;S++){const E=w*e+S,R=t[E];let T=0,N=0;for(let M=0;M<o;M++){const L=w+M-f;if(!(L<0||L>=s))for(let G=0;G<o;G++){const X=S+G-f;if(X<0||X>=e)continue;const et=t[L*e+X],Z=u[M*o+G]*g[Math.abs(et-R)];T+=et*Z,N+=Z}}const D=v[E]=Math.round(T/N);x[D]++}return[v,x]}static#l(t){const e=new Uint32Array(256);for(const s of t)e[s]++;return e}static#d(t){const e=t.length,s=new Uint8ClampedArray(e>>2);let r=-1/0,a=1/0;for(let u=0,d=s.length;u<d;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),a=Math.min(a,f)}const o=255/(r-a);for(let u=0,d=s.length;u<d;u++)s[u]=(s[u]-a)*o;return s}static#h(t){let e,s=-1/0,r=-1/0;const a=t.findIndex(d=>d!==0);let o=a,u=a;for(e=a;e<256;e++){const d=t[e];d>s&&(e-o>r&&(r=e-o,u=e-1),s=d,o=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:s,height:r}=t,{maxDim:a}=this.#t;let o=s,u=r;if(s>a||r>a){let b=s,v=r,x=Math.log2(Math.max(s,r)/a);const w=Math.floor(x);x=x===w?w-1:w;for(let E=0;E<x;E++){o=Math.ceil(b/2),u=Math.ceil(v/2);const R=new OffscreenCanvas(o,u);R.getContext("2d").drawImage(t,0,0,b,v,0,0,o,u),b=o,v=u,t!==e&&t.close(),t=R.transferToImageBitmap()}const S=Math.min(a/o,a/u);o=Math.round(o*S),u=Math.round(u*S)}const f=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,o,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,o,u);const g=f.getImageData(0,0,o,u).data;return[this.#d(g),o,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:s,fontWeight:r},a,o,u,d){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const m=200,b=g.font=`${s} ${r} ${m}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:x,actualBoundingBoxAscent:w,actualBoundingBoxDescent:S,fontBoundingBoxAscent:E,fontBoundingBoxDescent:R,width:T}=g.measureText(t),N=1.5,D=Math.ceil(Math.max(Math.abs(v)+Math.abs(x)||0,T)*N),M=Math.ceil(Math.max(Math.abs(w)+Math.abs(S)||m,Math.abs(E)+Math.abs(R)||m)*N);f=new OffscreenCanvas(D,M),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,D,M),g.fillStyle="black",g.fillText(t,D*(N-1)/2,M*(3-N)/2);const L=this.#d(g.getImageData(0,0,D,M).data),G=this.#l(L),X=this.#h(G),et=this.#n(L,D,M,X);return this.processDrawnLines({lines:{curves:et,width:D,height:M},pageWidth:a,pageHeight:o,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,s,r,a){const[o,u,d]=this.#f(t),[f,g]=this.#c(o,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#h(g),b=this.#n(f,u,d,m);return this.processDrawnLines({lines:{curves:b,width:u,height:d},pageWidth:e,pageHeight:s,rotation:r,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:r,innerMargin:a,mustSmooth:o,areContours:u}){r%180!==0&&([e,s]=[s,e]);const{curves:d,width:f,height:g}=t,m=t.thickness??0,b=[],v=Math.min(e/f,s/g),x=v/e,w=v/s,S=[];for(const{points:R}of d){const T=o?this.#o(R):R;if(!T)continue;S.push(T);const N=T.length,D=new Float32Array(N),M=new Float32Array(3*(N===2?2:N-2));if(b.push({line:M,points:D}),N===2){D[0]=T[0]*x,D[1]=T[1]*w,M.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[L,G,X,et]=T;L*=x,G*=w,X*=x,et*=w,D.set([L,G,X,et],0),M.set([NaN,NaN,NaN,NaN,L,G],0);for(let Z=4;Z<N;Z+=2){const P=D[Z]=T[Z]*x,Q=D[Z+1]=T[Z+1]*w;M.set(nt.createBezierPoints(L,G,X,et,P,Q),(Z-2)*3),[L,G,X,et]=[X,et,P,Q]}}if(b.length===0)return null;const E=u?new Wd:new wo;return E.build(b,e,s,1,r,u?0:m,a),{outline:E,newCurves:S,areContours:u,thickness:m,width:f,height:g}}static async compressSignature({outlines:t,areContours:e,thickness:s,width:r,height:a}){let o=1/0,u=-1/0,d=0;for(const T of t){d+=T.length;for(let N=2,D=T.length;N<D;N++){const M=T[N]-T[N-2];o=Math.min(o,M),u=Math.max(u,M)}}let f;o>=-128&&u<=127?f=Int8Array:o>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const g=t.length,m=ic+Ga*g,b=new Uint32Array(m);let v=0;b[v++]=m*Uint32Array.BYTES_PER_ELEMENT+(d-2*g)*f.BYTES_PER_ELEMENT,b[v++]=0,b[v++]=r,b[v++]=a,b[v++]=e?0:1,b[v++]=Math.max(0,Math.floor(s??0)),b[v++]=g,b[v++]=f.BYTES_PER_ELEMENT;for(const T of t)b[v++]=T.length-2,b[v++]=T[0],b[v++]=T[1];const x=new CompressionStream("deflate-raw"),w=x.writable.getWriter();await w.ready,w.write(b);const S=f.prototype.constructor;for(const T of t){const N=new S(T.length-2);for(let D=2,M=T.length;D<M;D++)N[D-2]=T[D]-T[D-2];w.write(N)}w.close();const E=await new Response(x.readable).arrayBuffer(),R=new Uint8Array(E);return _v(R)}static async decompressSignature(t){try{const e=wT(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),a=r.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,u=0;for await(const T of s)o||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),o.set(T,u),u+=T.length;const d=new Uint32Array(o.buffer,0,o.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=d[2],m=d[3],b=d[4]===0,v=d[5],x=d[6],w=d[7],S=[],E=(ic+Ga*x)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(w){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(o.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(o.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(o.buffer,E);break}u=0;for(let T=0;T<x;T++){const N=d[Ga*T+ic],D=new Float32Array(N+2);S.push(D);for(let M=0;M<Ga-1;M++)D[M]=d[Ga*T+ic+M+1];for(let M=0;M<N;M++)D[M+2]=D[M]+R[u++]}return{areContours:b,thickness:v,outlines:S,width:g,height:m}}catch(e){return _t(`decompressSignature: ${e}`),null}}}class kf extends Xv{constructor(){super(),super.updateProperties({fill:dt._defaultLineColor,"stroke-width":0})}clone(){const t=new kf;return t.updateAll(this),t}}class Df extends Dc{constructor(t){super(t),super.updateProperties({stroke:dt._defaultLineColor,"stroke-width":1})}clone(){const t=new Df(this._viewParameters);return t.updateAll(this),t}}class Fs extends yt{#t=!1;#e=null;#i=null;#s=null;static _type="signature";static _editorType=At.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){dt.initialize(t,e),this._defaultDrawingOptions=new kf,this._defaultDrawnSignatureOptions=new Df(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Tt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:r,mustSmooth:a,areContours:o,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:g,pageHeight:m},rotation:b}=this.parent.viewport,v=Nr.processDrawnLines({lines:r,pageWidth:g,pageHeight:m,rotation:b,innerMargin:Fs._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#s=t,this.addEditToolbar()}getUuid(){return this.#s}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:s,width:r,height:a}=this.#i,o=Math.max(r,a),u=Nr.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,s,r){const{x:a,y:o}=this,{outline:u}=this.#i=t;this.#t=u instanceof Wd,this.description=s;let d;this.#t?d=Fs.getDefaultDrawingOptions():(d=Fs._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let g=e/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:r}=this.parent.viewport;return Nr.process(t,e,s,r,Fs._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return Nr.extractContoursFromText(t,e,s,r,a,Fs._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:s},rotation:r}=this.parent.viewport;return Nr.processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:r,innerMargin:Fs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Fs.getDefaultDrawingOptions():(this._drawingOptions=Fs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(a),t?(a.paths={lines:e,points:s},a.uuid=this.#s,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,s,r,a,o){return o.areContours?Wd.deserialize(t,e,s,r,a,o):wo.deserialize(t,e,s,r,a,o)}static async deserialize(t,e,s){const r=await super.deserialize(t,e,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#s=t.uuid,r}}class aR extends dt{#t=null;#e=null;#i=null;#s=null;#a=null;#n="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=At.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#s=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){dt.initialize(t,e)}static isHandlingMimeForPasting(t){return Fd.includes(t)}static paste(t,e){e.pasteEditor({mode:At.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#n=t.file.name),this.#g()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#s){const s=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#a){const s=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Fd.join(",");const e=this._uiManager._signal;this.#i=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:e,height:s}=this.#t;const[r,a]=this.pageDimensions,o=.75;if(this.width)e=this.width*r,s=this.height*a;else if(e>o*r||s>o*a){const d=Math.min(o*r/e,o*a/s);e*=d,s*=d}this._uiManager.enableWaiting(!1);const u=this.#r=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/r,this.height=s/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&this.div.setAttribute("aria-description",this.#n),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,s=!1){t||(t=224);const{width:r,height:a}=this.#t,o=new $s;let u=this.#t,d=r,f=a,g=null;if(e){if(r>e||a>e){const M=Math.min(e/r,e/a);d=Math.floor(r*M),f=Math.floor(a*M)}g=document.createElement("canvas");const b=g.width=Math.ceil(d*o.sx),v=g.height=Math.ceil(f*o.sy);this.#l||(u=this.#u(b,v));const x=g.getContext("2d");x.filter=this._uiManager.hcmFilter;let w="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":TT.isDarkMode&&(w="#8f8f9d",S="#42414d");const E=15,R=E*o.sx,T=E*o.sy,N=new OffscreenCanvas(R*2,T*2),D=N.getContext("2d");D.fillStyle=w,D.fillRect(0,0,R*2,T*2),D.fillStyle=S,D.fillRect(0,0,R,T),D.fillRect(R,T,R,T),x.fillStyle=x.createPattern(N,"repeat"),x.fillRect(0,0,b,v),x.drawImage(u,0,0,u.width,u.height,0,0,b,v)}let m=null;if(s){let b,v;if(o.symmetric&&u.width<t&&u.height<t)b=u.width,v=u.height;else if(u=this.#t,r>t||a>t){const S=Math.min(t/r,t/a);b=Math.floor(r*S),v=Math.floor(a*S),this.#l||(u=this.#u(b,v))}const w=new OffscreenCanvas(b,v).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,b,v),m={width:b,height:v,data:w.getImageData(0,0,b,v).data}}return{canvas:g,width:d,height:f,imageData:m}}#u(t,e){const{width:s,height:r}=this.#t;let a=s,o=r,u=this.#t;for(;a>2*t||o>2*e;){const d=a,f=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const g=new OffscreenCanvas(a,o);g.getContext("2d").drawImage(u,0,0,d,f,0,0,a,o),u=g.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:s,height:r}=this,a=new $s,o=Math.ceil(s*t*a.sx),u=Math.ceil(r*e*a.sy),d=this.#r;if(!d||d.width===o&&d.height===u)return;d.width=o,d.height=u;const f=this.#l?this.#t:this.#u(o,u),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,o,u)}#y(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,s]=this.pageDimensions,r=Math.round(this.width*e*Fr.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*Fr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let r=null,a=!1;if(t instanceof Vv){const{data:{rect:w,rotation:S,id:E,structParent:R,popupRef:T,richText:N,contentsObj:D,creationDate:M,modificationDate:L},container:G,parent:{page:{pageNumber:X}},canvas:et}=t;let Z,P;et?(delete t.canvas,{id:Z,bitmap:P}=s.imageManager.getFromCanvas(G.id,et),et.remove()):(a=!0,t._hasNoCanvas=!0);const Q=(await e._structTree.getAriaAttributes(`${yf}${E}`))?.get("aria-label")||"";r=t={annotationType:At.STAMP,bitmapId:Z,bitmap:P,pageIndex:X-1,rect:w.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:Q},isSvg:!1,structParent:R,popupRef:T,richText:N,comment:D?.str||null,creationDate:M,modificationDate:L}}const o=await super.deserialize(t,e,s),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:g,isSvg:m,accessibilityData:b}=t;a?(s.addMissingCanvas(t.id,o),o.#o=!0):g&&s.imageManager.isValidId(g)?(o.#e=g,d&&(o.#t=d)):o.#s=f,o.#l=m;const[v,x]=o.pageDimensions;return o.width=(u[2]-u[0])/v,o.height=(u[3]-u[1])/x,b&&(o.altTextData=b),o._initialData=r,t.comment&&o.setCommentData(t),o.#d=!!r,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(e===null)return s;e.stamps||=new Map;const o=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class di{#t;#e=!1;#i=null;#s=null;#a=null;#n=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([Ae,Of,aR,ue,Fs].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:r,accessibilityManager:a,annotationLayer:o,drawLayer:u,textLayer:d,viewport:f,l10n:g}){const m=[...di.#p.values()];if(!di._initialized){di._initialized=!0;for(const b of m)b.initialize(g,t)}t.registerEditorTypes(m),this.#u=t,this.pageIndex=e,this.div=s,this.#t=a,this.#i=o,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===At.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case At.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case At.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case At.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===At.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const s of di.#p.values())e.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}get#y(){return this.#n.size!==0?this.#n.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const e=this.#i;if(e)for(const s of e.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const s=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",r=>{const{clientX:o,clientY:u,timeStamp:d}=r,f=this.#g;if(d-f>500){this.#g=d;return}this.#g=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const m=document.elementsFromPoint(o,u);if(g.toggle("getElements",!1),!this.div.contains(m[0]))return;let b;const v=new RegExp(`^${no}[0-9]+$`);for(const w of m)if(v.test(w.id)){b=w.id;break}if(!b)return;const x=this.#n.get(b);x?.annotationElementId===null&&(r.stopPropagation(),r.preventDefault(),x.dblclick(r))},{signal:s,capture:!0})}const t=this.#i;if(t){const s=new Map,r=new Map;for(const o of this.#y){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(t);continue}if(o.serialize()!==null){s.set(o.annotationElementId,o);continue}else r.set(o.annotationElementId,o);this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}const a=t.getEditableAnnotations();for(const o of a){const{id:u}=o.data;if(this.#u.isDeletedAnnotationElement(u)){o.updateEdited({deleted:!0});continue}let d=r.get(u);if(d){d.resetAnnotationElement(o),d.show(!1),o.show();continue}d=s.get(u),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(o)&&d.show(!1)),o.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const s of di.#p.values())e.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:s}=De.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ue.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;const t=this.#u.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#s?.abort(),this.#s=null}attach(t){this.#n.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#n.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),dt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getEditorByUID(t){for(const e of this.#n.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return di.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#x(),a=this.getNextId(),o=this.#E({parent:this,id:a,x:s,y:r,uiManager:this.#u,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await di.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,s={}){const r=this.getNextId(),a=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...s});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#x(){const{x:t,y:e,width:s,height:r}=this.boundingClientRect,a=Math.max(0,t),o=Math.max(0,e),u=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,e+r),f=(a+u)/2-t,g=(o+d)/2-e,[m,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:m,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#x(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=De.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===At.STAMP||s===At.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===At.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=De.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,s){const r=this.#u.findParent(e,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#n.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#n.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#n.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,On(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,On(this.div,{rotation:s}),e!==s)for(const r of this.#n.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Oe{#t=null;#e=new Map;#i=new Map;static#s=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Tt(this,"_svgFactory",new vc)}static#a(t,[e,s,r,a]){const{style:o}=t;o.top=`${100*s}%`,o.left=`${100*e}%`,o.width=`${100*r}%`,o.height=`${100*a}%`}#n(){const t=Oe._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const s=Oe._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${e}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const a=Oe._svgFactory.createElement("use");return s.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),r}#o(t,e){for(const[s,r]of Object.entries(e))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,e=!1,s=!1){const r=Oe.#s++,a=this.#n(),o=Oe._svgFactory.createElement("defs");a.append(o);const u=Oe._svgFactory.createElement("path");o.append(u);const d=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,u);const f=s?this.#r(o,d):null,g=Oe._svgFactory.createElement("use");return a.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(a,t),this.#e.set(r,a),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const s=Oe.#s++,r=this.#n(),a=Oe._svgFactory.createElement("defs");r.append(a);const o=Oe._svgFactory.createElement("path");a.append(o);const u=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const m=Oe._svgFactory.createElement("mask");a.append(m),d=`mask_p${this.pageIndex}_${s}`,m.setAttribute("id",d),m.setAttribute("maskUnits","objectBoundingBox");const b=Oe._svgFactory.createElement("rect");m.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const v=Oe._svgFactory.createElement("use");m.append(v),v.setAttribute("href",`#${u}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=Oe._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const g=f.cloneNode();return r.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:r,rootClass:a,path:o}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),r&&Oe.#a(u,r),a){const{classList:d}=u;for(const[f,g]of Object.entries(a))d.toggle(f,g)}if(o){const f=u.firstChild.firstChild;this.#o(f,o)}}}updateParent(t,e){if(e===this)return;const s=this.#e.get(t);s&&(e.#t.append(s),this.#e.delete(t),e.#e.set(t,s))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Xd};globalThis.pdfjsLib={AbortException:Xi,AnnotationEditorLayer:di,AnnotationEditorParamsType:Dt,AnnotationEditorType:At,AnnotationEditorUIManager:Ki,AnnotationLayer:Nf,AnnotationMode:Gi,AnnotationType:me,applyOpacity:RT,build:PC,ColorPicker:xs,createValidAbsoluteUrl:yv,CSSConstants:CT,DOMSVGFactory:vc,DrawLayer:Oe,FeatureTest:De,fetchData:po,findContrastColor:NT,getDocument:OC,getFilenameFromUrl:_T,getPdfFilenameFromUrl:AT,getRGB:yo,getUuid:wv,getXfaPageViewport:ST,GlobalWorkerOptions:Br,ImageKind:ac,InvalidPDFException:Id,isDataScheme:Nc,isPdfFile:vf,isValidExplicitDest:IT,MathClamp:Ue,noContextMenu:Ss,normalizeUnicode:bT,OPS:ro,OutputScale:$s,PasswordResponses:cT,PDFDataRangeTransport:Iv,PDFDateString:zd,PDFWorker:oo,PermissionFlag:lT,PixelsPerInch:Fr,RenderingCancelledException:bf,renderRichText:xv,ResponseException:yc,setLayerDimensions:On,shadow:Tt,SignatureExtractor:Nr,stopEvent:ae,SupportedImageMimeTypes:Fd,TextLayer:Pe,TouchManager:Oc,updateUrlHash:bv,Util:at,VerbosityLevel:Tc,version:LC,XfaLayer:Av};Br.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";function oR(){const[c,t]=F.useState([]),[e,s]=F.useState([]),[r,a]=F.useState(!0),[o,u]=F.useState(""),[d,f]=F.useState("all"),[g,m]=F.useState({open:!1,product:null,url:null,type:null}),[b,v]=F.useState(!1),[x,w]=F.useState(null),[S,E]=F.useState(""),[R,T]=F.useState("");F.useEffect(()=>{N()},[]),F.useEffect(()=>{D()},[o,d,c]);async function N(){a(!0);try{let{data:P,error:Q}=await Gt.from("products").select(`
                    *,
                    users!products_owner_fk (
                        username
                    )
                `).eq("is_deleted",!1).order("created_at",{ascending:!1});if(Q||!P){const tt=await Gt.from("products").select(`
                        *,
                        users (
                            username
                        )
                    `).eq("is_deleted",!1).order("created_at",{ascending:!1});P=tt.data,Q=tt.error}if(Q||!P){const{data:tt,error:ut}=await Gt.from("products").select("*").eq("is_deleted",!1).order("created_at",{ascending:!1});if(ut){console.error("Products fetch failed:",ut),t([]),a(!1);return}const B=[...new Set(tt.map($=>$.owner_id).filter(Boolean))];if(B.length>0){const{data:$,error:st}=await Gt.from("users").select("id, username").in("id",B);if(!st&&$){const mt={};$.forEach(k=>{mt[k.id]=k});const St=tt.map(k=>({...k,owner:mt[k.owner_id]||null}));t(St),a(!1);return}}t(tt.map($=>({...$,owner:null})))}else{const tt=(P||[]).map(ut=>({...ut,owner:ut.users||null}));t(tt)}}catch(P){console.error("Unexpected error:",P),t([])}a(!1)}function D(){let P=[...c];o&&(P=P.filter(Q=>Q.title.toLowerCase().includes(o.toLowerCase())||Q.category?.toLowerCase().includes(o.toLowerCase())||Q.owner?.username?.toLowerCase().includes(o.toLowerCase()))),d!=="all"&&(P=P.filter(Q=>Q.status===d)),s(P)}async function M(P,Q){if(Q==="rejected"){w(P),E(""),T(""),v(!0);return}const{error:tt}=await Gt.from("products").update({status:Q}).eq("id",P);tt||N()}async function L(){if(!x||!S)return;const{error:P}=await Gt.from("products").update({status:"rejected",rejection_reason:S,rejection_remark:S==="Other"?R:null}).eq("id",x);P||(v(!1),N())}function G(P){switch(P){case"approved":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 border border-green-200",children:[_.jsx(Yi,{className:"w-3.5 h-3.5"}),"Approved"]});case"rejected":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700 border border-red-200",children:[_.jsx(Or,{className:"w-3.5 h-3.5"}),"Rejected"]});default:return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700 border border-yellow-200",children:[_.jsx(Ir,{className:"w-3.5 h-3.5"}),"In Review"]})}}const X={total:c.length,approved:c.filter(P=>P.status==="approved").length,review:c.filter(P=>P.status==="review").length,rejected:c.filter(P=>P.status==="rejected").length};async function et(P){let Q=P.file_url||P.video_url||P.thumbnail_url;if(!Q){alert("No file URL available for this product");return}let tt="unknown";const ut=Q.toLowerCase();ut.endsWith(".pdf")?tt="pdf":ut.match(/\.(jpg|jpeg|png|gif|webp)$/)?tt="image":ut.match(/\.(mp4|webm|mov)$/)?tt="video":(Q.includes("youtube.com")||Q.includes("youtu.be"))&&(tt="youtube"),Q.includes("/object/public/"),tt==="pdf"||tt==="image"||tt==="video"?m({open:!0,product:P,url:Q,type:tt}):window.open(Q,"_blank","noopener,noreferrer")}function Z(){m({open:!1,product:null,url:null,type:null})}return _.jsx(xc,{children:_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Products Management"}),_.jsx("p",{className:"text-gray-500",children:"Review and approve digital products from creators"})]}),_.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:_.jsx(uc,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Products"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:X.total})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:_.jsx(Yi,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Approved"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:X.approved})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center",children:_.jsx(Ir,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"In Review"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:X.review})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:_.jsx(Or,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Rejected"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:X.rejected})]})]}),_.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:_.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[_.jsxs("div",{className:"flex-1 relative",children:[_.jsx(of,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),_.jsx("input",{type:"text",placeholder:"Search by title, category, or creator...",value:o,onChange:P=>u(P.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent transition-all"})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(af,{className:"text-gray-400",size:20}),_.jsxs("select",{value:d,onChange:P=>f(P.target.value),className:"border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white",children:[_.jsx("option",{value:"all",children:"All Status"}),_.jsx("option",{value:"review",children:"In Review"}),_.jsx("option",{value:"approved",children:"Approved"}),_.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})}),r?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#58C1D1] mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Loading products..."})]}):e.length===0?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx("p",{className:"text-gray-600 text-lg",children:"No products found"}),_.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Try adjusting your filters"})]}):_.jsx("div",{className:"space-y-4",children:e.map(P=>{const Q=P.owner?.username||"Unknown User";return _.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden hover:shadow-md transition-all",children:_.jsx("div",{className:"p-6",children:_.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[_.jsx("div",{className:"w-full lg:w-32 h-32 flex-shrink-0",children:P.thumbnail_url?_.jsx("img",{src:P.thumbnail_url,alt:P.title,className:"w-full h-full object-cover rounded-lg"}):_.jsx("div",{className:"w-full h-full bg-gray-100 rounded-lg flex items-center justify-center",children:_.jsx(wS,{className:"text-gray-400",size:32})})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-3",children:[_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h3",{className:"text-lg font-bold text-gray-800 truncate mb-1",children:P.title}),_.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-600",children:[_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx("span",{className:"font-medium",children:"Category:"}),_.jsx("span",{children:P.category||""})]}),_.jsx("span",{className:"text-gray-300",children:"|"}),_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx("span",{className:"font-medium",children:"Creator:"}),_.jsx("span",{children:Q})]}),_.jsx("span",{className:"text-gray-300",children:"|"}),_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx("span",{className:"font-medium",children:"Price:"}),_.jsxs("span",{className:"font-semibold text-[#58C1D1]",children:["RM ",P.price]})]})]})]}),G(P.status)]}),P.description&&_.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:P.description}),P.status==="rejected"&&_.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[_.jsx("div",{className:"text-xs font-semibold text-red-600 mb-1",children:"Rejection Reason"}),_.jsxs("div",{className:"text-sm text-red-800",children:[P.rejection_reason||"No reason provided",P.rejection_remark?`  ${P.rejection_remark}`:""]})]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.jsxs("select",{value:P.status,onChange:tt=>M(P.id,tt.target.value),className:"text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white",children:[_.jsx("option",{value:"review",children:"In Review"}),_.jsx("option",{value:"approved",children:"Approve"}),_.jsx("option",{value:"rejected",children:"Reject"})]}),_.jsxs("button",{onClick:()=>et(P),className:"inline-flex items-center gap-2 px-4 py-2 bg-[#58C1D1] text-white rounded-lg text-sm font-medium hover:bg-[#4AA8B8] transition-colors",children:[_.jsx(_b,{className:"w-4 h-4"}),"View Product"]})]})]})]})})},P.id)})}),g.open&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:_.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[_.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g.product.title}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Review product content"})]}),_.jsx("button",{onClick:Z,className:"text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx(Or,{size:24})})]}),_.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[g.type==="pdf"&&_.jsx("div",{className:"w-full h-[70vh]",children:_.jsx("iframe",{src:`${g.url}#toolbar=0&navpanes=0&scrollbar=1`,className:"w-full h-full border rounded-lg",title:"PDF Preview"})}),g.product.status==="rejected"&&_.jsx("div",{className:"px-6 pt-4",children:_.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[_.jsx("div",{className:"text-xs font-semibold text-red-600 mb-1",children:"Rejection Reason"}),_.jsxs("div",{className:"text-sm text-red-800",children:[g.product.rejection_reason||"No reason provided",g.product.rejection_remark?`  ${g.product.rejection_remark}`:""]})]})}),g.type==="image"&&_.jsx("div",{className:"flex items-center justify-center",children:_.jsx("img",{src:g.url,alt:g.product.title,className:"max-w-full max-h-[70vh] object-contain rounded-lg"})}),g.type==="video"&&_.jsx("div",{className:"flex items-center justify-center",children:_.jsx("video",{controls:!0,className:"max-w-full max-h-[70vh] rounded-lg",src:g.url,children:"Your browser does not support video playback."})})]}),_.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between items-center",children:[_.jsxs("div",{className:"text-sm text-gray-600",children:[_.jsx("span",{className:"font-medium",children:"Status:"})," ",G(g.product.status)]}),_.jsxs("div",{className:"flex gap-3",children:[_.jsxs("button",{disabled:g.product.status==="rejected",onClick:()=>{M(g.product.id,"rejected"),Z()},className:`px-5 py-2.5 rounded-lg font-medium inline-flex items-center gap-2
        ${g.product.status==="rejected"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-600"}`,children:[_.jsx(Or,{className:"w-4 h-4"}),"Reject"]}),_.jsxs("button",{onClick:()=>{M(g.product.id,"approved"),Z()},className:"px-5 py-2.5 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors inline-flex items-center gap-2",children:[_.jsx(Yi,{className:"w-4 h-4"}),"Approve"]})]})]})]})}),b&&_.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:_.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-lg",children:[_.jsx("h3",{className:"text-lg font-bold mb-4",children:"Reject Product"}),_.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),_.jsxs("select",{value:S,onChange:P=>E(P.target.value),className:"w-full mb-3 px-3 py-2 border rounded-lg",children:[_.jsx("option",{value:"",children:"Select reason"}),_.jsx("option",{value:"Incomplete product information",children:"Incomplete product information"}),_.jsx("option",{value:"Low-quality or misleading content",children:"Low-quality or misleading content"}),_.jsx("option",{value:"Violates platform guidelines",children:"Violates platform guidelines"}),_.jsx("option",{value:"Copyright / ownership concerns",children:"Copyright / ownership concerns"}),_.jsx("option",{value:"Duplicate or spam product",children:"Duplicate or spam product"}),_.jsx("option",{value:"Other",children:"Other"})]}),S==="Other"&&_.jsx("textarea",{value:R,onChange:P=>T(P.target.value),placeholder:"Add remark",className:"w-full mb-3 px-3 py-2 border rounded-lg"}),_.jsxs("div",{className:"flex justify-end gap-3",children:[_.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-gray-200 rounded-lg",children:"Cancel"}),_.jsx("button",{onClick:L,disabled:!S,className:"px-4 py-2 bg-red-500 text-white rounded-lg",children:"Reject"})]})]})})]})})}function lR(){const[c,t]=F.useState([]),[e,s]=F.useState([]),[r,a]=F.useState(!0),[o,u]=F.useState(""),[d,f]=F.useState("all"),[g,m]=F.useState("all"),[b,v]=F.useState(null),[x,w]=F.useState(!1),[S,E]=F.useState(null),[R,T]=F.useState(""),[N,D]=F.useState("");F.useEffect(()=>{M()},[]),F.useEffect(()=>{L()},[o,d,g,c]);async function M(){a(!0);try{let{data:P,error:Q}=await Gt.from("users").select(`
                    *,
                    creators!creators_user_id_fkey (
                        ic_number,
                        full_name,
                        recipient_name,
                        bank_account,
                        bank_name,
                        status,
                        rejection_reason,
                        rejection_remark,
                        created_at
                    )
                `).order("created_at",{ascending:!1});if(Q||!P){const tt=await Gt.from("users").select(`
                        *,
                        creators (
                            ic_number,
                            full_name,
                            recipient_name,
                            bank_account,
                            bank_name,
                            status,
                            rejection_reason,
                            rejection_remark,
                            created_at
                        )
                    `).order("created_at",{ascending:!1});P=tt.data,Q=tt.error}if(Q||!P){const{data:tt,error:ut}=await Gt.from("users").select("*").order("created_at",{ascending:!1});if(ut){console.error("Users fetch failed:",ut),t([]),a(!1);return}const B=tt.map($=>$.id).filter(Boolean);if(B.length>0){const{data:$,error:st}=await Gt.from("creators").select("*").in("user_id",B);if(!st&&$){const mt={};$.forEach(k=>{mt[k.user_id]=k});const St=tt.map(k=>({...k,creator:mt[k.id]||null}));t(St),a(!1);return}}t(tt.map($=>({...$,creator:null})))}else{const tt=(P||[]).map(ut=>({...ut,creator:ut.creators||null}));t(tt)}}catch(P){console.error("Unexpected error:",P),t([])}a(!1)}function L(){let P=[...c];o&&(P=P.filter(Q=>Q.name?.toLowerCase().includes(o.toLowerCase())||Q.username?.toLowerCase().includes(o.toLowerCase())||Q.email?.toLowerCase().includes(o.toLowerCase())||Q.phone_number?.toLowerCase().includes(o.toLowerCase())||Q.creator?.full_name?.toLowerCase().includes(o.toLowerCase())||Q.creator?.ic_number?.toLowerCase().includes(o.toLowerCase()))),g==="creators"?P=P.filter(Q=>Q.creator!==null):g==="regular"&&(P=P.filter(Q=>Q.creator===null)),d!=="all"&&(P=P.filter(Q=>Q.creator?.status===d)),s(P)}async function G(){if(!(!S||!R))try{const{error:P}=await Gt.from("creators").update({status:"rejected",rejection_reason:R,rejection_remark:N||null}).eq("user_id",S);P?console.error("Failed to reject creator:",P):(w(!1),E(null),T(""),D(""),M())}catch(P){console.error("Unexpected error:",P)}}async function X(P,Q){try{const{error:tt}=await Gt.from("creators").update({status:Q}).eq("user_id",P);tt?console.error("Error updating status:",tt):M()}catch(tt){console.error("Unexpected error:",tt)}}function et(P){if(!P)return null;switch(P){case"approved":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 border border-green-200",children:[_.jsx(Yi,{className:"w-3.5 h-3.5"}),"Approved"]});case"rejected":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700 border border-red-200",children:[_.jsx(Or,{className:"w-3.5 h-3.5"}),"Rejected"]});default:return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700 border border-yellow-200",children:[_.jsx(Ir,{className:"w-3.5 h-3.5"}),"Pending"]})}}const Z={total:c.length,creators:c.filter(P=>P.creator!==null).length,regular:c.filter(P=>P.creator===null).length,approved:c.filter(P=>P.creator?.status==="approved").length,pending:c.filter(P=>P.creator?.status==="pending").length,rejected:c.filter(P=>P.creator?.status==="rejected").length};return _.jsx(xc,{children:_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Users & Creators Management"}),_.jsx("p",{className:"text-gray-500",children:"Manage user accounts and review creator applications"})]}),_.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:_.jsx(hc,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Total Users"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.total})]}),_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center",children:_.jsx(Jy,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Creators"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.creators})]}),_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-gray-500 to-gray-600 flex items-center justify-center",children:_.jsx(Zy,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Regular"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.regular})]}),_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center",children:_.jsx(Ir,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Pending"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.pending})]}),_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:_.jsx(Yi,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Approved"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.approved})]}),_.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-2",children:_.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:_.jsx(Or,{className:"text-white",size:18})})}),_.jsx("p",{className:"text-gray-500 text-xs font-medium mb-1",children:"Rejected"}),_.jsx("p",{className:"text-xl font-bold text-gray-800",children:Z.rejected})]})]}),_.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:_.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[_.jsxs("div",{className:"flex-1 relative",children:[_.jsx(of,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),_.jsx("input",{type:"text",placeholder:"Search by name, email, username, phone...",value:o,onChange:P=>u(P.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent transition-all"})]}),_.jsxs("div",{className:"flex gap-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx(af,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),_.jsxs("select",{value:g,onChange:P=>m(P.target.value),className:"pl-10 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white",children:[_.jsx("option",{value:"all",children:"All Users"}),_.jsx("option",{value:"creators",children:"Creators Only"}),_.jsx("option",{value:"regular",children:"Regular Users"})]})]}),_.jsxs("select",{value:d,onChange:P=>f(P.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white",children:[_.jsx("option",{value:"all",children:"All Status"}),_.jsx("option",{value:"pending",children:"Pending"}),_.jsx("option",{value:"approved",children:"Approved"}),_.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})}),r?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#58C1D1] mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):e.length===0?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx(hc,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600 text-lg",children:"No users found"}),_.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Try adjusting your filters"})]}):_.jsx("div",{className:"space-y-4",children:e.map(P=>_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden hover:shadow-md transition-all",children:[_.jsx("div",{className:"p-6",children:_.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[_.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[_.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center text-white font-bold text-xl flex-shrink-0",children:P.name?.charAt(0).toUpperCase()||"U"}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[_.jsx("h3",{className:"text-lg font-bold text-gray-800",children:P.name}),P.creator?_.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold bg-gradient-to-r from-[#58C1D1] to-[#4AA8B8] text-white",children:[_.jsx(Jy,{className:"w-3 h-3"}),"Creator"]}):_.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-700 border border-gray-200",children:[_.jsx(Zy,{className:"w-3 h-3"}),"User"]}),P.creator&&et(P.creator.status)]}),_.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["@",P.username]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[_.jsx(AS,{className:"w-4 h-4 text-[#58C1D1]"}),_.jsx("span",{children:P.email})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[_.jsx(ES,{className:"w-4 h-4 text-green-500"}),_.jsx("span",{children:P.phone_number||"No phone"})]})]}),P.bio&&P.bio!=="this is my bio"&&_.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:_.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',P.bio,'"']})})]})]}),_.jsx("div",{className:"flex flex-col gap-2 lg:items-end",children:P.creator&&_.jsxs(_.Fragment,{children:[_.jsxs("select",{value:P.creator.status,onChange:Q=>{const tt=Q.target.value;tt==="rejected"?(E(P.id),T(""),D(""),w(!0)):X(P.id,tt)},className:"w-full lg:w-40 text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white font-medium",children:[_.jsx("option",{value:"pending",children:"Set Pending"}),_.jsx("option",{value:"approved",children:"Approve"}),_.jsx("option",{value:"rejected",children:"Reject"})]}),_.jsx("button",{onClick:()=>v(b===P.id?null:P.id),className:"flex items-center gap-2 text-sm text-[#58C1D1] hover:text-[#4AA8B8] font-medium transition-colors",children:b===P.id?_.jsxs(_.Fragment,{children:[_.jsx(wb,{size:18}),"Hide Details"]}):_.jsxs(_.Fragment,{children:[_.jsx(vb,{size:18}),"View Details"]})})]})})]})}),P.creator&&b===P.id&&_.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 p-6",children:[_.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-4 flex items-center gap-2",children:[_.jsx(Ab,{size:16,className:"text-[#58C1D1]"}),"Creator Application Details"]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Full Legal Name"}),_.jsx("div",{className:"text-sm font-semibold text-gray-800",children:P.creator.full_name||"N/A"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"IC Number"}),_.jsxs("div",{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(rf,{className:"w-4 h-4 text-blue-600"}),P.creator.ic_number||"N/A"]})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Recipient Name"}),_.jsx("div",{className:"text-sm font-semibold text-gray-800",children:P.creator.recipient_name||"N/A"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Bank Name"}),_.jsxs("div",{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(Sd,{className:"w-4 h-4 text-green-600"}),P.creator.bank_name||"N/A"]})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Account Number"}),_.jsx("div",{className:"text-sm font-semibold text-gray-800",children:P.creator.bank_account||"N/A"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Applied On"}),_.jsx("div",{className:"text-sm font-semibold text-gray-800",children:new Date(P.creator.created_at).toLocaleDateString("en-MY",{year:"numeric",month:"long",day:"numeric"})}),P.creator.status==="rejected"&&_.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:[_.jsx("div",{className:"text-xs font-medium text-red-600 mb-1",children:"Rejection Reason"}),_.jsxs("div",{className:"text-sm text-red-800",children:[P.creator.rejection_reason,P.creator.rejection_remark?` - ${P.creator.rejection_remark}`:""]})]})]})]})]})]},P.id))}),x&&_.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:_.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-lg",children:[_.jsx("h3",{className:"text-lg font-bold mb-4",children:"Reject Creator"}),_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),_.jsxs("select",{value:R,onChange:P=>T(P.target.value),className:"w-full mb-3 px-3 py-2 border border-gray-300 rounded-lg",children:[_.jsx("option",{value:"",children:"Select reason"}),_.jsx("option",{value:"Incomplete Full Name / IC / Passport",children:"Incomplete Full Name / IC / Passport"}),_.jsx("option",{value:"Invalid IC / Passport Number",children:"Invalid IC / Passport Number"}),_.jsx("option",{value:"Receipt Name Does Not Match Bank Account",children:"Receipt Name Does Not Match Bank Account"}),_.jsx("option",{value:"Bank Account Details Invalid",children:"Bank Account Details Invalid"}),_.jsx("option",{value:"Suspicious / Duplicate Application",children:"Suspicious / Duplicate Application"}),_.jsx("option",{value:"Other",children:"Other"})]}),R==="Other"&&_.jsx("textarea",{value:N,onChange:P=>D(P.target.value),placeholder:"Add remark",className:"w-full mb-3 px-3 py-2 border border-gray-300 rounded-lg"}),_.jsxs("div",{className:"flex justify-end gap-3",children:[_.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-gray-200 rounded-lg",children:"Cancel"}),_.jsx("button",{onClick:()=>G(),className:"px-4 py-2 bg-red-500 text-white rounded-lg",disabled:!R,children:"Reject"})]})]})})]})})}function cR(){const[c,t]=F.useState([]),[e,s]=F.useState([]),[r,a]=F.useState(!0),[o,u]=F.useState("all"),[d,f]=F.useState(""),[g,m]=F.useState(null),[b,v]=F.useState({total:0,pending:0,paid:0,totalAmount:0});F.useEffect(()=>{x()},[]),F.useEffect(()=>{w(),S()},[o,d,c]);async function x(){a(!0);try{const{data:T,error:N}=await Gt.from("withdrawals").select(`
                    *,
                    creators!withdrawals_creator_fk (
                        full_name,
                        recipient_name,
                        bank_account,
                        bank_name
                    )
                `).order("requested_at",{ascending:!1});if(N)console.error("Error fetching withdrawals:",N),t([]);else{const D=(T||[]).map(M=>({...M,creator:M.creators||null}));t(D)}}catch(T){console.error("Unexpected error:",T),t([])}a(!1)}function w(){let T=[...c];o!=="all"&&(T=T.filter(N=>N.status===o)),d&&(T=T.filter(N=>N.creator?.full_name?.toLowerCase().includes(d.toLowerCase())||N.creator?.recipient_name?.toLowerCase().includes(d.toLowerCase()))),s(T)}function S(){const T=c.length,N=c.filter(L=>L.status==="pending").length,D=c.filter(L=>L.status==="paid").length,M=c.filter(L=>L.status==="paid").reduce((L,G)=>L+(G.net_amount||0),0);v({total:T,pending:N,paid:D,totalAmount:M})}function E(T){switch(T){case"pending":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700 border border-yellow-200",children:[_.jsx(Ir,{className:"w-3.5 h-3.5"}),"Pending"]});case"paid":return _.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 border border-green-200",children:[_.jsx(Yi,{className:"w-3.5 h-3.5"}),"Paid"]});default:return null}}async function R(T,N){try{const{error:D}=await Gt.from("withdrawals").update({status:N,processed_at:new Date().toISOString()}).eq("id",T);D?console.error("Error updating withdrawal:",D):x()}catch(D){console.error("Unexpected error:",D)}}return _.jsx(xc,{children:_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Withdrawal Requests"}),_.jsx("p",{className:"text-gray-500",children:"Manage creator withdrawal requests and payouts"})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:_.jsx(xb,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Requests"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:b.total})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center",children:_.jsx(Ir,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Pending"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:b.pending})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:_.jsx(Yi,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Completed"}),_.jsx("p",{className:"text-2xl font-bold text-gray-800",children:b.paid})]}),_.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"flex items-center justify-between mb-3",children:_.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center",children:_.jsx(Sr,{className:"text-white",size:20})})}),_.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:"Total Paid Out"}),_.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:["RM ",b.totalAmount.toFixed(2)]})]})]}),_.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:_.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[_.jsxs("div",{className:"flex-1 relative",children:[_.jsx(of,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),_.jsx("input",{type:"text",placeholder:"Search by creator or recipient name...",value:d,onChange:T=>f(T.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent transition-all"})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(af,{className:"text-gray-400",size:20}),_.jsxs("select",{value:o,onChange:T=>u(T.target.value),className:"border border-gray-300 rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-[#58C1D1] focus:border-transparent bg-white",children:[_.jsx("option",{value:"all",children:"All Status"}),_.jsx("option",{value:"pending",children:"Pending"}),_.jsx("option",{value:"paid",children:"Paid"})]})]})]})}),r?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#58C1D1] mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Loading withdrawal requests..."})]}):e.length===0?_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[_.jsx("p",{className:"text-gray-600 text-lg",children:"No withdrawal requests found"}),_.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Try adjusting your filters"})]}):_.jsx("div",{className:"space-y-4",children:e.map(T=>_.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden hover:shadow-md transition-all",children:[_.jsx("div",{className:"p-6",children:_.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[_.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[_.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#58C1D1] to-[#4AA8B8] flex items-center justify-center text-white font-bold text-lg flex-shrink-0",children:T.creator?.full_name?.charAt(0).toUpperCase()||"C"}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx("h3",{className:"text-lg font-bold text-gray-800 truncate",children:T.creator?.full_name||"Unknown Creator"}),E(T.status)]}),_.jsxs("div",{className:"space-y-1",children:[_.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[_.jsxs("span",{className:"font-medium",children:["Amount: ",_.jsxs("span",{className:"text-gray-800",children:["RM ",T.amount.toFixed(2)]})]}),_.jsx("span",{className:"text-gray-400",children:"|"}),_.jsxs("span",{className:"font-medium",children:["Fee: ",_.jsxs("span",{className:"text-gray-800",children:["RM ",T.fee.toFixed(2)]})]}),_.jsx("span",{className:"text-gray-400",children:"|"}),_.jsxs("span",{className:"font-medium",children:["Net: ",_.jsxs("span",{className:"text-green-600 font-semibold",children:["RM ",T.net_amount.toFixed(2)]})]})]}),_.jsxs("div",{className:"text-xs text-gray-500",children:["Requested on: ",new Date(T.requested_at).toLocaleDateString("en-MY",{year:"numeric",month:"long",day:"numeric"})]})]})]})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[T.status==="pending"&&_.jsx("div",{className:"flex gap-2",children:_.jsxs("button",{onClick:()=>R(T.id,"paid"),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2.5 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[_.jsx(Yi,{size:16}),"Mark as Paid"]})}),_.jsx("button",{onClick:()=>m(g===T.id?null:T.id),className:"flex items-center gap-1.5 text-[#58C1D1] hover:text-[#4AA8B8] font-medium text-sm transition-colors",children:g===T.id?_.jsxs(_.Fragment,{children:[_.jsx(wb,{size:18}),"Hide"]}):_.jsxs(_.Fragment,{children:[_.jsx(vb,{size:18}),"Bank Details"]})})]})]})}),g===T.id&&T.creator&&_.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 p-6",children:[_.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-4 flex items-center gap-2",children:[_.jsx(Sd,{size:16,className:"text-[#58C1D1]"}),"Bank Account Information"]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Recipient Name"}),_.jsx("div",{className:"text-sm font-semibold text-gray-800",children:T.creator.recipient_name||"N/A"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Bank Name"}),_.jsxs("div",{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(Sd,{className:"w-4 h-4 text-green-600"}),T.creator.bank_name||"N/A"]})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[_.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Account Number"}),_.jsxs("div",{className:"text-sm font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(rf,{className:"w-4 h-4 text-blue-600"}),T.creator.bank_account||"N/A"]})]})]})]})]},T.id))})]})})}function uR(){return _.jsx(qx,{children:_.jsxs(_x,{children:[_.jsx(Va,{path:"/",element:_.jsx(oT,{})}),_.jsx(Va,{path:"/products",element:_.jsx(oR,{})}),_.jsx(Va,{path:"/users",element:_.jsx(lR,{})}),_.jsx(Va,{path:"/payments",element:_.jsx(cR,{})})]})})}OA.createRoot(document.getElementById("root")).render(_.jsx(F.StrictMode,{children:_.jsx(uR,{})}));
